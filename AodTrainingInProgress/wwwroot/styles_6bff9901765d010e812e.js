/*! For license information please see styles_6bff9901765d010e812e.js.LICENSE.txt */
"use strict"; (self.webpackChunke20260130_idol = self.webpackChunke20260130_idol || []).push([[869], { 3795: function (t, e, n) { n.d(e, { A: function () { return c } }); var a = n(85880), i = n(74061), r = n(4115), o = { __name: "midTrans", emits: ["complete"], setup: function (t, e) { var n = e.emit; return (0, r.pT)(!0), (0, i.onMounted)(function () { (0, i.nextTick)(function () { a.default.timeline().to(".mid-trans-deco", { x: "-45rem", duration: 1, ease: "power0.inOut" }).to(".mid-trans-ava-container", { x: "-45rem", duration: 2, ease: "steps(30)", onComplete: function () { n("complete") } }, "-=0.5").to(".mid-trans-ava", { rotate: 20, duration: .2, repeat: -1, yoyo: !0, ease: "steps(1)" }, "<") }) }), { __sfc: !0, emits: n } } }, c = (0, n(14486).A)(o, function () { var t = this, e = t._self._c; return t._self._setupProxy, e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("midTrans_mid_trans_bg.jpg"), expression: "$getLocalImg('midTrans_mid_trans_bg.jpg')", modifiers: { bg: !0 } }], staticClass: "mid-trans" }, [e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("midTrans_mid_trans_deco.png"), expression: "$getLocalImg('midTrans_mid_trans_deco.png')", modifiers: { bg: !0 } }], staticClass: "mid-trans-deco" }), t._v(" "), e("div", { staticClass: "mid-trans-ava-container" }, t._l(3, function (n) { return e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("midTrans_mid_trans_ava_".concat(n, ".png")), expression: "$getLocalImg(`midTrans_mid_trans_ava_${i}.png`)", modifiers: { bg: !0 } }], key: n, staticClass: "mid-trans-ava", class: "mid-trans-ava__".concat(n) }) }), 0)]) }, [], !1, null, "0dfa38bb", null).exports }, 3838: function (t, e, n) { n.d(e, { A: function () { return k } }); var a = n(74061), i = n(85880), r = n(74681), o = n(4115), c = n(97921), l = n(15908); function s(t) { return s = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, s(t) } function u() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var l = a && a.prototype instanceof c ? a : c, s = Object.create(l.prototype); return d(s, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), s } var o = {}; function c() { } function l() { } function s() { } e = Object.getPrototypeOf; var f = [][a] ? e(e([][a]())) : (d(e = {}, a, function () { return this }), e), v = s.prototype = c.prototype = Object.create(f); function m(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, s) : (t.__proto__ = s, d(t, i, "GeneratorFunction")), t.prototype = Object.create(v), t } return l.prototype = s, d(v, "constructor", s), d(s, "constructor", l), l.displayName = "GeneratorFunction", d(s, i, "GeneratorFunction"), d(v), d(v, i, "Generator"), d(v, a, function () { return this }), d(v, "toString", function () { return "[object Generator]" }), (u = function () { return { w: r, m: m } })() } function d(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } d = function (t, e, n, a) { function r(e, n) { d(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, d(t, e, n, a) } function f(t, e) { var n = Object.keys(t); if (Object.getOwnPropertySymbols) { var a = Object.getOwnPropertySymbols(t); e && (a = a.filter(function (e) { return Object.getOwnPropertyDescriptor(t, e).enumerable })), n.push.apply(n, a) } return n } function v(t) { for (var e = 1; e < arguments.length; e++) { var n = null != arguments[e] ? arguments[e] : {}; e % 2 ? f(Object(n), !0).forEach(function (e) { m(t, e, n[e]) }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(n)) : f(Object(n)).forEach(function (e) { Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(n, e)) }) } return t } function m(t, e, n) { return (e = function (t) { var e = function (t) { if ("object" != s(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var n = e.call(t, "string"); if ("object" != s(n)) return n; throw new TypeError("@@toPrimitive must return a primitive value.") } return String(t) }(t); return "symbol" == s(e) ? e : e + "" }(e)) in t ? Object.defineProperty(t, e, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : t[e] = n, t } function p(t) { return function (t) { if (Array.isArray(t)) return g(t) }(t) || function (t) { if ("undefined" != typeof Symbol && null != t[Symbol.iterator] || null != t["@@iterator"]) return Array.from(t) }(t) || function (t, e) { if (t) { if ("string" == typeof t) return g(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? g(t, e) : void 0 } }(t) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }() } function g(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, a = Array(e); n < e; n++)a[n] = t[n]; return a } function _(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } function b(t) { return function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { _(r, a, i, o, c, "next", t) } function c(t) { _(r, a, i, o, c, "throw", t) } o(void 0) }) } } var h = (0, a.defineComponent)({ __name: "midTrans3", props: { textId: null }, emits: ["complete"], setup: function (t, e) { var s = e.emit, d = t; (0, o.pT)(!0); var f = (0, c.v)().trackEvent, m = (0, a.ref)(null), g = (0, a.ref)([{ src: "", w: 148, h: 148 }, { src: "", w: 132, h: 136 }, { src: "", w: 78, h: 78 }, { src: "", w: 180, h: 186 }, { src: "", w: 109, h: 113 }, { src: "", w: 89, h: 91 }, { src: "", w: 118, h: 123 }, { src: "", w: 137, h: 134 }, { src: "", w: 150, h: 147 }, { src: "", w: 118, h: 119 }]); function _(t, e) { return Math.random() * (e - t) + t } function h(t, e) { for (var n = [], a = 0; a < (l.K6 ? 1 : 3); a++) { var i = Math.random() > .5 ? 1 : -1, r = _(10, 60) * (Math.PI / 180) * i, o = _(2, 5); n.push({ x: t, y: e, vx: -.8 * o, vy: Math.sin(r) * o, radius: _(6, 13), id: Math.floor(10 * Math.random()), alpha: 1, decay: _(.01, .028) }) } return n } var y = function () { var t = b(u().m(function t() { var e, a; return u().w(function (t) { for (; ;)switch (t.n) { case 0: return e = p(new Array(10)).map(function (t, e) { return n(90510)("./icon_star_".concat(e + 1, ".png")) }), t.n = 1, (0, r.uc)(e); case 1: a = t.v, g.value = g.value.map(function (t, e) { return v(v({}, t), {}, { src: a[e] }) }); case 2: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), k = function () { var t = null; i.default.fromTo(".trans-heart", { opacity: 0, scale: .9 }, { opacity: 1, scale: 1, duration: .5, delay: .5, onComplete: function () { t = i.default.to(".trans-heart", { opacity: 1, scale: .95, duration: 1, repeat: -1, yoyo: !0, ease: "power1.inOut" }) }, ease: "back.out(1.7)" }); var e = m.value.getContext("2d"), n = -200, a = [], r = { x: -200 }, o = null; i.default.to(r, { x: 2700, duration: 1.5, ease: "power1.inOut", onStart: function () { o = setInterval(function () { a = [].concat(p(a), p(h(n, 400))) }, l.K6 ? 60 : 40) }, onUpdate: function () { n = r.x }, onComplete: function () { clearInterval(o), t.kill(), i.default.to(".event-msg", { opacity: 1, y: 0, duration: .5, ease: "power1.inOut", onComplete: function () { i.default.to(".trans-heart", { opacity: 0, scale: .9, duration: .5, ease: "back.in(1.7)" }), setTimeout(function () { s("complete") }, 1e3) } }) } }), function t() { e.clearRect(0, 0, 2500, 1080); for (var n = a.length - 1; n >= 0; n--) { var i = a[n]; i.x += i.vx, i.y += i.vy, i.alpha -= i.decay, i.alpha <= 0 ? a.splice(n, 1) : (e.globalAlpha = Math.max(i.alpha, 0), e.drawImage(g.value[i.id].src, i.x, i.y, g.value[i.id].w * (1.3 - i.alpha), g.value[i.id].h * (1.3 - i.alpha)), e.globalAlpha = 1) } requestAnimationFrame(t) }() }; return (0, a.onMounted)(b(u().m(function t() { var e, n; return u().w(function (t) { for (; ;)switch (t.n) { case 0: return (n = null === (e = d.textId) || void 0 === e ? void 0 : e.split("_")[0]) && f("session", "visit", "favorby", n), t.n = 1, y(); case 1: k(); case 2: return t.a(2) } }, t) }))), { __sfc: !0, canvasWidth: 2500, canvasHeight: 1080, animationY: 400, emits: s, props: d, trackEvent: f, canvasRef: m, particlesSrc: g, random: _, createParticles: h, loadParticlesImg: y, playAni: k } } }), y = h, k = (0, n(14486).A)(y, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("midTrans_mid_trans_3.jpg"), expression: "$getLocalImg('midTrans_mid_trans_3.jpg')", modifiers: { bg: !0 } }], staticClass: "mid-trans-3" }, [e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("midTrans_trans_heart.png"), expression: "$getLocalImg('midTrans_trans_heart.png')", modifiers: { bg: !0 } }], staticClass: "trans-heart" }), t._v(" "), e("canvas", { ref: "canvasRef", attrs: { width: n.canvasWidth, height: n.canvasHeight } }), t._v(" "), e("div", { staticClass: "event-msg" }, [e("div", { staticClass: "event-msg-deco" }), t._v(" "), e("div", { staticClass: "event-msg-text title-font" }, [t._v(t._s(t.$getI18nWord("mid_trans_text_".concat(n.props.textId))))])])]) }, [], !1, null, "6229efc2", null).exports }, 17782: function (t, e, n) { n.d(e, { A: function () { return g } }); var a = n(74061), i = n(6624), r = n(15908), o = n(43097), c = n(20236), l = n(85880), s = n(4115); function u(t) { return u = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, u(t) } function d(t, e) { var n = Object.keys(t); if (Object.getOwnPropertySymbols) { var a = Object.getOwnPropertySymbols(t); e && (a = a.filter(function (e) { return Object.getOwnPropertyDescriptor(t, e).enumerable })), n.push.apply(n, a) } return n } function f(t) { for (var e = 1; e < arguments.length; e++) { var n = null != arguments[e] ? arguments[e] : {}; e % 2 ? d(Object(n), !0).forEach(function (e) { v(t, e, n[e]) }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(n)) : d(Object(n)).forEach(function (e) { Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(n, e)) }) } return t } function v(t, e, n) { return (e = function (t) { var e = function (t) { if ("object" != u(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var n = e.call(t, "string"); if ("object" != u(n)) return n; throw new TypeError("@@toPrimitive must return a primitive value.") } return String(t) }(t); return "symbol" == u(e) ? e : e + "" }(e)) in t ? Object.defineProperty(t, e, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : t[e] = n, t } var m = (0, a.defineComponent)({ __name: "guideModal", props: { step: null, initSubStep: null }, emits: ["end", "guideEnd", "enterGame", "enterTrain", "trainMid", "selectedIdol", "selectEvent", "finishSkill1", "resetSkill"], setup: function (t, e) { var u, d, v, m, p, g, _, b, h, y, k = e.emit, w = t, I = (0, s.pT)(!0, !0), C = I.onBtnPress, S = I.onDirection, T = I.onBtnHold, $ = I.onBtnRelease, x = (0, a.getCurrentInstance)().proxy, E = (0, a.ref)(!1), O = (0, o.d)(), P = (0, a.ref)(null), G = [{ length: 2 }, { length: 10 }, { length: 8 }, { length: 4 }, { length: 3 }, { length: 2 }, { length: 1 }, { length: 1 }, { length: 2 }], M = (0, a.computed)(function () { return i.wk.pageInfo.user_activity_info.skill_info.ability_c >= c.sb }), A = { guide_continue_tip: 3, guide_rotate_btn: 1, guide_drop_btn: 1, guide_hold_btn: 1, guide_skill_btn: 1 }, B = function (t) { var e = A[t] || 2; if (3 === e) { var n = i.rS.keyboardLayout ? "_keyboard" : "_mob"; return i.wk.enableGamepad && (n = "_gamepad"), "".concat(t).concat(n) } return 2 === e ? "".concat(t, "_").concat(i.wk.enableGamepad ? "gamepad" : "other") : t }, L = { 1: [{ vertical: "right", msg: ["guide_continue_tip"] }, { vertical: "right", msg: ["guide_start_btn"] }], 2: [{ vertical: "right", msg: ["guide_continue_tip"] }, { vertical: "right", msg: ["guide_continue_tip"] }, { vertical: "right", msg: ["guide_rotate_btn"] }, { vertical: "right", msg: ["guide_drop_btn"] }, { vertical: "right", msg: ["guide_continue_tip"] }, { vertical: "right", msg: ["guide_continue_tip"] }, { vertical: "right", msg: ["guide_hold_btn", "guide_continue_tip"] }, { vertical: "right", msg: ["guide_continue_tip"] }, { vertical: "right", msg: ["guide_continue_tip"] }, { vertical: "right", msg: ["guide_continue_tip"] }], 3: [{ vertical: "right", msg: ["guide_train_btn"] }, { vertical: "right", msg: ["guide_continue_tip"] }, { vertical: "right", msg: ["guide_continue_tip"] }, { vertical: "right", msg: ["guide_decide_btn"] }, { vertical: "right", msg: ["guide_continue_tip"] }, { vertical: "right", msg: ["guide_continue_tip"] }, { vertical: "right", msg: ["guide_continue_tip"] }, { vertical: "right", msg: ["guide_continue_tip"] }], 4: [{ vertical: "right", msg: ["guide_select_btn"] }, { vertical: "right", msg: ["guide_event_btn"] }, { vertical: "right", msg: ["guide_continue_tip"] }, { vertical: "right", msg: ["guide_continue_tip"] }], 5: [{ vertical: "right", msg: ["guide_start_btn"] }, { vertical: "right", msg: ["guide_skill_btn"] }, { vertical: "right", msg: ["guide_award_btn"] }, { vertical: "right", msg: ["guide_continue_tip"] }], 6: [{ vertical: "right", msg: ["guide_continue_tip"] }, { vertical: "right", msg: ["guide_skill_btn"] }], 7: [{ vertical: "right", msg: ["guide_skill_btn"] }], 8: [{ vertical: "right", msg: ["guide_continue_tip"] }], 9: [{ vertical: "right", msg: ["guide_ability_btn"] }, { vertical: "right", msg: ["guide_continue_tip"] }] }, j = (0, a.computed)(function () { return [[[], [{ left: 17.5, top: 7.2, width: 3.9, height: 3.5, radius: .5, gamepadBtn: "button3", click: function () { k("enterGame") } }]], [[{ left: 9.75, top: .35, width: 4.9, height: 10, radius: .5 }], i.rS.keyboardLayout ? [{ left: 9.75, top: .35, width: 4.9, height: 2.3, radius: .5 }] : [{ left: 9.75, top: .35, width: 4.9, height: 2.3, radius: .5 }, { left: 3.8, top: 7.5, width: 4.5, height: 2, radius: .5 }], i.rS.keyboardLayout ? [{ left: 9.75, top: .35, width: 4.9, height: 10, radius: .5 }] : [{ left: 9.75, top: .35, width: 4.9, height: 10, radius: .5 }, { left: 5, top: 6.26, width: 2.1, height: 1.9, radius: .5, gamepadBtn: "button3", click: function () { x.$gemit("rotateBlock") } }], i.rS.keyboardLayout ? [{ left: 9.75, top: .35, width: 4.9, height: 10, radius: .5 }] : [{ left: 9.75, top: .35, width: 4.9, height: 10, radius: .5 }, { left: 18.9, top: 8.48, width: 1.96, height: 1.96, radius: 1, gamepadBtn: "confirm", click: function () { x.$gemit("hardDrop") } }], [{ left: 9.75, top: 7.2, width: 4.9, height: 3, radius: .5 }, { left: 4.1, top: 3.5, width: 3.9, height: 2.6, radius: .5 }], [{ left: 15.06, top: .8, width: 1.3, height: 1.5, radius: .2 }], i.rS.keyboardLayout ? [{ left: 15.06, top: 2.2, width: 1.3, height: 1.5, radius: .2, gamepadBtn: "confirm", click: function (t) { null == t || t.stopPropagation(), q(!0) } }] : [{ left: 16.83, top: 8.48, width: 1.96, height: 1.96, radius: 1, gamepadBtn: "cancel", click: function (t) { null == t || t.stopPropagation(), x.$gemit("holdBlock") } }, { left: -10, top: -10, width: 0, height: 0, radius: 0, gamepadBtn: "confirm", click: function (t) { null == t || t.stopPropagation(), q(!0) } }], [{ left: 15.06, top: 2.2, width: 1.3, height: 1.5, radius: .2 }], [], [{ left: 4.15, top: 3.5, width: 3.84, height: 2, radius: .2 }]], [[{ left: 17.5, top: 7.2, width: 3.9, height: 3.5, radius: .5, gamepadBtn: "button3", click: function () { k("enterTrain") } }], [{ left: 12.16, top: 2, width: 8.9, height: 2.3, radius: .2 }], [{ left: 12.16, top: 4.3, width: 8.9, height: 4.1, radius: .2 }], [{ left: 14.1, top: 8.7, width: 5.08, height: 1.26, radius: .2, gamepadBtn: "confirm", click: function () { k("trainMid") } }], [{ left: 14.1, top: 8.7, width: 0, height: 0, radius: 0 }], [{ left: 4, top: 8.5, width: 5.1, height: 1.55, radius: .2 }], [{ left: 9.1, top: 8.4, width: 5.6, height: 1.65, radius: .2 }], [{ left: 15.82, top: 8.46, width: 4.74, height: 1.65, radius: .2 }]], [[], [], [{ left: 18.2, top: .4, width: 1.4, height: 1.44, radius: .2 }], []], [[{ left: 17.5, top: 7.2, width: 3.9, height: 3.5, radius: .5, gamepadBtn: "button3", click: function () { k("enterGame", !1) } }], [{ left: 16.82, top: 7.1, width: 1.27, height: 1.27, radius: .7, gamepadBtn: "leftShoulder2", click: function () { q(!1) } }], [{ left: 13.5, top: 8.95, width: 4, height: 1.5, radius: .7, gamepadBtn: "button4", click: function () { x.$gemit("openTask"), q(!1) } }]], [[{ left: 9.9, top: M.value ? 7 : 5, width: 4.6, height: 1.27, radius: .2 }], [{ left: 18.22, top: 7.1, width: 1.27, height: 1.27, radius: .7, gamepadBtn: "leftShoulder1", click: function () { q(!1) } }]], [[{ left: 19.62, top: 7.1, width: 1.27, height: 1.27, radius: .7, gamepadBtn: "rightShoulder1", click: function () { q(!1) } }]], [[{ left: 18.7, top: 3.8, width: 2, height: 1.9, radius: .3 }]], [[{ left: 16.7, top: .5, width: 1.4, height: 1.4, radius: .3, gamepadBtn: "resetSkill", click: function () { k("resetSkill") } }], [{ left: 15.1, top: 2.3, width: 4, height: 1.4, radius: .3 }]]] }), W = { gamepad: { confirm: '<img src="'.concat(null === (u = x.$meGamepad) || void 0 === u ? void 0 : u.btnIconMap.confirm, '" />'), cancel: '<img src="'.concat(null === (d = x.$meGamepad) || void 0 === d ? void 0 : d.btnIconMap.cancel, '" />'), button3: '<img src="'.concat(null === (v = x.$meGamepad) || void 0 === v ? void 0 : v.btnIconMap.button3, '" />'), button4: '<img src="'.concat(null === (m = x.$meGamepad) || void 0 === m ? void 0 : m.btnIconMap.button4, '" />'), leftShoulder2: '<img src="'.concat(null === (p = x.$meGamepad) || void 0 === p ? void 0 : p.btnIconMap.leftShoulder2, '" />'), up: '<img src="'.concat(null === (g = x.$meGamepad) || void 0 === g ? void 0 : g.btnIconMap.confirm, '" />'), skill_1: '<img src="'.concat(null === (_ = x.$meGamepad) || void 0 === _ ? void 0 : _.btnIconMap.leftShoulder2, '" />'), skill_2: '<img src="'.concat(null === (b = x.$meGamepad) || void 0 === b ? void 0 : b.btnIconMap.leftShoulder1, '" />'), skill_3: '<img src="'.concat(null === (h = x.$meGamepad) || void 0 === h ? void 0 : h.btnIconMap.rightShoulder1, '" />'), skill_4: '<img src="'.concat(null === (y = x.$meGamepad) || void 0 === y ? void 0 : y.btnIconMap.rightShoulder2, '" />') }, keyboard: { cancel: '<img src="'.concat(n(76103), '" />'), button3: '<img src="'.concat(n(89201), '" />'), up: '<img src="'.concat(n(49755), '" />'), skill_1: '<img src="'.concat(n(13037), '" />'), skill_2: '<img src="'.concat(n(22358), '" />'), skill_3: '<img src="'.concat(n(447), '" />'), skill_4: '<img src="'.concat(n(41792), '" />') }, mob: { button3: '<img src="'.concat(n(25786), '" />'), up: '<img src="'.concat(n(33178), '" />'), cancel: '<img src="'.concat(n(39002), '" />'), skill_1: '<img src="'.concat(n(31335), '" />'), skill_2: '<img src="'.concat(n(51760), '" />'), skill_3: '<img src="'.concat(n(43849), '" />'), skill_4: '<img src="'.concat(n(26407), '" />') } }, N = function (t) { return t[{ 5: "skill_1", 6: "skill_2", 7: "skill_3", 8: "skill_4" }[D.value]] || "" }, R = (0, a.computed)(function () { var t = L[D.value][F.value - 1].msg, e = i.rS.keyboardLayout ? "keyboard" : "mob"; i.wk.enableGamepad && (e = "gamepad"); var n = W[e], a = N(n); return t.map(function (t) { var e = B(t), i = x.$getI18nWord({ key: e, data: f(f({}, n), {}, { icon: a }) }), r = document.createElement("div"); r.innerHTML = i; var o = r.innerText, c = '<span data-text="'.concat(o, '">').concat(o, "</span>"); return "<div>".concat(i, "</div>").replace(o, c) }).join("") }), F = (0, a.ref)(w.initSubStep || 1), D = (0, a.computed)(function () { return r.Dg.indexOf(w.step) + 1 }), H = function (t) { F.value = t }; (0, a.watch)(D, function () { H(1) }), (0, a.watch)(F, function (t) { O.updateGuideSubStep(t) }, { immediate: !0 }); var V = (0, a.computed)(function () { var t; return (null === (t = j.value[D.value - 1]) || void 0 === t ? void 0 : t[F.value - 1]) || [] }), U = (0, a.computed)(function () { var t = D.value; return 5 === t && 2 === F.value ? x.$getI18nWord("skill_guide_5_2") : (2 === t && [2, 3].includes(F.value) && r.K6 || 8 === t && 1 === F.value && r.K6) && x.$getI18nWord("guide_tip_".concat(t, "_").concat(F.value, "_mob")) || x.$getI18nWord("guide_tip_".concat(t, "_").concat(F.value)) }), K = function (t) { var e = t; E.value && "button4" === t && (e = "resetSkill"); var n = V.value.some(function (t) { return !!t.gamepadBtn }), a = V.value.find(function (t) { return t.gamepadBtn === e }); return null == a || a.click(), n }; S(function (t) { var e = t.button, n = t.direction; "button" === e && K(n) }), C("confirm", function () { i.wk.guideModalVisible && (K("confirm") || q(!0)) }), C("button3", function () { return K("button3") }), C("button4", function () { return K("button4") }), C("cancel", function () { return K("cancel") }), C("leftShoulder2", function () { return K("leftShoulder2") }), C("leftShoulder1", function () { return K("leftShoulder1") }), C("rightShoulder1", function () { return K("rightShoulder1") }), T("leftShoulder2", function () { E.value = !0 }), $("leftShoulder2", function () { E.value = !1 }); var q = function () { var t = arguments.length > 0 && void 0 !== arguments[0] && arguments[0]; if (!(t && 1 === D.value && 2 === F.value || t && 2 === D.value && 3 === F.value || t && 2 === D.value && 4 === F.value || t && 3 === D.value && 1 === F.value || t && 5 === D.value && 1 === F.value || t && 5 === D.value && 2 === F.value || t && 5 === D.value && 3 === F.value || t && 9 === D.value && 1 === F.value || t && 6 === D.value && 2 === F.value || t && 7 === D.value && 1 === F.value || t && 3 === D.value && 4 === F.value)) if (2 !== D.value || 9 !== F.value) if (F.value >= G[D.value - 1].length) k("end", D.value); else { if (4 === D.value && 1 === F.value) { var e = [1, 2, 3].find(function (t) { return 0 !== i.rS.idolEventList[t] }); k("selectedIdol", e) } t && 4 === D.value && 2 === F.value ? k("selectEvent") : 5 !== D.value || 2 !== F.value ? H(F.value + 1) : k("finishSkill1") } else k("guideEnd", D.value) }, X = function () { i.wk.guideModalVisible && q(!0) }, z = function () { l.default.fromTo(".guide-tip-container", { opacity: 0, scale: .9, y: "0.1rem" }, { opacity: 1, scale: 1, y: 0, duration: .2, ease: "power1.inOut" }) }, J = (0, a.computed)(function () { return 2 === D.value && (8 === F.value || i.rS.keyboardLayout && 7 === F.value) }); return (0, a.onMounted)(function () { document.addEventListener("keydown", X), x.$gon("updateSubIdx", q), (0, a.nextTick)(function () { z() }) }), (0, a.onBeforeUnmount)(function () { document.removeEventListener("keydown", X), x.$goff("updateSubIdx", q) }), { __sfc: !0, onBtnPress: C, onDirection: S, onBtnHold: T, onBtnRelease: $, emits: k, vm: x, isMenuExpanded: E, guideStore: O, operateTipRef: P, guideGroup: G, isExtraBonusLevel: M, msgKeyCnt: A, formatMsgKey: B, guideTip: L, hollowList: j, iconPlaceholder: W, getSkillId: N, curGuideTip: R, props: w, subIdx: F, mainIdx: D, updateSubIdx: H, curHollowList: V, curTipMsg: U, triggerHollowEvent: K, toNextTip: q, onKeyDown: X, playPopoverAni: z, highlightBorderVisible: J } } }), p = m, g = (0, n(14486).A)(p, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { staticClass: "guide-modal title-font", class: "guide-modal-".concat(n.mainIdx, "-").concat(n.subIdx), on: { click: function (t) { return t.stopPropagation(), n.toNextTip(!0) } } }, [e("transition", { attrs: { name: "fade" } }, [e("mihoyo-hollow", { directives: [{ name: "show", rawName: "v-show", value: n.curHollowList.length > 0, expression: "curHollowList.length > 0" }], attrs: { opacity: .85, globalConfig: { blur: .03 }, items: n.curHollowList, rem: t.$frame.rem, layout: t.$frame.layoutState, frame: t.$frame.frameState } })], 1), t._v(" "), e("flexible-container", [e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_common_guide_tip_bg.png"), expression: "$getLocalImg('modal_common_guide_tip_bg.png')", modifiers: { bg: !0 } }], staticClass: "guide-tip-container", class: { "guide-tip-container-extra": n.isExtraBonusLevel } }, [e("div", { staticClass: "guide-tip-text", domProps: { innerHTML: t._s(n.curTipMsg) } }), t._v(" "), e("p", { ref: "operateTipRef", staticClass: "operate-tip", attrs: { "data-text": n.operateTipRef && n.operateTipRef.innerText }, domProps: { innerHTML: t._s(n.curGuideTip) } })]), t._v(" "), n.highlightBorderVisible ? e("div", { staticClass: "highlight-border" }) : t._e()])], 1) }, [], !1, null, "80bcc7ea", null).exports }, 18414: function (t, e, n) { function a(t) { return a = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, a(t) } function i(t, e, n) { return (e = function (t) { var e = function (t) { if ("object" != a(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var n = e.call(t, "string"); if ("object" != a(n)) return n; throw new TypeError("@@toPrimitive must return a primitive value.") } return String(t) }(t); return "symbol" == a(e) ? e : e + "" }(e)) in t ? Object.defineProperty(t, e, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : t[e] = n, t } n.d(e, { A: function () { return x } }); var r = n(74061), o = n(99836), c = n(6624), l = n(15908), s = n(20236), u = n(10526), d = n(4115), f = n(97921); function v(t) { return v = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, v(t) } function m() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var l = a && a.prototype instanceof c ? a : c, s = Object.create(l.prototype); return p(s, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), s } var o = {}; function c() { } function l() { } function s() { } e = Object.getPrototypeOf; var u = [][a] ? e(e([][a]())) : (p(e = {}, a, function () { return this }), e), d = s.prototype = c.prototype = Object.create(u); function f(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, s) : (t.__proto__ = s, p(t, i, "GeneratorFunction")), t.prototype = Object.create(d), t } return l.prototype = s, p(d, "constructor", s), p(s, "constructor", l), l.displayName = "GeneratorFunction", p(s, i, "GeneratorFunction"), p(d), p(d, i, "Generator"), p(d, a, function () { return this }), p(d, "toString", function () { return "[object Generator]" }), (m = function () { return { w: r, m: f } })() } function p(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } p = function (t, e, n, a) { function r(e, n) { p(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, p(t, e, n, a) } function g(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } function _(t, e) { var n = Object.keys(t); if (Object.getOwnPropertySymbols) { var a = Object.getOwnPropertySymbols(t); e && (a = a.filter(function (e) { return Object.getOwnPropertyDescriptor(t, e).enumerable })), n.push.apply(n, a) } return n } function b(t) { for (var e = 1; e < arguments.length; e++) { var n = null != arguments[e] ? arguments[e] : {}; e % 2 ? _(Object(n), !0).forEach(function (e) { h(t, e, n[e]) }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(n)) : _(Object(n)).forEach(function (e) { Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(n, e)) }) } return t } function h(t, e, n) { return (e = function (t) { var e = function (t) { if ("object" != v(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var n = e.call(t, "string"); if ("object" != v(n)) return n; throw new TypeError("@@toPrimitive must return a primitive value.") } return String(t) }(t); return "symbol" == v(e) ? e : e + "" }(e)) in t ? Object.defineProperty(t, e, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : t[e] = n, t } function y(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, a = Array(e); n < e; n++)a[n] = t[n]; return a } var k = (0, r.defineComponent)({ __name: "distributionModal", emits: ["close"], setup: function (t, e) { var n = e.emit, a = (0, f.v)().trackEvent, i = (0, d.pT)(!0), v = i.onBtnPress, p = i.onDirection, _ = (0, u.k)().showPromptModal, k = (0, r.getCurrentInstance)().proxy, w = (0, r.ref)(0), I = function () { return (t = new Array(4), function (t) { if (Array.isArray(t)) return y(t) }(t) || function (t) { if ("undefined" != typeof Symbol && null != t[Symbol.iterator] || null != t["@@iterator"]) return Array.from(t) }(t) || function (t, e) { if (t) { if ("string" == typeof t) return y(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? y(t, e) : void 0 } }(t) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }()).map(function (t, e) { return { level: c.wk.pageInfo.user_activity_info.skill_info[(0, o.iT)(e + 1)] } }); var t }, C = (0, r.computed)(function () { var t = !1; return S.value.forEach(function (e, n) { e.level !== T.value[n].level && (t = !0) }), t }), S = (0, r.ref)(I()), T = (0, r.ref)(I()), $ = (0, r.computed)(function () { return T.value.reduce(function (t, e) { return t + e.level }, 0) - S.value.reduce(function (t, e) { return t + e.level }, 0) }), x = function () { k.$playEffect(l.Ie.Common_Click), n("close") }, E = (0, r.computed)(function () { var t = P.value.level; return k.$getI18nWord((0, o.n0)(t, w.value)) }), O = function (t) { k.$playEffect(l.Ie.Common_Click), w.value = t }, P = (0, r.computed)(function () { return S.value[w.value] }), G = function (t, e) { if ((A(t) || 1 !== e) && (M(t) || -1 !== e)) { a("popup", "click", 1 === e ? "add" : "minus", "".concat(t + 1)), k.$playEffect(l.Ie.Common_Click); var n = S.value[t].level, i = Math.max(1, n + e); S.value[t].level = i } }, M = function (t) { return S.value[t].level > 1 && w.value === t }, A = function (t) { return w.value === t && $.value > 0 }, B = function () { W.value && (a("popup", "click", "clear", ""), k.$playEffect(l.Ie.Common_Click), S.value = S.value.map(function (t) { return b(b({}, t), {}, { level: 1 }) })) }, L = function () { var t, e = (t = m().m(function t() { var e; return m().w(function (t) { for (; ;)switch (t.n) { case 0: if (j.value) { t.n = 1; break } return t.a(2); case 1: return a("popup", "click", "save", ""), k.$playEffect(l.Ie.Common_Click), t.n = 2, _(k.$getI18nWord("save_prompt_title"), k.$getI18nWord("save_prompt_desc")); case 2: return e = S.value.reduce(function (t, e, n) { return b(b({}, t), {}, h({}, (0, o.iT)(n + 1), e.level)) }, {}), t.n = 3, (0, c._L)(e); case 3: n("close"); case 4: return t.a(2) } }, t) }), function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { g(r, a, i, o, c, "next", t) } function c(t) { g(r, a, i, o, c, "throw", t) } o(void 0) }) }); return function () { return e.apply(this, arguments) } }(), j = (0, r.computed)(function () { return C.value && 0 === $.value }), W = (0, r.computed)(function () { return S.value.some(function (t) { return 1 !== t.level }) }); return v("cancel", function () { x() }), v("button3", function () { L() }), v("button4", function () { B() }), p(function (t) { var e = t.direction; if (["up", "down"].includes(e)) { var n = "up" === e ? -1 : 1, a = Math.max(0, Math.min(w.value + n, S.value.length - 1)); O(a) } if (["left", "right"].includes(e)) { var i = "left" === e ? -1 : 1; G(w.value, i) } }), (0, r.onMounted)(function () { a("popup", "view", "ability_detail", ""), k.$playEffect(l.Ie.Popup) }), { __sfc: !0, trackEvent: a, onBtnPress: v, onDirection: p, showPromptModal: _, vm: k, abilityActiveId: w, getAbilityStruct: I, hasChanged: C, abilityList: S, savedPoint: T, leftPoints: $, emits: n, closeModal: x, baseAbilityDesc: E, setAbilityActiveId: O, curActiveAbility: P, getIsAbilityUnlock: function (t) { return P.value.level >= (1 === t ? s.sb : s.zV) }, handlePoint: G, showMinusBtn: M, showPlusBtn: A, handleResetAbility: B, saveAbility: L, enableSave: j, enableReset: W, getLevelText: o.WG, EXTRA_BONUS_LEVEL_1: s.sb, EXTRA_BONUS_LEVEL_2: s.zV, state: c.wk } } }), w = k, I = n(14486), C = (0, I.A)(w, function () { var t = this, e = t._self._c, a = t._self._setupProxy; return e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_distribution_modal_bg.png"), expression: "$getLocalImg('modal_distribution_modal_bg.png')", modifiers: { bg: !0 } }], staticClass: "distribution-modal title-font" }, [e("div", { staticClass: "close-btn", on: { click: a.closeModal } }), t._v(" "), e("div", { staticClass: "modal-title" }, [e("i"), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("distribution_modal_title")))])]), t._v(" "), e("div", { staticClass: "left-points", domProps: { innerHTML: t._s(t.$getI18nWord({ key: "left_point_tip", data: { num: "<span class='left-points-value'>".concat(a.leftPoints, "</span>") } })) } }), t._v(" "), e("div", { staticClass: "modal-content" }, [e("div", { staticClass: "ability-content" }, [e("div", { staticClass: "ability-list" }, t._l(a.abilityList, function (i, r) { var o = i.level; return e("div", { key: "ability-item-".concat(r + 1) }, [o > 0 ? e("hover-btn", { staticClass: "ability-item", class: "ability-item__".concat(r + 1), attrs: { img: n(72406), "img-hover": n(12823), "img-active": n(12823), "need-active": !0, "is-active": a.abilityActiveId === r }, on: { click: function (t) { return a.setAbilityActiveId(r) } } }, [e("div", { staticClass: "ability-icon" }), t._v(" "), e("div", { staticClass: "ability-info" }, [e("p", { staticClass: "ability-name", attrs: { "data-text": t.$getI18nWord("ability_name_".concat(r + 1)) } }, [t._v(t._s(t.$getI18nWord("ability_name_".concat(r + 1))))]), t._v(" "), e("p", { staticClass: "ability-level" }, [t._v(t._s(a.getLevelText(o)))])]), t._v(" "), a.abilityActiveId === r ? [e("div", { staticClass: "operate-btn operate-btn__minus", class: { "operate-btn__disabled": !a.showMinusBtn(r) }, on: { click: function (t) { return a.handlePoint(r, -1) } } }, [a.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: n(66617), alt: "" } }) : t._e()]), t._v(" "), e("div", { staticClass: "operate-btn operate-btn__plus", class: { "operate-btn__disabled": !a.showPlusBtn(r) }, on: { click: function (t) { return a.handlePoint(r, 1) } } }, [a.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: n(46402), alt: "" } }) : t._e()])] : t._e()], 2) : e("div", { staticClass: "ability-item ability-item__locked" }, [e("p", { attrs: { "data-text": t.$getI18nWord("ability_locked") } }, [t._v(t._s(t.$getI18nWord("ability_locked")))])])], 1) }), 0), t._v(" "), e("div", { staticClass: "ability-detail" }, [e("div", { staticClass: "ability-detail-title" }, [e("span", { staticClass: "ability-detail-title-text", attrs: { "data-text": t.$getI18nWord({ key: "ability_level_label", data: { level: a.curActiveAbility.level } }) } }, [t._v(t._s(t.$getI18nWord({ key: "ability_level_label", data: { level: a.curActiveAbility.level } })))])]), t._v(" "), e("div", { staticClass: "ability-detail-content" }, [e("div", { staticClass: "ability-detail-content__base" }, [e("img", { staticClass: "content-title", attrs: { src: t.$getI18nWord("ability_title"), alt: "" } }), t._v(" "), e("p", { domProps: { innerHTML: t._s(a.baseAbilityDesc) } })]), t._v(" "), e("div", { staticClass: "ability-detail-content__level" }, [e("img", { staticClass: "content-title", attrs: { src: t.$getI18nWord("ability_title"), alt: "" } }), t._v(" "), t._l(2, function (n) { return e("div", { key: n, staticClass: "skill-extra-info", class: "skill-extra-info__".concat(a.getIsAbilityUnlock(n) ? "unlock" : "locked") }, [e("div", { staticClass: "level-label" }, [t._v(t._s(a.getLevelText(1 === n ? a.EXTRA_BONUS_LEVEL_1 : a.EXTRA_BONUS_LEVEL_2)))]), t._v(" "), e("p", { domProps: { innerHTML: t._s(t.$getI18nWord("ability_".concat(a.abilityActiveId + 1, "_extra_buff_").concat(n))) } })]) })], 2)])])]), t._v(" "), e("div", { staticClass: "btn-container" }, [e("div", { staticClass: "btm-btn btm-btn__reset", class: { "btm-btn__disabled": !a.enableReset }, on: { click: a.handleResetAbility } }, [a.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.button4, alt: "" } }) : t._e(), t._v(" "), e("span", { attrs: { "data-text": t.$getI18nWord("modal_reset_btn") } }, [t._v(t._s(t.$getI18nWord("modal_reset_btn")))])]), t._v(" "), e("div", { staticClass: "btm-btn btm-btn__save", class: { "btm-btn__disabled": !a.enableSave }, on: { click: a.saveAbility } }, [a.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.button3, alt: "" } }) : t._e(), t._v(" "), e("span", { attrs: { "data-text": t.$getI18nWord("modal_save_btn") } }, [t._v(t._s(t.$getI18nWord("modal_save_btn")))])])])])]) }, [], !1, null, null, null).exports; function S(t) { return function (t) { if (Array.isArray(t)) return T(t) }(t) || function (t) { if ("undefined" != typeof Symbol && null != t[Symbol.iterator] || null != t["@@iterator"]) return Array.from(t) }(t) || function (t, e) { if (t) { if ("string" == typeof t) return T(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? T(t, e) : void 0 } }(t) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }() } function T(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, a = Array(e); n < e; n++)a[n] = t[n]; return a } var $ = (0, r.defineComponent)({ __name: "skillModal", props: { defaultTab: null, defaultActiveId: null }, emits: ["close"], setup: function (t, e) { var n = e.emit, a = t, i = (0, f.v)().trackEvent, v = (0, d.pT)(!0), m = v.onBtnPress, p = v.onDirection, g = (0, r.getCurrentInstance)().proxy, _ = (0, u.k)().showPromptModal, b = (0, r.ref)(a.defaultTab || 0), h = (0, r.ref)(0 === a.defaultTab ? a.defaultActiveId : 0), y = (0, r.ref)(1 === a.defaultTab ? a.defaultActiveId - 1 : 0), k = (0, r.ref)(["ability", "skill"]), w = function () { g.$playEffect(l.Ie.Common_Click), n("close") }, I = (0, r.computed)(function () { return c.wk.pageInfo.user_activity_info.activity_progress.week_challenge_finished[4] && "game" !== c.wk.currentPage }), T = (0, r.computed)(function () { var t = +h.value + 1, e = c.wk.pageInfo.user_activity_info.skill_info[(0, o.iT)(t)]; return g.$getI18nWord((0, o.n0)(e, h.value)) }), $ = function () { g.$commonModal(C) }, x = (0, r.computed)(function () { var t = +h.value + 1; return c.wk.pageInfo.user_activity_info.skill_info[(0, o.iT)(t)] }), E = function (t) { return c.wk.pageInfo.user_activity_info.skill_info[(0, o.iT)(t)] }, O = function (t) { g.$playEffect(l.Ie.Common_Click), b.value = t, i("popup", "click", "tab_ability", t + 1) }, P = function () { I.value && (i("popup", "click", "reenter", ""), g.$playEffect(l.Ie.Common_Click), n("close"), $()) }, G = function (t) { var e = b.value + t; e < 0 && (e = 1), e > 1 && (e = 0), O(e) }; return m("leftShoulder1", function () { G(-1) }), m("rightShoulder1", function () { G(1) }), p(function (t) { var e = t.direction; if (["up", "down"].includes(e)) { var n = "up" === e ? -1 : 1, a = (0 === b.value ? h.value : y.value) + n; if (0 === b.value) { var i = S(new Array(4)).filter(function (t, e) { return E(e + 1) > 0 }).length; h.value = Math.max(0, Math.min(a, i - 1)) } else { var r = S(new Array(4)).map(function (t, e) { return (0, c.el)(e + 1) }).filter(Boolean).length; y.value = Math.max(0, Math.min(a, r - 1)) } } }), m("button3", function () { I.value && P() }), m("cancel", function () { w() }, "Escape"), (0, r.onMounted)(function () { i("popup", "view", "idol_help", ""), g.$playEffect(l.Ie.Popup) }), { __sfc: !0, trackEvent: i, onBtnPress: m, onDirection: p, props: a, vm: g, showPromptModal: _, curTab: b, abilityActiveId: h, skillActiveId: y, tabList: k, emits: n, closeModal: w, canRenew: I, baseAbilityDesc: T, showDistributionModal: $, setAbilityActiveId: function (t) { g.$playEffect(l.Ie.Common_Click); var e = +t + 1; i("popup", "click", "idol_ability", e), 0 !== c.wk.pageInfo.user_activity_info.skill_info[(0, o.iT)(e)] ? h.value = t : _(g.$getI18nWord("ability_locked_title"), g.$getI18nWord({ key: "ability_locked_desc", data: { n: l.hF[e] } }), !1) }, setSkillActiveId: function (t) { g.$playEffect(l.Ie.Common_Click), i("popup", "click", "team_abiltiy", t), (0, c.el)(t) ? y.value = t - 1 : _(g.$getI18nWord("skill_locked_title"), g.$getI18nWord({ key: "skill_locked_desc", data: { n: "<span>".concat(t, "</span>") } }), !1) }, curAbilityLevel: x, getIsAbilityUnlock: function (t) { return x.value >= (1 === t ? s.sb : s.zV) }, getAbilityLevel: E, setCurTab: O, onRenewClick: P, switchTab: G, getIsAbilityFocused: function (t) { return !!c.wk.enableGamepad && (0 === b.value ? h : y).value === t - 1 }, getLevelText: o.WG, formatRichText: o.$G, state: c.wk, isSkillUnlock: c.el, EXTRA_BONUS_LEVEL_1: s.sb, EXTRA_BONUS_LEVEL_2: s.zV } } }), x = (0, I.A)($, function () { var t = this, e = t._self._c, a = t._self._setupProxy; return e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_common_modal_bg.png"), expression: "$getLocalImg('modal_common_modal_bg.png')", modifiers: { bg: !0 } }], staticClass: "skill-modal title-font" }, [e("div", { staticClass: "close-btn", on: { click: a.closeModal } }), t._v(" "), e("div", { staticClass: "modal-title" }, [e("i"), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("skill_modal_title")))]), t._v(" "), e("div", { directives: [{ name: "show", rawName: "v-show", value: 1 === a.curTab, expression: "curTab === 1" }], staticClass: "skill-storage" }, [e("i"), t._v(" "), e("span", [t._v(t._s(a.state.pageInfo.user_activity_info.skill_info.skill_point))])])]), t._v(" "), e("div", { staticClass: "modal-header" }, [e("div", { staticClass: "modal-tab" }, t._l(a.tabList, function (i, r) { return e("hover-btn", { key: r, staticClass: "modal-tab-item", attrs: { img: n(7215), "img-hover": n(64548), "img-active": n(64548), "need-active": !0, "is-active": a.curTab === r, "data-text": t.$getI18nWord("skill_modal_".concat(i, "_tab")) }, on: { click: function (t) { return a.setCurTab(r) } } }, [e("span", [t._v(t._s(t.$getI18nWord("skill_modal_".concat(i, "_tab"))))]), t._v(" "), a.state.enableGamepad ? [0 === r ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.leftShoulder1 } }) : t._e(), t._v(" "), 1 === r ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.rightShoulder1 } }) : t._e()] : t._e()], 2) }), 1), t._v(" "), a.canRenew ? e("div", { directives: [{ name: "show", rawName: "v-show", value: 0 === a.curTab, expression: "curTab === 0" }], staticClass: "renew-btn", on: { click: a.onRenewClick } }, [a.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.button3, alt: "" } }) : t._e(), t._v(" "), e("span", { attrs: { "data-text": t.$getI18nWord("skill_modal_renew_btn") } }, [t._v(t._s(t.$getI18nWord("skill_modal_renew_btn")))])]) : t._e()]), t._v(" "), e("div", { staticClass: "modal-content" }, [e("div", { directives: [{ name: "show", rawName: "v-show", value: 0 === a.curTab, expression: "curTab === 0" }], staticClass: "ability-content" }, [e("div", { staticClass: "ability-list" }, t._l(4, function (r) { return e("div", { key: "ability-item-".concat(r), staticClass: "ability-item-container" }, [a.getAbilityLevel(r) > 0 ? e("hover-btn", { staticClass: "ability-item", class: i(i({}, "ability-item__".concat(r), !0), "ability-item__focused", a.getIsAbilityFocused(r)), attrs: { img: n(72406), "img-hover": n(12823), "img-active": n(12823), "need-active": !0, "is-active": a.abilityActiveId === r - 1 }, on: { click: function (t) { return a.setAbilityActiveId(r - 1) } } }, [e("div", { staticClass: "ability-icon" }), t._v(" "), e("div", { staticClass: "ability-info" }, [e("p", { staticClass: "ability-name", attrs: { "data-text": t.$getI18nWord("ability_name_".concat(r)) } }, [t._v(t._s(t.$getI18nWord("ability_name_".concat(r))))]), t._v(" "), e("p", { staticClass: "ability-level" }, [t._v(t._s(a.getLevelText(a.getAbilityLevel(r))))])])]) : e("div", { staticClass: "ability-item ability-item__locked", on: { click: function (t) { return a.setAbilityActiveId(r - 1) } } }, [e("div", { staticClass: "ability-icon_locked" }), t._v(" "), e("p", { attrs: { "data-text": t.$getI18nWord("ability_locked") } }, [t._v(t._s(t.$getI18nWord("ability_locked")))])])], 1) }), 0), t._v(" "), e("div", { staticClass: "ability-detail" }, [e("div", { staticClass: "ability-detail-title" }, [e("span", { staticClass: "ability-detail-title-text", attrs: { "data-text": t.$getI18nWord({ key: "ability_level_label", data: { level: a.curAbilityLevel } }) } }, [t._v(t._s(t.$getI18nWord({ key: "ability_level_label", data: { level: a.curAbilityLevel } })))])]), t._v(" "), e("div", { staticClass: "ability-detail-content" }, [e("div", { staticClass: "ability-detail-content__base" }, [e("img", { staticClass: "content-title", attrs: { src: t.$getI18nWord("ability_title"), alt: "" } }), t._v(" "), e("p", { domProps: { innerHTML: t._s(a.baseAbilityDesc) } })]), t._v(" "), e("div", { staticClass: "ability-detail-content__level" }, [e("img", { staticClass: "content-title", attrs: { src: t.$getI18nWord("ability_title"), alt: "" } }), t._v(" "), t._l(2, function (n) { return e("div", { key: n, staticClass: "skill-extra-info", class: "skill-extra-info__".concat(a.getIsAbilityUnlock(n) ? "unlock" : "locked") }, [e("div", { staticClass: "level-label" }, [t._v(t._s(a.getLevelText(1 === n ? a.EXTRA_BONUS_LEVEL_1 : a.EXTRA_BONUS_LEVEL_2)))]), t._v(" "), e("p", { domProps: { innerHTML: t._s(t.$getI18nWord("ability_".concat(a.abilityActiveId + 1, "_extra_buff_").concat(n))) } })]) })], 2)])])]), t._v(" "), e("div", { directives: [{ name: "show", rawName: "v-show", value: 1 === a.curTab, expression: "curTab === 1" }], staticClass: "skill-content" }, [e("div", { staticClass: "skill-list" }, t._l(4, function (r) { return e("div", { key: "ability-item-".concat(r) }, [a.isSkillUnlock(r) ? e("hover-btn", { staticClass: "ability-item", class: i(i({}, "ability-item__".concat(r), !0), "ability-item__focused", a.getIsAbilityFocused(r)), attrs: { img: n(72406), "img-hover": n(12823), "img-active": n(12823), "need-active": !0, "is-active": a.skillActiveId === r - 1 }, on: { click: function (t) { return a.setSkillActiveId(r) } } }, [e("div", { staticClass: "ability-icon" }), t._v(" "), e("div", { staticClass: "ability-info" }, [e("p", { staticClass: "ability-name", attrs: { "data-text": a.formatRichText(t.$getI18nWord("skill_name_".concat(r))) }, domProps: { innerHTML: t._s(t.$getI18nWord("skill_name_".concat(r))) } })])]) : e("div", { staticClass: "ability-item ability-item__locked", on: { click: function (t) { return a.setSkillActiveId(r) } } }, [e("div", { staticClass: "ability-icon_locked" }), t._v(" "), e("p", { attrs: { "data-text": t.$getI18nWord("ability_locked") } }, [t._v(t._s(t.$getI18nWord("ability_locked")))])])], 1) }), 0), t._v(" "), e("div", { staticClass: "ability-detail" }, [e("div", { staticClass: "ability-detail-title" }, [e("span", { staticClass: "ability-detail-title-text", attrs: { "data-text": t.$getI18nWord("skill_name_".concat(a.skillActiveId + 1)) } }, [t._v(t._s(t.$getI18nWord("skill_name_".concat(a.skillActiveId + 1))))]), t._v(" "), a.skillActiveId + 1 !== 4 ? e("div", { staticClass: "skill-cost" }, [e("i"), t._v(" "), e("span", [t._v("1")])]) : t._e()]), t._v(" "), e("div", { staticClass: "ability-detail-content" }, [e("img", { staticClass: "content-title", attrs: { src: t.$getI18nWord("skill_title"), alt: "" } }), t._v(" "), e("p", { domProps: { innerHTML: t._s(t.$getI18nWord("skill_desc_".concat(a.skillActiveId + 1))) } })])])])]), t._v(" "), a.state.enableGamepad ? e("div", { staticClass: "gamepad-tip" }, [e("div", { staticClass: "gamepad-tip-item" }, [e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.cancel, alt: "" } }), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("gamepad_back_btn")))])])]) : t._e()]) }, [], !1, null, null, null).exports }, 29076: function (t, e, n) { n.d(e, { A: function () { return h } }); var a = n(74061), i = n(15908), r = n(6624), o = n(4115), c = n(57905), l = n(97921); function s(t) { return s = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, s(t) } function u(t) { return function (t) { if (Array.isArray(t)) return d(t) }(t) || function (t) { if ("undefined" != typeof Symbol && null != t[Symbol.iterator] || null != t["@@iterator"]) return Array.from(t) }(t) || function (t, e) { if (t) { if ("string" == typeof t) return d(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? d(t, e) : void 0 } }(t) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }() } function d(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, a = Array(e); n < e; n++)a[n] = t[n]; return a } function f() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var l = a && a.prototype instanceof c ? a : c, s = Object.create(l.prototype); return v(s, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), s } var o = {}; function c() { } function l() { } function s() { } e = Object.getPrototypeOf; var u = [][a] ? e(e([][a]())) : (v(e = {}, a, function () { return this }), e), d = s.prototype = c.prototype = Object.create(u); function m(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, s) : (t.__proto__ = s, v(t, i, "GeneratorFunction")), t.prototype = Object.create(d), t } return l.prototype = s, v(d, "constructor", s), v(s, "constructor", l), l.displayName = "GeneratorFunction", v(s, i, "GeneratorFunction"), v(d), v(d, i, "Generator"), v(d, a, function () { return this }), v(d, "toString", function () { return "[object Generator]" }), (f = function () { return { w: r, m: m } })() } function v(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } v = function (t, e, n, a) { function r(e, n) { v(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, v(t, e, n, a) } function m(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } function p(t) { return function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { m(r, a, i, o, c, "next", t) } function c(t) { m(r, a, i, o, c, "throw", t) } o(void 0) }) } } function g(t, e, n) { return (e = function (t) { var e = function (t) { if ("object" != s(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var n = e.call(t, "string"); if ("object" != s(n)) return n; throw new TypeError("@@toPrimitive must return a primitive value.") } return String(t) }(t); return "symbol" == s(e) ? e : e + "" }(e)) in t ? Object.defineProperty(t, e, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : t[e] = n, t } var _ = (0, a.defineComponent)({ __name: "reviewModal", emits: ["close", "review"], setup: function (t, e) { var n = e.emit, s = (0, l.v)().trackEvent, d = (0, o.pT)(!0), v = d.onDirection, m = d.onBtnPress, _ = (0, a.getCurrentInstance)().proxy, b = (0, a.ref)([{ id: 1, tab: 4, week: 1, type: "opening", chapterId: 10101 }, { id: 2, tab: 3, week: 1, type: "mid", chapterId: 20101 }, { id: 3, tab: 4, week: 1, type: "ending", chapterId: 10102 }, { id: 6, tab: 4, week: 2, type: "opening", chapterId: 10201 }, { id: 7, tab: 3, week: 2, type: "mid", chapterId: 20201 }, { id: 8, tab: 4, week: 2, type: "ending", chapterId: 10202 }, { id: 9, tab: 4, week: 3, type: "opening", chapterId: 10301 }, { id: 10, tab: 3, week: 3, type: "mid", chapterId: 20301 }, { id: 11, tab: 4, week: 3, type: "ending", chapterId: 10302 }, { id: 12, tab: 4, week: 4, type: "opening", chapterId: 10401 }, { id: 13, tab: 3, week: 4, type: "mid", chapterId: 20401 }, { id: 14, tab: 4, week: 4, type: "ending", chapterId: 10402 }, { id: 15, tab: 4, week: 5, type: "opening", chapterId: 10501 }, { id: 16, tab: 3, week: 5, type: "ending", chapterId: 10502 }, { id: 17, tab: 4, week: 5, type: "ending", chapterId: 10503 }, { id: 18, tab: 2, level: 1, idolId: 1, type: "idol", chapterId: 30101 }, { id: 19, tab: 2, level: 3, idolId: 1, type: "idol", chapterId: 30102 }, { id: 20, tab: 2, level: 6, idolId: 1, type: "idol", chapterId: 30103 }, { id: 21, tab: 2, level: 1, idolId: 2, type: "idol", chapterId: 30201 }, { id: 22, tab: 2, level: 3, idolId: 2, type: "idol", chapterId: 30202 }, { id: 23, tab: 2, level: 6, idolId: 2, type: "idol", chapterId: 30203 }, { id: 24, tab: 2, level: 1, idolId: 3, type: "idol", chapterId: 30301 }, { id: 25, tab: 2, level: 3, idolId: 3, type: "idol", chapterId: 30302 }, { id: 26, tab: 2, level: 6, idolId: 3, type: "idol", chapterId: 30303 }]), h = (0, a.ref)(1), y = (0, a.ref)(1), k = (0, a.ref)(null), w = function (t) { var e = Math.max(1, Math.min(4, t)); _.$playEffect(i.Ie.Common_Click), y.value = e, k.value.scrollTo({ y: 0 }, 0), k.value.refresh(), G(), s("popup", "click", "category", t) }, I = function () { _.$playEffect(i.Ie.Common_Click), n("close") }, C = (0, a.computed)(function () { return b.value.find(function (t) { return t.id === h.value }) }), S = function (t) { var e = b.value.find(function (e) { return e.id === t }).chapterId; return r.wk.pageInfo.user_activity_info.occurrence_info.occurrences.find(function (t) { return t.occurrence_id === e }).status }, T = function () { var t = b.value.filter(function (t) { return t.tab === y.value || 1 === y.value }), e = t.filter(function (t) { return S(t.id) === c.OX.LOCKED }); return { 1: t.filter(function (t) { return S(t.id) === c.OX.IN_PROGRESS }), 2: t.filter(function (t) { return S(t.id) === c.OX.COMPLETED }), 3: e } }, $ = function () { var t = {}; return b.value.forEach(function (e) { var n = e.type, a = e.idolId; "idol" === n && (t[a] || (t[a] = []), t[a].push(e)) }), t }, x = function () { return { 1: b.value.filter(function (t) { return "mid" === t.type }) } }, E = function () { return { 1: b.value.filter(function (t) { return ["ending", "opening"].includes(t.type) }) } }, O = (0, a.ref)({ 1: T(), 2: $(), 3: x(), 4: E() }), P = function () { var t = C.value, e = t.chapterId, a = t.type, r = t.week, o = t.idolId, l = S(h.value); if (l !== c.OX.LOCKED) { _.$playEffect(i.Ie.Common_Click); var u = l === c.OX.IN_PROGRESS; s("popup", "click", u ? "to_event" : "event_review", e), ["opening", "mid", "ending"].includes(a) && n("review", { week: r, type: a, chapterId: e }), "idol" === a && n("review", { week: r, type: a, idolId: o, chapterId: e }), n("close") } }; (0, a.watch)(y, function () { for (var t = Object.keys(O.value), e = 0; e < t.length; e++) { var n = t[e], a = O.value[y.value][n]; if (a.length > 0) { h.value = a[0].id; break } } }, { immediate: !0 }); var G = function () { var t = p(f().m(function t() { return f().w(function (t) { for (; ;)switch (t.n) { case 0: return t.n = 1, (0, a.nextTick)(); case 1: document.querySelectorAll(".side-menu-item-text").forEach(function (t) { t.clientHeight / _.$frame.rem >= .624 && (t.className = "".concat(t.className, " need-scale")) }); case 2: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), M = function () { var t = p(f().m(function t() { return f().w(function (t) { for (; ;)switch (t.n) { case 0: return t.n = 1, (0, a.nextTick)(); case 1: document.querySelectorAll(".modal-tab-item span").forEach(function (t) { t.clientWidth / _.$frame.rem >= 2.6 && (t.className = "".concat(t.className, " need-scale")) }); case 2: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(); (0, a.onMounted)(function () { s("popup", "view", "event_review", ""), _.$playEffect(i.Ie.Popup), G(), M() }); var A = (0, a.computed)(function () { var t = S(h.value); return t !== c.OX.LOCKED ? t === c.OX.COMPLETED ? 2 : 1 : 3 }); return m("leftShoulder1", function () { w(y.value - 1) }), m("rightShoulder1", function () { w(y.value + 1) }), v(function (t) { var e = t.direction; if (["up", "down"].includes(e)) { var n = Object.keys(O.value[y.value]).reduce(function (t, e) { return [].concat(u(t), u(O.value[y.value][e])) }, []); if (!n.length) return; var a = n.findIndex(function (t) { return t.id === h.value }), i = a; "up" === e && a > 0 ? i = a - 1 : "down" === e && a < n.length - 1 && (i = a + 1), i !== a && (h.value = n[i].id, k.value && "function" == typeof k.value.scrollTo && k.value.scrollTo({ y: Math.max(0, .9 * i * _.$frame.rem) }, 100)) } }), m("button3", function () { P() }), m("cancel", function () { I() }, "Escape"), { __sfc: !0, trackEvent: s, onDirection: v, onBtnPress: m, emits: n, vm: _, reviewList: b, curReviewId: h, curTab: y, sideMenuScrollRef: k, setCurTab: w, closeModal: I, setCurReviewId: function (t, e) { _.$playEffect(i.Ie.Common_Click), h.value = t; var n = S(t), a = g(g(g({}, c.OX.IN_PROGRESS, "unread"), c.OX.COMPLETED, "read"), c.OX.LOCKED, "locked"); s("popup", "click", a[n], e) }, curReviewInfo: C, getReviewState: S, getUnlockRule: function (t) { var e = C.value, n = e.type, a = e.week, i = []; if (["opening", "mid", "ending"].includes(n) && 5 !== a) { var o = _.$getI18nWord({ key: "lock_desc_".concat(n), data: { n: a } }); i.push({ msg: o, isUnlock: S(t) !== c.OX.LOCKED }) } if (["opening", "mid", "ending"].includes(n) && 5 === a) { var l = _.$getI18nWord({ key: "lock_desc_".concat("opening" === n ? "opening" : "ending"), data: { n: a } }); i.push({ msg: l, isUnlock: S(t) !== c.OX.LOCKED }) } if ("idol" === n) { var s = C.value, u = s.level, d = s.idolId, f = _.$getI18nWord("idol_name_".concat(d)), v = _.$getI18nWord({ key: "lock_desc_idol", data: { level: u, name: f } }), m = r.wk.pageInfo.user_activity_info.friend_ship_level["level_".concat(d)] >= u; if (i.push({ msg: v, isUnlock: m }), +u >= 3) { var p = t - 1, g = _.$getI18nWord("review_title_".concat(t - 1)), b = _.$getI18nWord({ key: "lock_desc_prev", data: { name: f, event_name: g } }); i.push({ msg: b, isUnlock: S(p) === c.OX.COMPLETED }) } } return i }, initTotalList: T, initIdolList: $, initMidList: x, initMainstoryList: E, renderList: O, onConfirmBtnClick: P, updateItemStyle: G, updateTabStyle: M, curConfirmBtnState: A, getSideTabTitle: function (t) { return 1 === y.value ? _.$getI18nWord("review_item_type_".concat(t)) : 2 === y.value ? _.$getI18nWord("idol_name_".concat(t)) : "" }, getEventTitle: function (t) { return S(t) === c.OX.LOCKED ? _.$getI18nWord("review_btn_3") : _.$getI18nWord("review_title_".concat(t)) }, getOverview: function (t) { return S(t) === c.OX.LOCKED ? _.$getI18nWord("review_btn_3") : _.$getI18nWord("review_overview_".concat(t)) }, ME_SCROLL_OPS: i.e7, state: r.wk, OccurrenceStatus: c.OX } } }), b = _, h = (0, n(14486).A)(b, function () { var t = this, e = t._self._c, a = t._self._setupProxy; return e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_common_modal_bg.png"), expression: "$getLocalImg('modal_common_modal_bg.png')", modifiers: { bg: !0 } }], staticClass: "review-modal title-font" }, [e("div", { staticClass: "close-btn", on: { click: a.closeModal } }), t._v(" "), e("div", { staticClass: "modal-title" }, [e("i"), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("review_modal_title")))])]), t._v(" "), e("div", { staticClass: "modal-tab-container" }, [a.state.enableGamepad ? e("img", { staticClass: "gamepad-icon left-icon", attrs: { src: t.$meGamepad.btnIconMap.leftShoulder1 } }) : t._e(), t._v(" "), t._l(4, function (i) { return e("hover-btn", { key: i, staticClass: "modal-tab-item", attrs: { img: n(76296), "img-hover": n(81041), "img-active": n(81041), "need-active": !0, "is-active": a.curTab === i }, on: { click: function (t) { return a.setCurTab(i) } } }, [e("span", { attrs: { "data-text": t.$getI18nWord("review_tab_".concat(i)) } }, [t._v(t._s(t.$getI18nWord("review_tab_".concat(i))))])]) }), t._v(" "), a.state.enableGamepad ? e("img", { staticClass: "gamepad-icon right-icon", attrs: { src: t.$meGamepad.btnIconMap.rightShoulder1 } }) : t._e()], 2), t._v(" "), e("div", { staticClass: "modal-content" }, [e("div", { staticClass: "modal-side-menu-container" }, [e("me-scroll", { ref: "sideMenuScrollRef", attrs: { ops: a.ME_SCROLL_OPS } }, t._l(Object.keys(a.renderList[a.curTab]), function (i) { return e("div", { key: i }, [a.renderList[a.curTab][i].length > 0 ? e("div", { staticClass: "side-menu", class: "side-menu__".concat(a.curTab, "-").concat(i) }, [a.getSideTabTitle(i) ? e("div", { staticClass: "side-menu-title" }, [t._v(t._s(a.getSideTabTitle(i)))]) : t._e(), t._v(" "), e("div", { staticClass: "side-menu-list" }, t._l(a.renderList[a.curTab][i], function (i) { return e("div", { key: i.id, staticClass: "side-menu-item-container" }, [a.getReviewState(i.id) !== a.OccurrenceStatus.LOCKED ? e("hover-btn", { staticClass: "side-menu-item", class: { "side-menu-item__focused": a.state.enableGamepad && a.curReviewId === i.id, "side-menu-item__unread": a.getReviewState(i.id) === a.OccurrenceStatus.IN_PROGRESS, "side-menu-item__read": a.getReviewState(i.id) === a.OccurrenceStatus.COMPLETED }, attrs: { img: n(16107), "img-hover": n(16448), "img-active": n(16448), "need-active": !0, "is-active": a.curReviewId === i.id }, on: { click: function (t) { return a.setCurReviewId(i.id, i.chapterId) } } }, [e("span", { staticClass: "side-menu-item-text", attrs: { "data-text": a.getEventTitle(i.id) } }, [t._v(t._s(a.getEventTitle(i.id)))])]) : e("div", { staticClass: "side-menu-item side-menu-item__locked", class: { "side-menu-item__focused": a.state.enableGamepad && a.curReviewId === i.id }, on: { click: function (t) { return a.setCurReviewId(i.id, i.chapterId) } } }, [e("span", { attrs: { "data-text": a.getEventTitle(i.id) } }, [t._v(t._s(a.getEventTitle(i.id)))])])], 1) }), 0)]) : t._e()]) }), 0)], 1), t._v(" "), e("div", { staticClass: "modal-side-content-container" }, [e("div", { staticClass: "event-info-container" }, [e("div", { staticClass: "event-name", attrs: { "data-text": a.getEventTitle(a.curReviewId) } }, [t._v(t._s(a.getEventTitle(a.curReviewId)))]), t._v(" "), "idol" === a.curReviewInfo.type ? e("div", { staticClass: "idol-event-label", domProps: { innerHTML: t._s(t.$getI18nWord({ key: "event_type_label", data: { name: t.$getI18nWord("idol_name_".concat(a.curReviewInfo.idolId)) } })) } }) : t._e(), t._v(" "), e("div", { staticClass: "event-info-overview" }, [e("img", { staticClass: "event-info-overview-title", attrs: { src: t.$getI18nWord("review_overview_title"), alt: "" } }), t._v(" "), e("div", { staticClass: "event-info-overview-content", domProps: { innerHTML: t._s(a.getOverview(a.curReviewId)) } })]), t._v(" "), e("div", { staticClass: "event-info-unlock" }, [e("img", { staticClass: "event-info-unlock-title", attrs: { src: t.$getI18nWord("review_unlock_title"), alt: "" } }), t._v(" "), e("div", { staticClass: "event-info-unlock-content" }, t._l(a.getUnlockRule(a.curReviewId), function (n, i) { return e("div", { key: "".concat(a.curReviewId, "_").concat(i), staticClass: "event-info-unlock-content-item" }, [e("i", { staticClass: "event-info-unlock-content-icon", class: n.isUnlock ? "unlock" : "locked" }), t._v(" "), e("p", { domProps: { innerHTML: t._s(n.msg) } })]) }), 0)])]), t._v(" "), e("div", { staticClass: "event-confirm-btn", class: "event-confirm-btn__".concat(a.curConfirmBtnState), on: { click: a.onConfirmBtnClick } }, [a.state.enableGamepad && 3 !== a.curConfirmBtnState ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.button3 } }) : t._e(), t._v(" "), e("span", { attrs: { "data-text": t.$getI18nWord("review_btn_".concat(a.curConfirmBtnState)) } }, [t._v(t._s(t.$getI18nWord("review_btn_".concat(a.curConfirmBtnState))))])])])]), t._v(" "), a.state.enableGamepad ? e("div", { staticClass: "gamepad-tip" }, [e("div", { staticClass: "gamepad-tip-item" }, [e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.cancel, alt: "" } }), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("gamepad_back_btn")))])])]) : t._e()]) }, [], !1, null, "63c46f0a", null).exports }, 29128: function (t, e, n) { n.d(e, { A: function () { return s } }); var a = n(20023), i = n(34329), r = n(74681), o = n(92225), c = n(97921), l = { name: "qrcode", components: { Ps: i.A, StrokeSVG: o.A }, data: function () { return { i18nEnv: a.WO } }, mounted: function () { document.title = this.$getI18nWord("title"), (0, (0, c.v)().trackEvent)("page", "loading", "qr_code", r.rG ? "Ps" : "XBox") }, computed: { scanTip: function () { return this.$getI18nWord("scan_tip") }, scanTipHtml: function () { return this.scanTip.replace("<br/>", "\n").replace("<br>", "\n") }, useStaticCode: function () { return !r.QS.authkey } } }, s = (0, n(14486).A)(l, function () { var t = this, e = t._self._c; return e("ps", { attrs: { "bg-img": { w: 2500, h: 1080, url: t.$getLocalImg("qrcode_bg.png") }, env: t.i18nEnv, "qr-bg": { url: t.$getLocalImg("qrcode_qrcode_bg.png"), w: 805, h: 805, x: 1404, y: 169 }, "qr-img": { w: 430, h: 430, x: 132, y: 114, url: n(55091) }, "qr-config": { color: { dark: "#292C4B", light: "#FAE1EC" } }, useStaticCode: t.useStaticCode } }, [e("strokeSVG", { attrs: { id: "stroke-text-svg-filter-bold", width: 3.5 } }), t._v(" "), e("div", { staticClass: "scan-tips title-font" }, [e("i", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("qrcode_icon_scan.png"), expression: "$getLocalImg('qrcode_icon_scan.png')", modifiers: { bg: !0 } }] }), t._v(" "), e("span", { staticClass: "scan-tips-text", attrs: { "data-text": t.scanTipHtml }, domProps: { innerHTML: t._s(t.$getI18nWord("scan_tip")) } })])], 1) }, [], !1, null, null, null).exports }, 37665: function (t, e, n) { n.d(e, { A: function () { return v } }); var a = n(74061), i = n(4115), r = n(74681), o = n(85880); function c() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var c = a && a.prototype instanceof s ? a : s, u = Object.create(c.prototype); return l(u, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), u } var o = {}; function s() { } function u() { } function d() { } e = Object.getPrototypeOf; var f = [][a] ? e(e([][a]())) : (l(e = {}, a, function () { return this }), e), v = d.prototype = s.prototype = Object.create(f); function m(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, d) : (t.__proto__ = d, l(t, i, "GeneratorFunction")), t.prototype = Object.create(v), t } return u.prototype = d, l(v, "constructor", d), l(d, "constructor", u), u.displayName = "GeneratorFunction", l(d, i, "GeneratorFunction"), l(v), l(v, i, "Generator"), l(v, a, function () { return this }), l(v, "toString", function () { return "[object Generator]" }), (c = function () { return { w: r, m: m } })() } function l(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } l = function (t, e, n, a) { function r(e, n) { l(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, l(t, e, n, a) } function s(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } function u(t) { return function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { s(r, a, i, o, c, "next", t) } function c(t) { s(r, a, i, o, c, "throw", t) } o(void 0) }) } } var d = { __name: "midTrans2", emits: ["complete"], setup: function (t, e) { var l = e.emit; (0, i.pT)(!0); var s = (0, a.ref)(null), d = (0, a.ref)(null), f = null, v = null, m = { star1: null, star2: null, star3: null }, p = function () { var t = u(c().m(function t() { var e, a; return c().w(function (t) { for (; ;)switch (t.p = t.n) { case 0: return t.p = 0, t.n = 1, (0, r.uc)([n(67570), n(58281), n(87104)]); case 1: e = t.v, m.star1 = e[0] || null, m.star2 = e[1] || null, m.star3 = e[2] || null, t.n = 3; break; case 2: t.p = 2, a = t.v, console.warn("图片加载失败，将跳过对应图片的绘制:", a); case 3: return t.a(2) } }, t, null, [[0, 2]]) })); return function () { return t.apply(this, arguments) } }(), g = function (t, e, n, a, i, r, o) { t.save(), t.fillStyle = o, t.beginPath(); var c = Number(i) * Math.tan(Number(r) * Math.PI / 180); t.moveTo(Number(e) + c, Number(n)), t.lineTo(Number(e) + Number(a) + c, Number(n)), t.lineTo(Number(e) + Number(a), Number(n) + Number(i)), t.lineTo(Number(e), Number(n) + Number(i)), t.closePath(), t.fill(), t.restore() }, _ = function (t, e, n) { t.clearRect(0, 0, e.width, e.height); var a = Math.min(n / 1.2, 1); g(t, -8500 * a + 4e3 - 300, 0, 3e3, 1080, -60, "#DBDBDB"); var i = Math.min(n / 2, 1); g(t, -12e3 * i + 5e3 - 300, 0, 5e3, 1080, -60, "#97D0CB"); var r = Math.min(n / 2, 1); g(t, -11e3 * r + 5e3 - 300, 0, 4e3, 1080, -60, "#FF78B0"); var o = function (e, a, i, r, o, c) { if (e) { var l = .5 + .1 * c; if (n >= l && n <= l + .7) { var s = (n - l) / .7, u = i, d = 0; s <= .286 ? (u = i - s / .286 * 50, d = s / .286) : s <= .714 ? (u = i - 50 - (s - .286) / .428 * 50, d = 1) : (u = i - 100, d = 1 - (s - .714) / .286), t.save(), t.globalAlpha = d, t.drawImage(e, a, u, r, o), t.restore() } } }; o(m.star1, 652, 208, 119, 118, 0), o(m.star2, 726, 376, 204, 204, 1), o(m.star3, 1728, 288, 119, 119, 2) }, b = null, h = function (t) { v || (v = t); var e = t - v, n = e / 1e3, a = s.value; a && (b || (b = a.getContext("2d")), _(b, a, n), e < 1600 ? f = requestAnimationFrame(h) : l("complete")) }, y = function () { var t = s.value; t && (t.width = 2500, t.height = 1080) }; return (0, a.onMounted)(u(c().m(function t() { return c().w(function (t) { for (; ;)switch (t.n) { case 0: y(), p(), f = requestAnimationFrame(h), (0, a.nextTick)(function () { d.value && o.default.fromTo(d.value, { opacity: 0, scale: .9 }, { keyframes: [{ opacity: 1, scale: 1, duration: .1 }, { opacity: 1, scale: 1.1, duration: .3 }, { opacity: 0, scale: .9, duration: .1 }], delay: .5, ease: "power0.inOut" }) }); case 1: return t.a(2) } }, t) }))), (0, a.onUnmounted)(function () { f && cancelAnimationFrame(f) }), { __sfc: !0, emits: l, canvasRef: s, logoRef: d, animationFrameId: f, startTime: v, ANIMATION_DURATION: 1600, images: m, loadImages: p, easeLinear: function (t) { return t }, drawSkewedRect: g, render: _, canvasCtx: b, animate: h, setupCanvas: y } } }, f = d, v = (0, n(14486).A)(f, function () { var t = this, e = t._self._c; return t._self._setupProxy, e("div", { staticClass: "mid-trans-2" }, [e("canvas", { ref: "canvasRef" }), t._v(" "), e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("midTrans_mid_trans_logo.png"), expression: "$getLocalImg('midTrans_mid_trans_logo.png')", modifiers: { bg: !0 } }], ref: "logoRef", staticClass: "mid-trans-2-logo" })]) }, [], !1, null, "fd58d67e", null).exports }, 45670: function (t, e, n) { n.d(e, { A: function () { return f } }); var a = n(74061), i = n(15908), r = n(6624), o = n(4115), c = n(97921); function l(t, e) { return function (t) { if (Array.isArray(t)) return t }(t) || function (t, e) { var n = null == t ? null : "undefined" != typeof Symbol && t[Symbol.iterator] || t["@@iterator"]; if (null != n) { var a, i, r, o, c = [], l = !0, s = !1; try { if (r = (n = n.call(t)).next, 0 === e) { if (Object(n) !== n) return; l = !1 } else for (; !(l = (a = r.call(n)).done) && (c.push(a.value), c.length !== e); l = !0); } catch (t) { s = !0, i = t } finally { try { if (!l && null != n.return && (o = n.return(), Object(o) !== o)) return } finally { if (s) throw i } } return c } }(t, e) || function (t, e) { if (t) { if ("string" == typeof t) return s(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? s(t, e) : void 0 } }(t, e) || function () { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }() } function s(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, a = Array(e); n < e; n++)a[n] = t[n]; return a } var u = (0, a.defineComponent)({ __name: "ruleModal", props: { defaultId: null }, emits: ["close"], setup: function (t, e) { var n = e.emit, s = t, u = (0, c.v)().trackEvent, d = (0, o.pT)(!0), f = d.onDirection, v = d.onBtnPress, m = d.onScrollHold, p = (0, a.getCurrentInstance)().proxy, g = (0, a.ref)(s.defaultId || "1_1"), _ = (0, a.ref)(!0), b = (0, a.ref)(null), h = (0, a.ref)(null), y = (0, a.ref)(!0), k = (0, a.ref)([{ id: 1, sub: 2 }, { id: 2, sub: 2 }, { id: 3, sub: 3 }]), w = function () { p.$playEffect(i.Ie.Common_Click), n("close") }, I = (0, a.computed)(function () { return y.value ? ["confirm", "back"] : ["back"] }), C = function (t) { g.value !== t && (u("popup", "click", "rule_detail", t), p.$playEffect(i.Ie.Common_Click), g.value = t, b.value.scrollTo({ y: 0 }, 0), b.value.refresh()) }; f(function (t) { var e = t.direction; if (["up", "down"].includes(e) && y.value) { var n, a = "up" === e ? -1 : 1, i = l(g.value.split("_").map(Number), 2), r = i[0], o = i[1], c = k.value.findIndex(function (t) { return t.id === r }), s = (null === (n = k.value[c]) || void 0 === n ? void 0 : n.sub) || 1, u = c, d = o + a; d < 1 ? 0 === c ? (u = 0, d = 1) : (u = c - 1, d = k.value[u].sub) : d > s && (c === k.value.length - 1 ? (u = c, d = s) : (u = c + 1, d = 1)); var f = k.value[u].id; C("".concat(f, "_").concat(d)) } }); var S = function () { for (var t = arguments.length > 0 && void 0 !== arguments[0] && arguments[0], e = l(g.value.split("_").map(Number), 2), n = e[0], a = e[1], i = k.value.findIndex(function (t) { return t.id === n }), r = 0, o = 0; o < i; o++)r += k.value[o].sub; var c = .52 * i + .93 * (r += a - 1); h.value.scrollTo({ y: c * p.$frame.rem }, t ? 0 : 100) }; return (0, a.watch)(g, function () { return S() }), v("confirm", function () { !0 === y.value && (y.value = !1) }), v("cancel", function () { !1 !== y.value ? w() : y.value = !0 }, "Escape"), m(function (t) { var e = .1 * ("up" === t ? 1 : -1) * p.$frame.rem; (y.value ? h : b).value.scrollBy({ dy: e }, 10) }), (0, a.onMounted)(function () { u("popup", "view", "howtoplay", ""), p.$playEffect(i.Ie.Popup), (0, a.nextTick)(function () { var t, e; null === (t = b.value) || void 0 === t || t.refresh(), null === (e = h.value) || void 0 === e || e.refresh(), setTimeout(function () { S(!0) }, 10) }) }), { __sfc: !0, trackEvent: u, props: s, onDirection: f, onBtnPress: v, onScrollHold: m, emits: n, vm: p, curActiveId: g, scrollTipShow: _, scrollRef: b, tabScrollRef: h, isTabFocus: y, ruleStruct: k, closeModal: w, gamepadBtnList: I, changeActiveId: C, handleScroll: function (t) { _.value = t.process <= .95 }, getRuleDesc: function (t) { var e = function (t) { for (var e = [], n = /\{([^}]+)\}/g, a = n.exec(t); null !== a; a = n.exec(t))e.push(a[1]); return e }(p.$getI18nWord("rule_desc_".concat(t))).reduce(function (t, e) { return t[e] = '<img src="'.concat(p.$getI18nWord(e), '" alt="" />'), t }, {}); return p.$getI18nWord({ key: "rule_desc_".concat(t), data: e }) }, getTabActive: function (t, e) { return g.value === "".concat(t, "_").concat(e) }, updateScrollerPos: S, ME_SCROLL_OPS: i.e7, RULE_SCROLL_OPS: i.MA, state: r.wk } } }), d = u, f = (0, n(14486).A)(d, function () { var t = this, e = t._self._c, a = t._self._setupProxy; return e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_common_modal_bg.png"), expression: "$getLocalImg('modal_common_modal_bg.png')", modifiers: { bg: !0 } }], staticClass: "rule-modal title-font" }, [e("div", { staticClass: "close-btn", on: { click: a.closeModal } }), t._v(" "), e("div", { staticClass: "modal-title" }, [e("i"), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("rule_title")))])]), t._v(" "), e("div", { staticClass: "modal-content" }, [e("div", { staticClass: "modal-tab-container", class: { "modal-tab-container__focused": a.isTabFocus } }, [e("me-scroll", { ref: "tabScrollRef", attrs: { ops: a.ME_SCROLL_OPS }, on: { "handle-scroll": a.handleScroll } }, [e("div", { staticClass: "modal-tab-wrapper" }, t._l(a.ruleStruct, function (i) { var r = i.id, o = i.sub; return e("div", { key: r, staticClass: "tab-group" }, [e("div", { staticClass: "tab-group-title" }, [t._v(t._s(t.$getI18nWord("rule_tab_".concat(r))))]), t._v(" "), e("div", { staticClass: "tab-group-list" }, t._l(o, function (i) { return e("hover-btn", { key: "rule-btn-".concat(r, "-").concat(i), staticClass: "tab-group-item", class: { "tab-group-item__focused": a.getTabActive(r, i) && a.state.enableGamepad }, attrs: { img: n(94468), "img-hover": n(26637), "img-active": n(26637), "need-active": !0, "is-active": a.getTabActive(r, i) }, on: { click: function (t) { return a.changeActiveId("".concat(r, "_").concat(i)) } } }, [e("span", { attrs: { "data-text": t.$getI18nWord("rule_name_".concat(r, "_").concat(i)) } }, [t._v(t._s(t.$getI18nWord("rule_name_".concat(r, "_").concat(i))))])]) }), 1)]) }), 0)]), t._v(" "), e("div", { directives: [{ name: "show", rawName: "v-show", value: a.scrollTipShow, expression: "scrollTipShow" }], staticClass: "scroll-tip" })], 1), t._v(" "), e("div", { staticClass: "modal-content-detail", class: { "modal-content-detail__focused": !a.isTabFocus } }, [e("me-scroll", { ref: "scrollRef", attrs: { ops: a.RULE_SCROLL_OPS } }, [e("div", { staticClass: "modal-content-detail-text", domProps: { innerHTML: t._s(a.getRuleDesc(a.curActiveId)) } })])], 1)]), t._v(" "), a.state.enableGamepad ? e("div", { staticClass: "gamepad-tip" }, t._l(a.gamepadBtnList, function (n, a) { return e("div", { key: "".concat(n, "_").concat(a), staticClass: "gamepad-tip-item" }, [e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap["back" === n ? "cancel" : n], alt: "" } }), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("gamepad_".concat(n, "_btn"))))])]) }), 0) : t._e()]) }, [], !1, null, null, null).exports }, 49282: function (t, e, n) { function a(t) { return a = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, a(t) } n.d(e, { A: function () { return v } }); var i = n(74061), r = n(85880), o = n(6624), c = n(15908), l = n(4115), s = n(97921); function u(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, a = Array(e); n < e; n++)a[n] = t[n]; return a } var d = (0, i.defineComponent)({ __name: "calendarModal", props: { week: null, date: null, isTransition: { type: Boolean } }, emits: ["close"], setup: function (t, e) { var n, a = e.emit, d = t, f = (0, l.pT)(!0).onBtnPress, v = (0, s.v)().trackEvent, m = (0, i.getCurrentInstance)().proxy, p = (0, i.computed)(function () { if (5 === d.week) return m.$getI18nWord("final_countdown"); var t = c.li[d.week]; return m.$getI18nWord({ key: "weekly_target", data: { week_target: "<span>".concat(t, "</span>") } }) }), g = (0, i.ref)((n = new Array(5 === d.week ? 1 : 5), function (t) { if (Array.isArray(t)) return u(t) }(n) || function (t) { if ("undefined" != typeof Symbol && null != t[Symbol.iterator] || null != t["@@iterator"]) return Array.from(t) }(n) || function (t, e) { if (t) { if ("string" == typeof t) return u(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? u(t, e) : void 0 } }(n) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }()).map(function (t, e) { return d.isTransition ? d.date - 1 >= e + 1 ? 0 : 2 : d.date > e + 1 ? 0 : d.date === e + 1 ? 1 : 2 })), _ = function () { var t = r.default.timeline(), e = d.date; t.fromTo(".calendar-modal-header", { opacity: 0, y: "0.1rem" }, { opacity: 1, y: 0, duration: .1, delay: .2, ease: "power0.inOut" }).fromTo(".weekly-target", { opacity: 0, y: "0.1rem" }, { opacity: 1, y: 0, duration: .1, ease: "power0.inOut" }).fromTo(".date-item", { opacity: 0, x: "-0.2rem" }, { opacity: 1, x: 0, duration: .3, delay: function (t) { return .1 * t }, ease: "back.out(1.7)" }), d.isTransition && t.fromTo(".date-item__".concat(e - 1, " .date-state"), { scale: 0 }, { scale: 1, delay: .1, ease: "back.out(2)" }).fromTo(".date-item__".concat(e), { scale: .9 }, { scale: 1, duration: .15, delay: .1, onStart: function () { g.value.splice(e - 1, 1, 1) }, ease: "back.out(3)" }) }, b = function () { arguments.length > 0 && void 0 !== arguments[0] && arguments[0] || v("button", "click", "return", ""), a("close") }; return (0, i.onMounted)(function () { d.isTransition && v("session", "visit", "dayby", d.date), (0, i.nextTick)(function () { _(), d.isTransition && setTimeout(function () { b(!0) }, 4e3) }) }), f("cancel", function () { d.isTransition || b() }, "Escape"), { __sfc: !0, onBtnPress: f, trackEvent: v, emits: a, props: d, vm: m, tipMsg: p, dateState: g, platEntranceAni: _, getDateBg: function (t) { var e = g.value[t - 1]; return 5 === d.week && 1 === e ? m.$getLocalImg("modal_calendar_day_border_final.png") : 5 === t ? m.$getLocalImg("modal_calendar_day_border_friday.png") : 0 === e ? m.$getLocalImg("modal_calendar_day_border_prev.png") : 2 === e ? m.$getLocalImg("modal_calendar_day_border_next.png") : 1 === e ? m.$getLocalImg("modal_calendar_day_border_cur.png") : "" }, closeModal: b, state: o.wk } } }), f = d, v = (0, n(14486).A)(f, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_calendar_bg.jpg"), expression: "$getLocalImg('modal_calendar_bg.jpg')", modifiers: { bg: !0 } }], staticClass: "calendar-modal title-font" }, [e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_calendar_calendar_title.png"), expression: "$getLocalImg('modal_calendar_calendar_title.png')", modifiers: { bg: !0 } }], staticClass: "calendar-modal-header" }, [e("div", { staticClass: "week-num", class: "week-num__".concat(n.props.week) }), t._v(" "), e("div", { staticClass: "deco deco-1" }), t._v(" "), e("div", { staticClass: "deco deco-2" })]), t._v(" "), e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_calendar_text_bg.png"), expression: "$getLocalImg('modal_calendar_text_bg.png')", modifiers: { bg: !0 } }], staticClass: "weekly-target" }, [e("p", { domProps: { innerHTML: t._s(n.tipMsg) } })]), t._v(" "), e("div", { staticClass: "date-list" }, [t._l(5 === n.props.week ? 1 : 5, function (i) { return e("div", { key: i, staticClass: "date-item", class: (r = { "date-item__prev": 0 === n.dateState[i - 1], "date-item__next": 2 === n.dateState[i - 1], "date-item__current": 1 === n.dateState[i - 1], "date-item__last": 5 === n.props.week, "date-item__final": 5 === n.props.week && 1 === n.dateState[i - 1] }, o = "date-item__".concat(i), c = !0, (o = function (t) { var e = function (t) { if ("object" != a(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var n = e.call(t, "string"); if ("object" != a(n)) return n; throw new TypeError("@@toPrimitive must return a primitive value.") } return String(t) }(t); return "symbol" == a(e) ? e : e + "" }(o)) in r ? Object.defineProperty(r, o, { value: c, enumerable: !0, configurable: !0, writable: !0 }) : r[o] = c, r), style: { backgroundImage: "url(".concat(n.getDateBg(i), ")") } }, [e("div", { staticClass: "date-title" }), t._v(" "), e("div", { staticClass: "date-content" }, [e("span", { staticClass: "date-content-num impact-font" }, [t._v(t._s(i))]), t._v(" "), 5 === n.props.week ? e("span", { staticClass: "date-content-text" }, [t._v(t._s(t.$getI18nWord("calendar_text_final")))]) : e("span", { staticClass: "date-content-text" }, 5 === i ? [t._v(t._s(t.$getI18nWord("guide_start_btn_other")))] : [t._v(t._s(t.$getI18nWord("calendar_text_default")))])]), t._v(" "), 2 !== n.dateState[i - 1] ? e("div", { staticClass: "date-state" }, [1 === n.dateState[i - 1] ? t._l(3, function (t) { return e("div", { key: t, staticClass: "cur-dot", class: "cur-dot__".concat(t) }) }) : t._e()], 2) : t._e()]); var r, o, c }), t._v(" "), e("div", { staticClass: "deco deco-3" })], 2), t._v(" "), t.isTransition ? t._e() : e("div", { staticClass: "back-btn", on: { click: function (t) { return n.closeModal() } } }, [n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.cancel, alt: "" } }) : t._e()])]) }, [], !1, null, null, null).exports }, 54817: function (t, e, n) { n.d(e, { A: function () { return o } }); var a = n(74061), i = n(4115), r = (0, a.defineComponent)({ __name: "midTrans4", props: { text: null }, emits: ["complete"], setup: function (t, e) { var n = e.emit, a = t; return (0, i.pT)(!0), setTimeout(function () { n("complete") }, " " === a.text ? 350 : 3e3), { __sfc: !0, emits: n, props: a } } }), o = (0, n(14486).A)(r, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { staticClass: "mid-trans-4 title-font" }, [e("p", { domProps: { innerHTML: t._s(n.props.text) } })]) }, [], !1, null, "1f10f813", null).exports }, 71916: function (t, e, n) { n.d(e, { A: function () { return h } }); var a = n(74061), i = n(15908), r = n(4115), o = n(10526), c = n(6624), l = n(88327), s = n(19087), u = n(97921); function d() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var l = a && a.prototype instanceof c ? a : c, s = Object.create(l.prototype); return f(s, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), s } var o = {}; function c() { } function l() { } function s() { } e = Object.getPrototypeOf; var u = [][a] ? e(e([][a]())) : (f(e = {}, a, function () { return this }), e), v = s.prototype = c.prototype = Object.create(u); function m(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, s) : (t.__proto__ = s, f(t, i, "GeneratorFunction")), t.prototype = Object.create(v), t } return l.prototype = s, f(v, "constructor", s), f(s, "constructor", l), l.displayName = "GeneratorFunction", f(s, i, "GeneratorFunction"), f(v), f(v, i, "Generator"), f(v, a, function () { return this }), f(v, "toString", function () { return "[object Generator]" }), (d = function () { return { w: r, m: m } })() } function f(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } f = function (t, e, n, a) { function r(e, n) { f(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, f(t, e, n, a) } function v(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } function m(t) { return function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { v(r, a, i, o, c, "next", t) } function c(t) { v(r, a, i, o, c, "throw", t) } o(void 0) }) } } var p = function (t) { return t[t.NOT_TRIGGERED = 0] = "NOT_TRIGGERED", t[t.TRIGGERED = 1] = "TRIGGERED", t[t.COMPLETED = 2] = "COMPLETED", t }(p || {}), g = (0, a.defineComponent)({ __name: "dialogModal", props: { scriptId: null, sceneId: null, gal: null }, emits: ["script", "end", "qteTriggered", "confirm"], setup: function (t, e) { var n = e.expose, f = e.emit, v = t, g = (0, a.ref)(!1), _ = (0, a.getCurrentInstance)().proxy, b = (0, u.v)().trackEvent, h = (0, s.$e)({ delay: ["zh-cn", "zh-tw"].includes(_.$getLang()) ? 25 : 10 }), y = h.start, k = h.skip, w = h.text, I = (0, a.ref)({ qte1: p.NOT_TRIGGERED, qte2: p.NOT_TRIGGERED }), C = (0, a.ref)(null), S = (0, a.ref)(""), T = (0, r.pT)(!0).onBtnPress, $ = (0, l.m)().showMidTrans, x = (0, o.k)().showPromptModal, E = (0, a.ref)(0), O = (0, a.ref)([]), P = (0, a.ref)(!1), G = (0, a.computed)(function () { var t = v.scriptId, e = v.sceneId; return "main_day_5" === t && 2 === e && E.value <= 46 }), M = (0, a.computed)(function () { var t = v.scriptId, e = v.sceneId; return "role_2_train" === t && 3 === e }), A = (0, a.computed)(function () { var t = v.scriptId, e = v.sceneId; return "main_day_5" === t && 2 === e && E.value <= 46 && E.value > 8 }), B = (0, a.ref)({ left: "", right: "" }), L = { ng: "nangong", qx: "qianxia", ar: "airui" }, j = { alice: "ailisi", anby: "anbi", billy: "bili", burnice: "bonisi", jff: "jufufu", ling: "ling", pp: "paipai", sxly: "saixiliya", astra: "yaojiayin", zhe: "zhe", fairy: "fairy" }, W = function (t, e, n) { var a = L[t] || "game_npc", i = j[t], r = (arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : "").split("_").pop(); _.$gemit("setTalkIdol", { idolName: a, pos: e, visible: n, npcName: i, faceId: r }) }, N = function (t, e, n) { var a = L[t] || "game_npc"; _.$gemit("setTalkIdolBlend", { idolName: a, pos: e, value: n }) }, R = (0, a.ref)("chat_gal_".concat((new Date).getTime())), F = (0, a.ref)(""), D = function () { var t = v.gal.inst.data.scenes[v.sceneId].scripts, e = v.gal.inst.data.charactersMap, n = t.map(function (t, n) { var a, i, r = t.chara, o = t.key, c = t.img, l = t.pos, s = t.type, u = null === (a = e[r]) || void 0 === a ? void 0 : a.key; return "bg" === s ? { type: "bg", img: c, pos: l, index: n } : { chara: r, name: u ? _.$getI18nWord(u) : "", text: _.$getI18nWord(o) || (null === (i = t.paragraphs) || void 0 === i || null === (i = i[0]) || void 0 === i ? void 0 : i.text), img: c, pos: l, index: n } }); O.value = n, V() }, H = function (t) { if (M.value) { var e = { 13: i.aK.QianXia_14, 16: i.aK.QianXia_17, 18: i.aK.JiaYin_19, 20: i.aK.QianXia_21, 21: i.aK.JiaYin_22, 22: i.aK.QianXia_23, 23: i.aK.JiaYin_24, 24: i.aK.Ling_25, 32: i.aK.QianXia_33 }; void 0 !== e[t] && _.$gemit("playGalEffect", e[t]) } }, V = function () { var t = m(d().m(function t() { var e, n, r, o, c, l, s, u, v, m, b, h, T, x, M, L, j = arguments; return d().w(function (t) { for (; ;)switch (t.n) { case 0: if (e = j.length > 0 && void 0 !== j[0] && j[0], A.value || _.$playEffect(i.Ie.Common_Click), 0 !== O.value.length) { t.n = 1; break } return t.a(2); case 1: if (w.value === S.value) { t.n = 2; break } if (k(), e) { t.n = 2; break } return t.a(2); case 2: if (n = E.value + 1, G.value && 3 === n && I.value.qte1 === p.NOT_TRIGGERED && (I.value.qte1 = p.TRIGGERED, f("qteTriggered", "qte1")), !G.value || 3 !== n || I.value.qte1 !== p.TRIGGERED) { t.n = 3; break } return t.a(2); case 3: if (!G.value || 46 !== n || I.value.qte2 !== p.TRIGGERED) { t.n = 4; break } return t.a(2); case 4: if (!(n > O.value.length)) { t.n = 5; break } return f("end"), t.a(2); case 5: if (r = O.value[E.value], E.value = n, o = r.text, c = r.img, l = void 0 === c ? "" : c, s = r.chara, u = void 0 === s ? "" : s, v = r.pos, m = r.name, "bg" !== r.type) { t.n = 6; break } return g.value = !0, V(), t.a(2); case 6: if (H(r.index), f("script", r), u && "-2" !== u) { t.n = 8; break } if (b = B.value, h = b.left, T = b.right, h && W(h, "left", !1), T && W(T, "right", !1), !o) { t.n = 7; break } return x = "[em bold] [/em]" === o ? " " : o, t.n = 7, $(4, function () { }, { text: x }); case 7: return V(), t.a(2); case 8: if (M = "right" === v ? "right" : "left", B.value[M] && B.value[M] !== u && W(B.value[M], M, !1), B.value[M] = u, L = "right" === M ? "left" : "right", B.value[L] && N(B.value[L], L, .5), "" !== u && "" !== l && W(u, M, !0, l), P.value = !0, F.value = m, S.value = o, !e) { t.n = 9; break } return t.n = 9, (0, a.nextTick)(); case 9: y(S.value), C.value && (C.value.style.transform = "translateZ(1px)", setTimeout(function () { C.value.style.transform = "none" }, 100)), G.value && 46 === n && I.value.qte2 === p.NOT_TRIGGERED && (I.value.qte2 = p.TRIGGERED, f("qteTriggered", "qte2")); case 10: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), U = function () { var t = m(d().m(function t() { var e, n, a, r; return d().w(function (t) { for (; ;)switch (t.n) { case 0: if (!G.value) { t.n = 1; break } return t.a(2); case 1: return v.scriptId.startsWith("role") ? (e = v.scriptId.match(/\d+/), n = e ? e[0] : "", b("button", "click", "skip_favorby", n)) : b("button", "click", "skip", ""), _.$playEffect(i.Ie.Common_Click), a = "main_day_1" === v.scriptId && [4, 5].includes(v.sceneId), r = a ? "skip_prompt_guide_desc" : "skip_prompt_desc", t.n = 2, x(_.$getI18nWord("skip_prompt_title"), _.$getI18nWord(r)); case 2: f("end"); case 3: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), K = (0, a.ref)(!1), q = function () { K.value = !0, setTimeout(function () { K.value = !1 }, 200) }, X = function () { var t = v.scriptId, e = v.sceneId, n = "main_day_5" === t && 2 === e && !c.wk.finalModalVisible; K.value || (f("confirm"), A.value || n || (q(), V())) }, z = function (t) { "qte1" === t && (I.value.qte1 = p.COMPLETED, V()), "qte2" === t && (I.value.qte2 = p.COMPLETED) }; return (0, a.watch)(A, function (t) { t && _.$gemit("blockClick") }), T("confirm", X, "Space"), T("start", U), (0, a.onMounted)(function () { M.value && _.$gemit("initGalEffect"), _.$gon("onQteClick", z), (0, a.nextTick)(function () { D() }), b("session", "visit", "conversation", "") }), (0, a.onBeforeUnmount)(function () { _.$goff("onQteClick", z), M.value && _.$gemit("destroyGalEffect") }), n({ handleGalNext: V }), { __sfc: !0, signPicVisible: g, vm: _, trackEvent: b, start: y, skip: k, renderText: w, QTE_STATE: p, qteTriggerState: I, textContainer: C, targetText: S, onBtnPress: T, showMidTrans: $, showPromptModal: x, startIdx: E, galScript: O, emits: f, props: v, dialogVisible: P, isFinal: G, hasGalEffect: M, blockClick: A, dialogPos: B, idolNameMap: L, npcNameMap: j, updateIdol: W, updateIdolBlend: N, GalId: R, curChaName: F, initGal: D, triggerScriptAudio: H, handleGalNext: V, handleSkipBtnClick: U, isTimeLimited: K, skipBlockTimer: q, handleClickGalNext: X, onQteClick: z, state: c.wk } } }), _ = g, b = (0, n(14486).A)(_, function () { var t = this, e = t._self._c, a = t._self._setupProxy; return e("div", { staticClass: "dialog-modal title-font", class: { "can-click": !a.blockClick, "dialog-modal__final": a.isFinal, "dialog-modal__narration": !a.curChaName, "dialog-modal__visible": a.dialogVisible }, on: { click: a.handleClickGalNext } }, ["main_day_1" === t.scriptId && 5 === t.sceneId ? e("img", { directives: [{ name: "show", rawName: "v-show", value: a.signPicVisible, expression: "signPicVisible" }], staticClass: "dialog-modal-bg", attrs: { src: n(94023) } }) : t._e(), t._v(" "), e("div", { staticClass: "shadow-gal", attrs: { id: a.GalId } }), t._v(" "), e("div", { ref: "textContainer", staticClass: "gal-talk-container", domProps: { innerHTML: t._s(a.renderText) } }), t._v(" "), a.curChaName ? e("div", { staticClass: "cur-chara-name", attrs: { "data-text": a.curChaName } }, [t._v(t._s(a.curChaName))]) : t._e(), t._v(" "), a.state.enableGamepad ? e("img", { directives: [{ name: "show", rawName: "v-show", value: !a.blockClick, expression: "!blockClick" }], staticClass: "gamepad-icon__next gamepad-icon", attrs: { src: a.vm.$meGamepad.btnIconMap.confirm, alt: "" } }) : e("div", { staticClass: "next-icon" }, [e("div", { staticClass: "next-icon-1" }), t._v(" "), e("div", { staticClass: "next-icon-2" })]), t._v(" "), e("div", { staticClass: "skip-btn", on: { click: function (t) { return t.stopPropagation(), a.handleSkipBtnClick.apply(null, arguments) } } }, [e("span", { attrs: { "data-text": t.$getI18nWord("skip_btn") } }, [t._v(t._s(t.$getI18nWord("skip_btn")))]), t._v(" "), a.state.enableGamepad ? e("img", { staticClass: "gamepad-icon__skip gamepad-icon", attrs: { src: a.vm.$meGamepad.btnIconMap.start, alt: "" } }) : t._e()])]) }, [], !1, null, null, null), h = b.exports }, 72517: function (t, e, n) { n.d(e, { A: function () { return xe } }); var a = n(74061), i = n.n(a), r = n(15908), o = n(20236), c = n(72444), l = n(93823), s = n(23402), u = n(6624), d = n(15367), f = n.n(d), v = n(85880), m = n(50440), p = n(20444), g = n(19034), _ = n(1924), b = n(61057), h = n(70344), y = n(91441), k = n(49126), w = n(41832), I = n(61193), C = n(99113), S = n(49507), T = n(88705), $ = n(58079), x = n(74681); function E() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var l = a && a.prototype instanceof c ? a : c, s = Object.create(l.prototype); return O(s, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), s } var o = {}; function c() { } function l() { } function s() { } e = Object.getPrototypeOf; var u = [][a] ? e(e([][a]())) : (O(e = {}, a, function () { return this }), e), d = s.prototype = c.prototype = Object.create(u); function f(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, s) : (t.__proto__ = s, O(t, i, "GeneratorFunction")), t.prototype = Object.create(d), t } return l.prototype = s, O(d, "constructor", s), O(s, "constructor", l), l.displayName = "GeneratorFunction", O(s, i, "GeneratorFunction"), O(d), O(d, i, "Generator"), O(d, a, function () { return this }), O(d, "toString", function () { return "[object Generator]" }), (E = function () { return { w: r, m: f } })() } function O(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } O = function (t, e, n, a) { function r(e, n) { O(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, O(t, e, n, a) } function P(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } function G(t) { return function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { P(r, a, i, o, c, "next", t) } function c(t) { P(r, a, i, o, c, "throw", t) } o(void 0) }) } } function M(t) { return function (t) { if (Array.isArray(t)) return A(t) }(t) || function (t) { if ("undefined" != typeof Symbol && null != t[Symbol.iterator] || null != t["@@iterator"]) return Array.from(t) }(t) || function (t, e) { if (t) { if ("string" == typeof t) return A(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? A(t, e) : void 0 } }(t) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }() } function A(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, a = Array(e); n < e; n++)a[n] = t[n]; return a } var B = { width: 2500, height: 1080, type: "height", scale: f().desktop() ? 1.3 : .8, isFixedSize: f().mobile(), isFixedAspect: !1 };[].concat(M(p.eC), M(p.to)).forEach(function (t) { var e, n, a, i; t.src = t.src.startsWith("data:") ? t.src : (e = t.src, n = function (t) { var e = document.createElement("a"); return e.href = t, e }(e), a = n.pathname, i = function (t) { var e = t.origin; return e || (e = t.protocol + "//" + t.hostname + (t.port ? ":" + t.port : "") + "/"), e }(n), "".concat(i).concat(a)), t.src = (0, x.XB)(t.src, { format: "webp", quality: 90 }) }); var L = l.THREEPlayer.getSourceLoader(), j = (0, T.A)(L), W = !1, N = !0, R = { props: { width: { type: Number, default: 100 }, height: { type: Number, default: 100 }, rotate: { type: Boolean, default: !1 }, disable: { type: Boolean, default: !1 }, activeIdolId: { type: Number, default: -1 } }, mixins: [$.E], data: function () { return { loadingProgress: 0, showGmPanel: !1, curFocusId: -1, aniIdx: 1, lightEffectTimer: null, clearFaceTimer: {} } }, computed: { sceneGame: function () { return this.player && this.player.getScene("scene_game") }, sceneHome: function () { return this.player && this.player.getScene("scene_home") }, sceneLoading: function () { return this.player && this.player.getScene("scene_loading") }, sceneStart: function () { return this.player && this.player.getScene("scene_start") }, sceneKv: function () { return this.player && this.player.getScene("scene_kv") }, sceneSelect: function () { return this.player && this.player.getScene("scene_select") }, sceneGameMix: function () { return this.player && this.player.getScene("scene_game_mix") }, currentPage: function () { return u.wk.currentPage }, idolEventList: function () { return u.rS.idolEventList } }, watch: { width: function () { N = !0 }, height: function () { N = !0 }, rotate: { immediate: !0, handler: function () { g.A.rotate = this.rotate } }, activeIdolId: { handler: function (t) { this.updateIdolSelect(t) } }, currentPage: function (t) { this.$frame["growth" === t ? "$addHook" : "$removeHook"]("beforeUpdate", this.updateSelectScale), this.setLightEffect() } }, created: function () { this.player = null, this.renderer = null }, mounted: function () { this.replaceMi18n([].concat(M(p.to), M(p.eC)), C), this.init3D(), this.$gon("startGame", this.startGame), this.$gon("pauseGame", this.pauseGame), this.$gon("resumeGame", this.resumeGame), this.$gon("useSkill", this.useSkill), this.$gon("rotateBlock", this.rotateBlock), this.$gon("holdBlock", this.holdBlock), this.$gon("hardDrop", this.hardDrop), this.$gon("onTouchStart", this.onDirectionDown), this.$gon("onTouchEnd", this.removeKeyboardListener), this.$gon("idolPos", this.changeFace), this.$gon("idolMove", this.moveIdol), this.$gon("setTalkIdol", this.setTalkIdol), this.$gon("setTalkIdolBlend", this.setTalkIdolBlend) }, methods: { replaceMi18n: function (t, e) { var n = this; t.forEach(function (t) { e[t.id] && (t.src = n.$getI18nWord(e[t.id])) }) }, init3D: function () { var t = this; return G(E().m(function e() { return E().w(function (e) { for (; ;)switch (e.n) { case 0: try { t.renderer = new s.WebGL1Renderer({ canvas: t.$refs.webglCanvas, alpha: !1, premultipliedAlpha: !1 }), t.renderer.setClearColor(4935539), t.renderer.clear(), t.prepareLoadingManifest() } catch (e) { t.$emit("webglError", e) } case 1: return e.a(2) } }, e) }))() }, prepareLoadingManifest: function () { var t = this; return G(E().m(function e() { var n; return E().w(function (e) { for (; ;)switch (e.n) { case 0: return e.n = 1, j.catch(function (e) { return t.$emit("loadError", e), Promise.reject(e) }); case 1: L.clearAllListener(), n = p.to.filter(function (t) { return !!C[t.id] }), L.load(n), L.setEventListener("error", function () { t.$emit("loadError") }), L.setEventListener("complete", function () { L.removeEventListener("complete"), t.initPlayer(), t.player.playTimeline(t.sceneLoading, "loading", { start: 0, end: 40, onComplete: function () { t.prepareAssetsManifest(), t.$emit("buildLoadingComplete") } }) }); case 2: return e.a(2) } }, e) }))() }, prepareAssetsManifest: function () { var t = this; return new Promise(function (e, n) { L.clearAllListener(), L.load(p.eC), L.setEventListener("error", function (e) { t.$emit("loadError", e), n() }); var a = 0; r.$C.forEach(function (t) { var e = new Image; e.src = t, e.onload = function () { a++ }, e.onerror = function () { a++ } }); var i = (new Date).getTime(); L.setEventListener("progress", function () { var n = G(E().m(function n(o) { var c; return E().w(function (n) { for (; ;)switch (n.n) { case 0: return n.n = 1, l.utils.tweenTo(t, 1, { loadingProgress: 90 * o + a / r.$C.length * 10, overwrite: !0, onUpdate: function () { t.$emit("loading", t.loadingProgress), t.player.getTimeline(t.sceneLoading, "loading_0-100").seek(t.loadingProgress / 2) } }); case 1: 1 === o && (c = (new Date).getTime() - i, t.$mia.trackEvent("page", "loading", "loading", "".concat(c / 1e3)), t.$emit("loadComplete"), t.setIdolSpineMix(), W = !0, e()); case 2: return n.a(2) } }, n) })); return function (t) { return n.apply(this, arguments) } }()) }) }, loadingToNextScene: function (t) { var e = this; return G(E().m(function n() { return E().w(function (n) { for (; ;)if (0 === n.n) return n.a(2, new Promise(function (n) { e.sceneUI.getObjectByName("scene_".concat(t)).visible = !0, "landing" === t && e.player.getTimeline(e.sceneKv, "kv").seek(150), "home" === t && (e.$playEffect(r.Ie.Whoosh_1), e.setHomeState()), e.player.playTimeline(e.sceneLoading, "loading", { start: 40, end: 70, onComplete: function () { e.sceneUI.getObjectByName("scene_loading").visible = !1, n() } }) })) }, n) }))() }, setHomeGlitch: function (t) { var e = this.sceneHome.getObjectByName("cut_eff"); t ? e.material.uniforms.glitch.value.set(1, 1, 3, 1) : e.material.uniforms.glitch.value.set(0, 0, 0, 0) }, setHomeState: function () { this.player.getTimeline(this.sceneHome, "room2boss").seek(u.rS.isBossLayout ? 61 : 0) }, toNormalHome: function () { this.player.getTimeline(this.sceneHome, "room2boss").seek(0), this.updateHomeBtnVisible(!0) }, landingToHome: function () { var t = this; return G(E().m(function e() { return E().w(function (e) { for (; ;)switch (e.n) { case 0: t.setHomeState(), t.sceneUI.getObjectByName("scene_landing").visible = !1, t.sceneUI.getObjectByName("scene_home").visible = !0; case 1: return e.a(2) } }, e) }))() }, initPlayer: function () { this.player = new l.THREEPlayer({ devSpeed: 1, animationSetting: (0, S.A)(this), spineSetting: p.WC, layoutData: m, renderer: this.renderer, uniformSetting: g.A, pluginSetting: b.A, imageSetting: h.A, shaderSetting: _.A, modifierSetting: y.A, timelineSetting: k.A, machineSetting: w.A, classSetting: I.A }), this.sceneUI = this.player.getScene("scene_ui"), this.player.checkGPUAcceleratorEnabled() || this.$emit("gpuAccDisable"); try { this.update() } catch (t) { this.$emit("webglError", t), console.error(t) } }, onResize: function () { if (this.renderer) { var t = this.width * window.devicePixelRatio, e = this.height * window.devicePixelRatio; this.player.resizeUI(t, e, B) } }, render: function () { var t = this; W && this.player.reportRenderInfo(15, function (e) { t.$emit("reportRenderInfo", e) }), this.player.renderScene("scene_ui") }, update: function () { N && (this.onResize(), N = !1), !this.disable && this.player.tick() && this.render(), window.requestAnimationFrame(this.update) }, resetHomeIdolPos: function () { var t = this;[1, 2, 3].forEach(function (e) { var n = t.sceneHome.getObjectByName("er_".concat(o.aJ[e])), a = o.Bh[o.aJ[e]][0], i = a.x, r = a.y; n && n.position.set(i, r, 0), u.wk.idolState[o.aJ[e]].pos = 0 }) }, setHomeIdolPos: function () { var t = this, e = arguments.length > 0 && void 0 !== arguments[0] && arguments[0], n = Object.keys(u.rS.idolEventList).find(function (t) { return 0 !== u.rS.idolEventList[t] }); if (n || !e) { var a = 0;[1, 2, 3].forEach(function (i) { var r = t.sceneHome.getObjectByName("er_".concat(o.aJ[i])); if (e) { var c = i === +n, l = 0 === a ? "left" : "right", s = o.Mt[c ? "center" : l], d = s.x, f = s.y; r.position.set(d, f, 0), a += c ? 0 : 1 } else { var v = o.Bh[o.aJ[i]][0], m = v.x, p = v.y; r.position.set(m, p, 0) } u.wk.idolState[o.aJ[i]].pos = 0 }) } }, updateIdolSelect: function (t) { var e = this.curFocusId; this.curFocusId = t === e ? -1 : t; var n = { 1: { sceneHome: "airui_hover", sceneSelect: "select_b_hover" }, 2: { sceneHome: "qianxia_hover", sceneSelect: "select_a_hover" }, 3: { sceneHome: "nangong_hover", sceneSelect: "select_c_hover" } }, a = "home" === u.wk.currentPage ? 5 : 10, i = "home" === u.wk.currentPage ? "sceneHome" : "sceneSelect", r = []; if (-1 !== e && r.push({ tl: this.player.getTimeline(this[i], n[e][i]), payload: { start: a, end: 0, speed: "home" === u.wk.currentPage ? 2 : 4 } }), -1 !== this.curFocusId) { var c = o.aJ[this.curFocusId]; u.wk.idolState[c].walkInterval ? (u.wk.idolState[c].walkInterval.kill(), this.resetWalkIdol(c)) : 0 !== u.wk.idolState[c].poseId && this.clearIdolFace(c), r.push({ tl: this.player.getTimeline(this[i], n[this.curFocusId][i]), payload: { start: 0, end: a, speed: 2 } }) } r.forEach(function (t) { var e = t.tl, n = t.payload; e.play(n) }) }, homeToGame: function () { var t = this, e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : ""; u.rS.isBossGame && setTimeout(function () { t.toFinal() }, 1e3), this.sceneGameMix.getObjectByName("scene_kv").visible = !1, ["d_pad", "hold", "drop"].forEach(function (e) { t.sceneGame.getObjectByName(e).visible = !u.rS.keyboardLayout }), this.finalAudioState = 0, (0, u.$j)({ finalBgmState: 1 }), this.player.getTimeline(this.sceneGame, "boss").seek(0), this.sceneUI.getObjectByName("scene_home").visible = !1, this.sceneUI.getObjectByName("scene_game").visible = !0, this.setGameLeftRole(), this.setRandomIdolVisible(); var n = this.sceneGame.getObjectByName("scene_pink"); this.sceneGame.getObjectByName("game_eff").visible = !0, n.visible = !1, e && this.prepareChessboard(e) }, gameToHome: function () { this.setHomeState(), this.resetHomeIdolPos(), this.sceneUI.getObjectByName("scene_game").visible = !1, this.sceneUI.getObjectByName("scene_home").visible = !0 }, homeToTraining: function () { this.sceneUI.getObjectByName("scene_home").visible = !1, this.sceneUI.getObjectByName("scene_start").visible = !0, this.player.getTimeline(this.sceneStart, "start").seek(0), this.selectToTraining() }, trainingToSelect: function () { this.updateSelectScale(), this.player.getTimeline(this.sceneSelect, "select").seek(0); var t = this.sceneStart.getObjectByName("sceneSelect"); t.visible = !0, v.default.fromTo(t.material.uniforms.opacity, { value: 0 }, { value: 1, duration: .5 }) }, selectToTraining: function () { this.sceneStart.getObjectByName("sceneSelect").visible = !1 }, selectToRes: function () { var t = this; return new Promise(function (e) { var n = t.sceneStart.getObjectByName("sceneSelect"); t.sceneStart.getObjectByName("start_er").visible = !1, v.default.fromTo(n.material.uniforms.opacity, { value: 1 }, { value: 0, duration: .3, onComplete: function () { n.visible = !1, e() } }) }) }, trainingToHome: function () { this.setHomeState(), this.resetHomeIdolPos(), this.sceneUI.getObjectByName("scene_home").visible = !0, this.sceneUI.getObjectByName("scene_start").visible = !1; var t = this.sceneStart.getObjectByName("sceneSelect"), e = this.sceneStart.getObjectByName("start_er"); t.visible = !1, e.visible = !0 }, moveIdol: function () { var t = this, e = Object.keys(u.wk.idolState).filter(function (t) { var e = u.wk.idolState[t]; return !e.walkInterval && !e.selected && 0 === e.poseId }); if (0 !== e.length) { var n = e[Math.floor(Math.random() * e.length)], a = this.sceneHome.getObjectByName("er_".concat(n)), i = a.getObjectByName(n), r = 0 === u.wk.idolState[n].pos ? 1 : 0; u.wk.idolState[n].pos = r; var c = o.Bh[n][r], l = c.x, s = c.y, d = c.dir; u.wk.idolState[n].walkInterval = v.default.to(a.position, { x: l, y: s, duration: 1, onStart: function () { i.scale.set(d, 1, 1), i.skeleton.setSkinByName(1 === d ? "朝右" : "朝左"), i.skeleton.setSlotsToSetupPose(), i.state.setAnimation(0, "动作_走路", !0), i.state.setAnimation(1, "表情_常态", !0) }, onComplete: function () { u.wk.idolState[n].walkInterval && t.resetWalkIdol(n) }, ease: "linear" }) } }, resetWalkIdol: function (t) { this.clearIdolFace(t), u.wk.idolState[t].walkInterval = null }, setIdolSpineMix: function () { var t = this;[{ key: o.aJ[1], value: ["兴奋", "害羞", "无奈", "生气", "自信"] }, { key: o.aJ[2], value: ["哈气", "害羞", "心累", "思考", "生气", "自信"] }, { key: o.aJ[3], value: ["哭", "害羞", "思考", "生气", "自信", "认真"] }].forEach(function (e) { var n = e.key, a = e.value, i = t.sceneHome.getObjectByName("er_".concat(n)).getObjectByName(n); a.forEach(function (t) { i.state.data.setMix("动作_待机", "动作_".concat(t), .3), i.state.data.setMix("动作_".concat(t), "动作_待机", .3) }) }) }, changeFace: function (t, e) { var n = this; return G(E().m(function a() { var i, r, c, l, s, d; return E().w(function (a) { for (; ;)switch (a.n) { case 0: if (i = o.aJ[t]) { a.n = 1; break } return a.a(2); case 1: if (n.sceneHome) { a.n = 2; break } return a.a(2); case 2: if (r = n.sceneHome.getObjectByName("er_".concat(i))) { a.n = 3; break } return a.a(2); case 3: if (c = r.getObjectByName(i)) { a.n = 4; break } return a.a(2); case 4: if ((l = o.Io[i]) && l.animation) { a.n = 5; break } return a.a(2, !1); case 5: if (s = l.animation[e]) { a.n = 6; break } return a.a(2, !1); case 6: if (0 === u.wk.idolState[i].poseId) { a.n = 7; break } return a.a(2, !1); case 7: return d = s.face || s.name, c.state.setAnimation(0, "动作_".concat(s.name), !0), c.state.setAnimation(1, "表情_".concat(d), !0), u.wk.idolState[i].poseId = e, n.clearFaceTimer[i] && clearTimeout(n.clearFaceTimer[i]), n.clearFaceTimer[i] = setTimeout(function () { n.clearIdolFace(i) }, 3e3), a.a(2, !0) } }, a) }))() }, clearIdolFace: function (t) { var e = this.sceneHome.getObjectByName("er_".concat(t)); if (e) { var n = e.getObjectByName(t); n && (this.clearFaceTimer[t] && (clearTimeout(this.clearFaceTimer[t]), delete this.clearFaceTimer[t]), n.state.setAnimation(0, "动作_待机", !0), n.state.setAnimation(1, "表情_常态", !0), u.wk.idolState[t].poseId = 0) } }, updateSelectScale: function () { var t = this.sceneSelect.getObjectByName("scene_resize"), e = this.$frame.clipStateRem.left, n = Math.max(1 - e / 12.5, .8); t.scale.set(n, n, 1) }, setHomeIdolVisible: function (t) { if (!u.rS.isFinalDate || !t) { if (t) { var e = 4 === this.curGuideStep; this.setHomeIdolPos(e) } var n = this.sceneHome.getObjectByName("er"), a = !(this.curGuideStep < 4) && t; n.visible = a, (0, u.$j)({ homeCharacterVisible: a }) } }, setTalkVisible: function (t) { var e = this; this.sceneHome.getObjectByName("model_talk").visible = t, this.sceneHome.getObjectByName("btn_eff").visible = !t, this.setHomeIdolVisible(!t), t || ["airui", "qianxia", "nangong", "game_npc"].forEach(function (t) { var n = e.sceneHome.getObjectByName("".concat(t, "_r")), a = e.sceneHome.getObjectByName("".concat(t, "_l")); n.visible = !1, a.visible = !1 }) }, toBossScene: function () { var t = this; return new Promise(function (e) { t.player.getTimeline(t.sceneHome, "room2boss").play({ start: 0, end: 60, onComplete: function () { e() } }) }) }, setTalkIdol: function (t) { var e = t.idolName, n = t.pos, a = t.visible, i = t.npcName, r = t.faceId, c = "left" === n ? "l" : "r", l = this.sceneHome.getObjectByName("".concat(e, "_").concat(c)); if (l) { if (a && this.setTalkIdolBlend({ idolName: e, pos: n, value: 0 }), a && "game_npc" === e && i && (l.skeleton.setSkinByName(i), l.skeleton.setSlotsToSetupPose()), "game_npc" !== e && r && a) { var s = this.player.getTimeline(this.sceneHome, "".concat(c, "_").concat(e, "_pos")), u = o.bY[e][r], d = u.start, f = u.end; s.play({ start: d, end: f }) } l.visible = a } }, setTalkIdolBlend: function (t) { var e = t.idolName, n = t.pos, a = t.value, i = "left" === n ? "l" : "r", r = this.sceneHome.getObjectByName("".concat(e, "_").concat(i)); r && r.material && r.material.uniforms && r.material.uniforms.blendIntensity && (r.material.uniforms.blendIntensity.value = a) }, setLightEffect: function () { if (clearInterval(this.lightEffectTimer), "home" === this.currentPage) { var t = this.sceneHome.getObjectByName(u.rS.isFinalDate ? "room_btn_boss" : "room_btn_training"); this.lightEffectTimer = setInterval(function () { "hidden" !== document.visibilityState && t.state.setAnimation(0, "animation", !1) }, 5e3) } }, setTrainBtnState: function (t) { this.sceneHome.getObjectByName(u.rS.isFinalDate ? "room_btn_boss" : "room_btn_training").state.setAnimation(1, t, !1) }, updateHomeBtnVisible: function (t) { var e = this.sceneHome.getObjectByName(u.rS.isBossLayout ? "btn_boss" : "room_btn_training"); t && (e.visible = !0); var n = u.rS.isFinalDate ? [this.sceneHome.getObjectByName("btn_boss_eff").material.uniforms.opacity, this.sceneHome.getObjectByName("room_btn_boss").material.uniforms.opacity] : [e.material.uniforms.opacity]; v.default.to(n, .1, { value: t ? 1 : 0, onComplete: function () { t || (e.visible = !1) } }) } } }, F = R, D = n(14486), H = (0, D.A)(F, function () { var t = this, e = t._self._c; return e("div", { staticClass: "effect-wrap" }, [e("canvas", { ref: "webglCanvas", attrs: { id: "webglCanvas" } }), t._v(" "), e("div", { staticClass: "effect-hot-spot", style: { width: "".concat(t.$frame.frameState.width, "px"), height: "".concat(t.$frame.frameState.height, "px") } })]) }, [], !1, null, "42eb7bf7", null).exports, V = n(92225), U = n(29802), K = n(4115), q = n(97921); function X(t) { return function (t) { if (Array.isArray(t)) return z(t) }(t) || function (t) { if ("undefined" != typeof Symbol && null != t[Symbol.iterator] || null != t["@@iterator"]) return Array.from(t) }(t) || function (t, e) { if (t) { if ("string" == typeof t) return z(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? z(t, e) : void 0 } }(t) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }() } function z(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, a = Array(e); n < e; n++)a[n] = t[n]; return a } var J = { __name: "gamePauseModal", emits: ["continueGame"], setup: function (t, e) { var i = e.emit, o = (0, q.v)().trackEvent, c = (0, a.getCurrentInstance)().proxy, l = (0, U.g)(), s = l.showRuleModal, d = l.showSkillModal, f = (0, K.pT)(!0), v = f.onDirection, m = f.onBtnPress, p = (0, a.computed)(function () { return [{ text: "game_continue_btn", key: "continue", img: n(71927), imgHover: n(67452) }, { text: "game_skill_btn", key: "skill", img: n(53547), imgHover: n(37856) }].concat(X(u.rS.curGuideStep >= 3 ? [{ text: "game_rule_btn", key: "rule", img: n(59766), imgHover: n(94231) }] : []), X(u.rS.isBossGame || u.rS.curGuideStep < 3 ? [] : [{ text: "game_restart_btn", key: "restart", img: n(19237), imgHover: n(4658) }, { text: "game_clearing_btn", key: "clearing", img: n(14525), imgHover: n(89818) }])) }), g = (0, a.computed)(function () { return u.wk.curGameScore >= u.rS.weeklyTarget }), _ = function (t) { switch (c.$playEffect(r.Ie.Common_Click), t) { case "continue": o("button", "click", "resume", ""), i("continueGame"); break; case "skill": o("button", "click", "ability2", ""), d(!1); break; case "rule": o("button", "click", "rules2", ""), s("3_1", !1); break; case "restart": o("button", "click", "restart", ""), i("restartGame"); break; case "clearing": o("button", "click", "windup", ""), i("endGame") } }, b = (0, a.ref)(u.wk.enableGamepad ? 0 : -1); return v(function (t) { var e = t.direction; u.wk.enableGamepad && ("left" === e ? b.value > 0 && b.value-- : "right" === e && b.value < p.value.length - 1 && b.value++) }), m("confirm", function () { u.wk.enableGamepad && _(p.value[b.value].key) }), m("cancel", function () { c.$playEffect(r.Ie.Common_Click), i("continueGame") }, "Escape"), (0, a.onMounted)(function () { o("session", "visit", "tetris_pause", ""), c.$playEffect(r.Ie.Popup) }), { __sfc: !0, trackEvent: o, vm: c, emit: i, showRuleModal: s, showSkillModal: d, onDirection: v, onBtnPress: m, btnList: p, hasAchievedTarget: g, handleBtnClick: _, focusBtnIdx: b, getters: u.rS, state: u.wk } } }, Q = (0, D.A)(J, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { staticClass: "game-pause-modal title-font" }, [e("p", { staticClass: "game-pause-modal-title" }, [t._v(t._s(t.$getI18nWord("pause_modal_title")))]), t._v(" "), e("div", { staticClass: "game-pause-modal-content hightest-score" }, [e("div", { staticClass: "content-label" }, [t._v(t._s(t.$getI18nWord("label_highest_score")))]), t._v(" "), e("div", { staticClass: "content-value" }, [t._v(t._s(n.getters.highestScore))])]), t._v(" "), n.getters.weeklyTarget ? e("div", { staticClass: "game-pause-modal-content target-score", class: { "target-score__achieved": n.hasAchievedTarget } }, [e("div", { staticClass: "content-label" }, [t._v(t._s(t.$getI18nWord("label_target_score")))]), t._v(" "), e("div", { staticClass: "content-value" }, [t._v(t._s(n.getters.weeklyTarget))]), t._v(" "), n.hasAchievedTarget ? e("div", { staticClass: "achieved-label" }) : t._e()]) : t._e(), t._v(" "), e("div", { staticClass: "modal-btn-container" }, t._l(n.btnList, function (a, i) { return e("hover-btn", { key: a.class, staticClass: "btn-item", class: { "btn-item__focus": n.focusBtnIdx === i }, attrs: { img: a.img, "img-hover": a.imgHover, "img-active": a.imgHover, "is-active": n.focusBtnIdx === i, "need-active": !0 }, on: { click: function (t) { return n.handleBtnClick(a.key) } } }, [e("div", { staticClass: "btn-item-text", attrs: { "data-text": t.$getI18nWord(a.text) } }, [t._v(t._s(t.$getI18nWord(a.text)))])]) }), 1), t._v(" "), n.state.enableGamepad ? e("div", { staticClass: "gamepad-tip" }, [e("div", { staticClass: "gamepad-tip-item" }, [e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.confirm, alt: "" } }), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("gamepad_confirm_btn")))])]), t._v(" "), e("div", { staticClass: "gamepad-tip-item" }, [e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.cancel, alt: "" } }), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("gamepad_back_btn")))])])]) : t._e()]) }, [], !1, null, "7ff534e0", null).exports, Y = n(10526), Z = n(17782), tt = n(43097), et = n(19716), nt = n(57905); function at() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var l = a && a.prototype instanceof c ? a : c, s = Object.create(l.prototype); return it(s, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), s } var o = {}; function c() { } function l() { } function s() { } e = Object.getPrototypeOf; var u = [][a] ? e(e([][a]())) : (it(e = {}, a, function () { return this }), e), d = s.prototype = c.prototype = Object.create(u); function f(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, s) : (t.__proto__ = s, it(t, i, "GeneratorFunction")), t.prototype = Object.create(d), t } return l.prototype = s, it(d, "constructor", s), it(s, "constructor", l), l.displayName = "GeneratorFunction", it(s, i, "GeneratorFunction"), it(d), it(d, i, "Generator"), it(d, a, function () { return this }), it(d, "toString", function () { return "[object Generator]" }), (at = function () { return { w: r, m: f } })() } function it(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } it = function (t, e, n, a) { function r(e, n) { it(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, it(t, e, n, a) } function rt(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } function ot(t) { return function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { rt(r, a, i, o, c, "next", t) } function c(t) { rt(r, a, i, o, c, "throw", t) } o(void 0) }) } } function ct(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, a = Array(e); n < e; n++)a[n] = t[n]; return a } var lt = { __name: "game", setup: function (t) { var e, i, c, l, s, d, f, m = (0, q.v)().trackEvent, p = (0, tt.d)(), g = (0, et.bP)(p).curGuideStep, _ = (0, Y.k)().showPromptModal, b = (0, a.getCurrentInstance)().proxy, h = (0, a.ref)(1), y = (0, a.ref)(!1), k = (0, a.ref)(u.rS.skillUseCnt), w = (0, a.ref)(!1), I = (0, K.pT)(), C = I.onBtnPress, S = I.onDirection, T = I.onBtnHold, $ = I.onBtnRelease, x = "fr-fr" === b.$getLang(), E = n(x ? 38845 : 50255), O = n(x ? 41775 : 89201), P = n(x ? 31832 : 41792), G = (0, a.computed)(function () { return [{ type: "dir", icon: [E, n(72080), n(5440)] }, { type: "rotate", icon: [O] }, { type: "hold", icon: [n(76103)] }].concat(function (t) { if (Array.isArray(t)) return ct(t) }(t = (0, u.el)(4) ? [{ type: "combo", icon: [P] }] : []) || function (t) { if ("undefined" != typeof Symbol && null != t[Symbol.iterator] || null != t["@@iterator"]) return Array.from(t) }(t) || function (t, e) { if (t) { if ("string" == typeof t) return ct(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? ct(t, e) : void 0 } }(t) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }(), [{ type: "drop", icon: [n(49755)] }]); var t }), M = function (t) { var e = [1, 2, 3].includes(t); return !(0, u.el)(t) || e && 0 === k.value || !e && w.value }, A = (0, a.ref)({ d_pad_up: { hover: !1, hold: !1 }, d_pad_right: { hover: !1, hold: !1 }, d_pad_down: { hover: !1, hold: !1 }, d_pad_left: { hover: !1, hold: !1 }, skill_1: { hover: !1, hold: !1, disabled: M(1) }, skill_2: { hover: !1, hold: !1, disabled: M(2) }, skill_3: { hover: !1, hold: !1, disabled: M(3) }, skill_q: { hover: !1, hold: !1, disabled: M(4) }, hold: { hover: !1, hold: !1, disabled: !1 }, drop: { hover: !1, hold: !1 } }), B = (0, a.computed)(function () { return u.wk.gameBonusList.map(function (t) { var e = t.type, n = t.value, a = Math.round(100 * n), i = b.$getI18nWord("game_bonus_".concat(e)); return "".concat(i).concat(a, "%") }) }), L = (0, a.computed)(function () { return u.wk.gameBonusList.some(function (t) { var e = t.type, n = t.value; return "height" === e && n > 1 }) }), j = (0, a.computed)(function () { var t; return (null === (t = u.wk.pageInfo) || void 0 === t || null === (t = t.user_activity_info) || void 0 === t || null === (t = t.skill_info) || void 0 === t ? void 0 : t.ability_c) > 0 }), W = (0, a.computed)(function () { var t; return (null === (t = u.wk.pageInfo) || void 0 === t || null === (t = t.user_activity_info) || void 0 === t || null === (t = t.skill_info) || void 0 === t ? void 0 : t.ability_c) >= o.sb ? "7.64" : "5.58" }), N = (0, a.ref)([{ key: "d_pad_up", direction: "up" }, { key: "d_pad_right", direction: "right" }, { key: "d_pad_down", direction: "down" }, { key: "d_pad_left", direction: "left" }]), R = u.wk.enableGamepad ? { 1: null === (e = b.$meGamepad) || void 0 === e ? void 0 : e.btnIconMap.leftShoulder2, 2: null === (i = b.$meGamepad) || void 0 === i ? void 0 : i.btnIconMap.leftShoulder1, 3: null === (c = b.$meGamepad) || void 0 === c ? void 0 : c.btnIconMap.rightShoulder1, hold: null === (l = b.$meGamepad) || void 0 === l ? void 0 : l.btnIconMap.cancel, drop: null === (s = b.$meGamepad) || void 0 === s ? void 0 : s.btnIconMap.confirm, combo: null === (d = b.$meGamepad) || void 0 === d ? void 0 : d.btnIconMap.rightShoulder2, d_pad_up: null === (f = b.$meGamepad) || void 0 === f ? void 0 : f.btnIconMap.button3, d_pad_right: n(40572), d_pad_down: n(6324), d_pad_left: n(54323) } : {}, F = { 1: n(13037), 2: n(22358), 3: n(447), 4: P }, D = function () { b.$gemit("pauseGame"), m("button", "click", "pause", ""); var t, e, n, a = b.$commonModal(Q, { methods: { continueGame: (n = ot(at().m(function t() { return at().w(function (t) { for (; ;)switch (t.n) { case 0: return a.close(), t.n = 1, lt(); case 1: b.$gemit("resumeGame"); case 2: return t.a(2) } }, t) })), function () { return n.apply(this, arguments) }), restartGame: (e = ot(at().m(function t() { return at().w(function (t) { for (; ;)switch (t.n) { case 0: return t.n = 1, _(b.$getI18nWord("restart_prompt_title"), b.$getI18nWord("restart_prompt_title")); case 1: return a.close(), b.$gemit("resetGame"), t.n = 2, lt(); case 2: b.$gemit("startGame"); case 3: return t.a(2) } }, t) })), function () { return e.apply(this, arguments) }), endGame: (t = ot(at().m(function t() { var e, n, i, r, o, c; return at().w(function (t) { for (; ;)switch (t.n) { case 0: return e = u.wk.pageInfo.user_activity_info.activity_progress, n = e.week, i = e.week_challenge_finished, r = u.wk.curGameScore >= u.rS.weeklyTarget, o = r ? 1 : 2, c = b.$getI18nWord("settle_prompt_title"), (5 === u.rS.curWeek && (0, u.vI)("ending") === nt.OX.COMPLETED || i[n]) && (o = 3, c = ""), t.n = 1, _(c, b.$getI18nWord("settle_prompt_desc_".concat(o))); case 1: a.close(), b.$gemit("settleGame"); case 2: return t.a(2) } }, t) })), function () { return t.apply(this, arguments) }) } }) }, H = (0, a.ref)({}), V = function (t) { A.value["skill_".concat(t)].disabled || (b.$gemit("useSkill", t), st("skill_".concat(t)), H.value["skill_".concat(t)] = setTimeout(function () { ut("skill_".concat(t)) }, 50)) }, U = function (t) { "d_pad_up" === t && (b.$gemit("rotateBlock"), st("d_pad_up"), clearTimeout(H.value.d_pad_up), H.value.d_pad_up = setTimeout(function () { ut("d_pad_up") }, 50)) }, X = function () { b.$gemit("holdBlock"), st("hold"), setTimeout(function () { ut("hold") }, 50) }, z = function () { b.$gemit("hardDrop"), st("drop"), setTimeout(function () { ut("drop") }, 50) }, J = (0, a.ref)([{ key: "hold", handler: X }, { key: "drop", handler: z }]), it = function (t) { var e, n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : "", a = arguments.length > 2 ? arguments[2] : void 0; "mouse" === n && r.K6 || "touch" === n && !r.K6 || ["d_pad_down", "d_pad_left", "d_pad_right"].includes(t) && (null == a || null === (e = a.preventDefault) || void 0 === e || e.call(a), b.$gemit("onTouchStart", t), st(t)) }, rt = function (t) { var e = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : ""; "mouse" === e && r.K6 || "touch" === e && !r.K6 || (["d_pad_down", "d_pad_left", "d_pad_right"].includes(t) && b.$gemit("onTouchEnd", t), ut(t)) }, lt = function () { return new Promise(function (t) { var e = b.$mtoast.loading({ showContent: !1, duration: 0 }); v.default.to(".countdown-item", { keyframes: { opacity: [0, 1, 1, 1, 0], scale: [0, 1, 1, 1, 0] }, duration: .8, delay: function (t) { return .9 * t }, onComplete: function () { b.$mtoast.clear(e), t() } }) }) }, st = function (t) { A.value[t].disabled || (A.value[t].hold = !0, ft(t)) }, ut = function (t) { A.value[t].disabled || (A.value[t].hold = !1, ft(t)) }, dt = function (t, e) { A.value[t].disabled = e, ft(t) }, ft = function (t) { var e = A.value[t], n = e.hover, a = e.hold, i = e.disabled; b.$gemit("setBtn", { key: t, hover: n, hold: a, disabled: i }) }, vt = function () { Object.keys(A.value).forEach(function (t) { ft(t) }) }, mt = function () { var t = ot(at().m(function t() { return at().w(function (t) { for (; ;)switch (t.n) { case 0: return t.n = 1, lt(); case 1: b.$gemit("resumeGame"); case 2: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), pt = function (t) { k.value = t }, gt = function (t) { dt("hold", !t), A.value.hold.hold = !1, A.value.hold.hover = !1 }, _t = function (t) { w.value = t }, bt = function (t) { h.value = t }; (0, a.onMounted)(function () { vt(), m("session", "visit", "tetris", ""), u.wk.blockAction || setTimeout(function () { ht() }, 1e3), b.$gon("updateGameLevel", bt), b.$gon("updateHoldBtn", gt), b.$gon("updateSkillUseCnt", pt), b.$gon("updateIsComboSkillUsed", _t), b.$gon("startGuideGame", mt) }), (0, a.onBeforeUnmount)(function () { b.$goff("updateGameLevel", bt), b.$goff("updateHoldBtn", gt), b.$goff("updateSkillUseCnt", pt), b.$goff("updateIsComboSkillUsed", _t), b.$goff("startGuideGame", mt) }), (0, a.watch)(k, function () { ["skill_1", "skill_2", "skill_3"].forEach(function (t, e) { dt(t, M(e + 1)) }) }), (0, a.watch)(w, function () { dt("skill_q", M(4)) }); var ht = function () { var t = ot(at().m(function t() { return at().w(function (t) { for (; ;)switch (t.n) { case 0: return t.n = 1, lt(); case 1: b.$gemit("startGame"), u.wk.needResumeBgm && ((0, u.$j)({ needResumeBgm: !1 }), b.$gemit("resumeFinalBgm")); case 2: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(); 1 === g.value && (0, a.watch)(function () { return u.wk.curGameScore }, function (t) { if (t >= r.De) { b.$gemit("pauseGame"), b.$gemit("updateSubIdx"), (0, u.$j)({ guideModalVisible: !0 }); var e = b.$commonModal(Z.A, { dialogInfo: { step: g.value, initSubStep: 10 }, methods: { end: function () { e.close(), b.$gemit("settleGame") } }, closeCb: function () { (0, u.$j)({ guideModalVisible: !1 }) }, zIndex: 1e3, name: "guide", hasContainer: !1, needMask: !1, bgOpacity: 0 }) } }); var yt = (0, a.computed)(function () { return u.rS.weeklyTarget ? "".concat(b.$getI18nWord("label_target_score")).concat(u.rS.weeklyTarget) : "" }), kt = (0, a.computed)(function () { return u.wk.curGameScore >= u.rS.weeklyTarget }); return (0, a.watch)(kt, function () { kt.value && (y.value = !0, setTimeout(function () { y.value = !1 }, 3e3)) }), C("start", function () { D() }, "Escape"), C("leftShoulder2", function () { V(1) }), C("leftShoulder1", function () { V(2) }), C("confirm", function () { z() }), C("rightShoulder1", function () { V(3) }), C("rightShoulder2", function () { V("q") }), C("cancel", function () { X() }), C("button3", function () { U("d_pad_up") }), S(function (t) { "up" === t.direction && z() }), T("d_pad_left", function () { it("d_pad_left") }), T("d_pad_right", function () { it("d_pad_right") }), T("d_pad_down", function () { it("d_pad_down") }), $("d_pad_left", function () { rt("d_pad_left") }), $("d_pad_right", function () { rt("d_pad_right") }), $("d_pad_down", function () { rt("d_pad_down") }), { __sfc: !0, trackEvent: m, guideStore: p, curGuideStep: g, showPromptModal: _, vm: b, gameLevel: h, achievedTipVisible: y, skillUseCnt: k, isComboSkillUsed: w, onBtnPress: C, onDirection: S, onBtnHold: T, onBtnRelease: $, RESET_TIMEOUT: 50, isAzerty: x, leftIcon: E, rotateIcon: O, skill4Icon: P, keyboardOperateTipList: G, isSkillBtnDisabled: M, operateBtnState: A, infoList: B, isHeightBonusTipActive: L, heightBonusActive: j, heightBonusPos: W, dPadList: N, skillIconMap: R, keyboardSkillIcon: F, pauseGame: D, releaseTimer: H, useSkill: V, rotateBlock: U, holdBlock: X, hardDrop: z, operateBtnList: J, onTouchStart: it, onTouchEnd: rt, formatScore: function (t) { return t.toString().split("") }, startCountdown: lt, onHover: function (t) { r.K6 || A.value[t].disabled || (A.value[t].hover = !0, ft(t)) }, onLeave: function (t) { r.K6 || A.value[t].disabled || (A.value[t].hover = !1, rt(t), ft(t)) }, onTap: st, onRelease: ut, updateSkillDisable: dt, updateBtn: ft, initBtnState: vt, startGuideGame: mt, updateSkillUseCnt: pt, updateHoldBtn: gt, updateIsComboSkillUsed: _t, updateGameLevel: bt, startGame: ht, targetLabel: yt, isAchievedTarget: kt, state: u.wk, getters: u.rS, isSkillUnlock: u.el, IS_MOB: r.K6 } } }, st = lt, ut = (0, D.A)(st, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { staticClass: "game-wrap", class: { "game-wrap__final": n.getters.isBossGame } }, [n.getters.keyboardLayout ? t._e() : e("div", { staticClass: "direction-panel" }, t._l(n.dPadList, function (a) { return e("div", { key: a.key, staticClass: "direction-btn no-select", class: "direction-btn__".concat(a.direction), on: { contextmenu: function (t) { t.preventDefault() }, touchstart: function (t) { return n.onTouchStart(a.key, "touch", t) }, mousedown: function (t) { return n.onTouchStart(a.key, "mouse") }, mouseup: function (t) { return n.onTouchEnd(a.key, "mouse") }, touchend: function (t) { return n.onTouchEnd(a.key, "touch", t) }, touchcancel: function (t) { return n.onTouchEnd(a.key, "touch", t) }, mouseenter: function (t) { return n.onHover(a.key) }, mouseleave: function (t) { return n.onLeave(a.key) }, click: function (t) { return n.rotateBlock(a.key) } } }, [e("span", [t._v(" ")]), t._v(" "), n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: n.skillIconMap[a.key], alt: "" } }) : t._e()]) }), 0), t._v(" "), n.getters.keyboardLayout ? e("div", { staticClass: "keyboard-operate-tip" }, t._l(n.keyboardOperateTipList, function (n) { return e("div", { key: n.type, staticClass: "keyboard-operate-tip-item title-font", class: "keyboard-operate-tip-item__".concat(n.type) }, [e("div", { staticClass: "icon-list" }, t._l(n.icon, function (t) { return e("img", { key: t, attrs: { src: t, alt: "" } }) }), 0), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("keyboard_tip_".concat(n.type))))])]) }), 0) : t._e(), t._v(" "), e("div", { staticClass: "left-skill-panel title-font" }, [e("span", [t._v(t._s(t.$getI18nWord("left_skill_cnt")))]), t._v(" "), e("span", [t._v(t._s(n.skillUseCnt))])]), t._v(" "), e("div", { staticClass: "skill-panel" }, t._l(3, function (a) { return e("div", { key: a, staticClass: "skill-btn no-select", class: "skill-btn__".concat(a), on: { click: function (t) { return n.useSkill(a) }, mouseenter: function (t) { return n.onHover("skill_".concat(a)) }, mouseleave: function (t) { return n.onLeave("skill_".concat(a)) } } }, [e("span", [t._v(" ")]), t._v(" "), n.isSkillUnlock(a) ? [n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: n.skillIconMap[a], alt: "" } }) : n.IS_MOB ? t._e() : e("img", { staticClass: "gamepad-icon", attrs: { src: n.keyboardSkillIcon[a], alt: "" } })] : t._e()], 2) }), 0), t._v(" "), e("div", { staticClass: "combo-skill no-select", on: { click: function (t) { return n.useSkill("q") }, mouseenter: function (t) { return n.onHover("skill_q") }, mouseleave: function (t) { return n.onLeave("skill_q") } } }, [e("span", [t._v(" ")]), t._v(" "), n.isSkillUnlock(4) ? [n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: n.skillIconMap.combo, alt: "" } }) : n.IS_MOB ? t._e() : e("img", { staticClass: "gamepad-icon", attrs: { src: n.keyboardSkillIcon[4], alt: "" } })] : t._e()], 2), t._v(" "), n.getters.keyboardLayout ? t._e() : e("div", { staticClass: "operate-panel" }, t._l(n.operateBtnList, function (a) { var i = a.key, r = a.handler; return e("div", { key: i, staticClass: "operate-btn no-select", class: "operate-btn__".concat(i), on: { click: r, mouseenter: function (t) { return n.onHover(i) }, mouseleave: function (t) { return n.onLeave(i) } } }, [e("span", [t._v(" ")]), t._v(" "), n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: n.skillIconMap[i], alt: "" } }) : t._e()]) }), 0), t._v(" "), e("div", { staticClass: "cur-game-info title-font" }, [e("div", { staticClass: "score-panel" }, t._l(n.formatScore(n.state.curGameScore), function (t, n) { return e("div", { key: n, staticClass: "score-item", class: "score-item__".concat(t) }) }), 0), t._v(" "), e("div", { staticClass: "game-level" }, [e("span", [t._v(t._s(t.$getI18nWord({ key: "game_level_label", data: { level: n.gameLevel } })))])]), t._v(" "), n.targetLabel ? e("div", { staticClass: "target-score", class: { "target-score__achieved": n.isAchievedTarget } }, [t._v(t._s(n.targetLabel))]) : t._e(), t._v(" "), e("div", { staticClass: "info-panel" }, t._l(n.infoList, function (n, a) { return e("div", { key: a, staticClass: "info-item" }, [e("span", [t._v(t._s(n))])]) }), 0)]), t._v(" "), n.heightBonusActive ? e("div", { staticClass: "height-bonus-tip", class: { "height-bonus-tip__active": n.isHeightBonusTipActive }, style: { top: "".concat(n.heightBonusPos, "rem") } }) : t._e(), t._v(" "), e("div", { staticClass: "countdown-wrap" }, t._l(4, function (t) { return e("div", { key: t, staticClass: "countdown-item", class: "countdown-item__".concat(4 - t) }) }), 0), t._v(" "), e("div", { staticClass: "pause-btn", on: { click: n.pauseGame } }, [n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.start } }) : t._e()]), t._v(" "), e("div", { staticClass: "preview-panel title-font" }, [e("p", { staticClass: "preview-panel-title" }, [t._v(t._s(t.$getI18nWord("game_preview_next")))]), t._v(" "), e("p", { staticClass: "preview-panel-title preview-panel-title__hold" }, [t._v(t._s(t.$getI18nWord("game_preview_hold")))])]), t._v(" "), n.achievedTipVisible ? e("div", { staticClass: "target-achieved-tip title-font", domProps: { innerHTML: t._s(t.$getI18nWord("target_achieved_tip")) } }) : t._e()]) }, [], !1, null, null, null).exports; function dt() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var l = a && a.prototype instanceof c ? a : c, s = Object.create(l.prototype); return ft(s, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), s } var o = {}; function c() { } function l() { } function s() { } e = Object.getPrototypeOf; var u = [][a] ? e(e([][a]())) : (ft(e = {}, a, function () { return this }), e), d = s.prototype = c.prototype = Object.create(u); function f(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, s) : (t.__proto__ = s, ft(t, i, "GeneratorFunction")), t.prototype = Object.create(d), t } return l.prototype = s, ft(d, "constructor", s), ft(s, "constructor", l), l.displayName = "GeneratorFunction", ft(s, i, "GeneratorFunction"), ft(d), ft(d, i, "Generator"), ft(d, a, function () { return this }), ft(d, "toString", function () { return "[object Generator]" }), (dt = function () { return { w: r, m: f } })() } function ft(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } ft = function (t, e, n, a) { function r(e, n) { ft(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, ft(t, e, n, a) } function vt(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } var mt = { __name: "landing", emits: ["startGame"], setup: function (t, e) { var n = e.emit, i = (0, a.getCurrentInstance)().proxy, o = (0, a.ref)(!1), c = (0, a.ref)(null), l = (0, q.v)().trackEvent, s = function () { var t, e = (t = dt().m(function t() { return dt().w(function (t) { for (; ;)switch (t.n) { case 0: if (i.$playEffect(r.Ie.Common_Click), l("button", "click", "start_game", ""), i.$accountRoleUtil.checkLogin()) { t.n = 1; break } return t.a(2, !1); case 1: if (o.value) { t.n = 2; break } return i.$mtoast(i.$getI18nWord("agreement_block_tip")), t.a(2, !1); case 2: if (0 !== Object.keys(u.wk.pageInfo).length) { t.n = 3; break } return t.n = 3, (0, u.cv)(!0); case 3: n("enter"); case 4: return t.a(2) } }, t) }), function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { vt(r, a, i, o, c, "next", t) } function c(t) { vt(r, a, i, o, c, "throw", t) } o(void 0) }) }); return function () { return e.apply(this, arguments) } }(); return (0, a.onMounted)(function () { l("session", "visit", "main", "") }), { __sfc: !0, emits: n, vm: i, agreementChecked: o, agreementTextRef: c, trackEvent: l, handleCheckboxClick: function () { i.$playEffect(r.Ie.Common_Click), o.value = !o.value, l("button", "click", "privacy", "") }, handleStartBtnClick: s } } }, pt = mt, gt = (0, D.A)(pt, function () { var t, e = this, n = e._self._c, a = e._self._setupProxy; return n("div", { staticClass: "landing-page title-font" }, [n("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: e.$getLocalImg("landing_content_bg.png"), expression: "$getLocalImg('landing_content_bg.png')", modifiers: { bg: !0 } }], staticClass: "landing-page-main" }, [n("div", { staticClass: "landing-page-main-slogan", style: { backgroundImage: "url(".concat(e.$getI18nWord("landing_slogan"), ")") } }), e._v(" "), n("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: e.$getLocalImg("landing_start_btn.png"), expression: "$getLocalImg('landing_start_btn.png')", modifiers: { bg: !0 } }], staticClass: "start-btn", on: { click: a.handleStartBtnClick } }, [n("span", { attrs: { "data-text": e.$getI18nWord("landing_start_btn") } }, [e._v(e._s(e.$getI18nWord("landing_start_btn")))])]), e._v(" "), n("div", { staticClass: "agreement-container" }, [n("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: e.$getLocalImg(a.agreementChecked ? "landing_checkbox_active.png" : "landing_checkbox_default.png"), expression: "$getLocalImg(\n          agreementChecked ? 'landing_checkbox_active.png' : 'landing_checkbox_default.png'\n        )", modifiers: { bg: !0 } }], staticClass: "agreement-checkbox", class: { "agreement-checkbox__checked": a.agreementChecked }, on: { click: a.handleCheckboxClick } }), e._v(" "), n("p", { ref: "agreementTextRef", staticClass: "agreement-text", attrs: { "data-text": (null === (t = a.agreementTextRef) || void 0 === t ? void 0 : t.innerText) || "" }, domProps: { innerHTML: e._s(e.$getI18nWord("landing_agreement_tip")) } })])])]) }, [], !1, null, null, null).exports; function _t(t) { return _t = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, _t(t) } function bt() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var l = a && a.prototype instanceof c ? a : c, s = Object.create(l.prototype); return ht(s, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), s } var o = {}; function c() { } function l() { } function s() { } e = Object.getPrototypeOf; var u = [][a] ? e(e([][a]())) : (ht(e = {}, a, function () { return this }), e), d = s.prototype = c.prototype = Object.create(u); function f(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, s) : (t.__proto__ = s, ht(t, i, "GeneratorFunction")), t.prototype = Object.create(d), t } return l.prototype = s, ht(d, "constructor", s), ht(s, "constructor", l), l.displayName = "GeneratorFunction", ht(s, i, "GeneratorFunction"), ht(d), ht(d, i, "Generator"), ht(d, a, function () { return this }), ht(d, "toString", function () { return "[object Generator]" }), (bt = function () { return { w: r, m: f } })() } function ht(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } ht = function (t, e, n, a) { function r(e, n) { ht(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, ht(t, e, n, a) } function yt(t, e) { return function (t) { if (Array.isArray(t)) return t }(t) || function (t, e) { var n = null == t ? null : "undefined" != typeof Symbol && t[Symbol.iterator] || t["@@iterator"]; if (null != n) { var a, i, r, o, c = [], l = !0, s = !1; try { if (r = (n = n.call(t)).next, 0 === e) { if (Object(n) !== n) return; l = !1 } else for (; !(l = (a = r.call(n)).done) && (c.push(a.value), c.length !== e); l = !0); } catch (t) { s = !0, i = t } finally { try { if (!l && null != n.return && (o = n.return(), Object(o) !== o)) return } finally { if (s) throw i } } return c } }(t, e) || function (t, e) { if (t) { if ("string" == typeof t) return kt(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? kt(t, e) : void 0 } }(t, e) || function () { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }() } function kt(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, a = Array(e); n < e; n++)a[n] = t[n]; return a } function wt(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } function It(t, e) { var n = Object.keys(t); if (Object.getOwnPropertySymbols) { var a = Object.getOwnPropertySymbols(t); e && (a = a.filter(function (e) { return Object.getOwnPropertyDescriptor(t, e).enumerable })), n.push.apply(n, a) } return n } function Ct(t) { for (var e = 1; e < arguments.length; e++) { var n = null != arguments[e] ? arguments[e] : {}; e % 2 ? It(Object(n), !0).forEach(function (e) { St(t, e, n[e]) }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(n)) : It(Object(n)).forEach(function (e) { Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(n, e)) }) } return t } function St(t, e, n) { return (e = function (t) { var e = function (t) { if ("object" != _t(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var n = e.call(t, "string"); if ("object" != _t(n)) return n; throw new TypeError("@@toPrimitive must return a primitive value.") } return String(t) }(t); return "symbol" == _t(e) ? e : e + "" }(e)) in t ? Object.defineProperty(t, e, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : t[e] = n, t } var Tt = (0, a.defineComponent)({ __name: "home", props: { activeIdolId: null, errTargetText: null }, emits: ["onGameBtnClick", "selectedIdol", "eventClick", "interactClick", "updateHomeBtnState"], setup: function (t, e) { var i = e.emit, c = t, l = (0, tt.d)(), s = (0, et.bP)(l).curGuideStep, d = (0, K.pT)(), f = d.onBtnPress, m = d.onDirection, p = (0, a.getCurrentInstance)().proxy, g = (0, a.ref)(null), _ = (0, a.ref)(null), b = (0, a.ref)(!0), h = (0, U.g)().showTaskModal, y = (0, q.v)().trackEvent, k = (0, a.ref)(-1), w = (0, a.ref)(null), I = (0, a.ref)([]), C = (0, a.ref)({ roleId: -1, pos: "left", msg: "" }), S = (0, a.computed)(function () { return { level: u.wk.pageInfo.user_activity_info.friend_ship_level["level_".concat(c.activeIdolId)] || 0 } }); (0, a.watch)(function () { return c.activeIdolId }, function (t) { -1 !== t && ($(), x()) }); var T = (0, a.ref)({ id: -1, x: 0, y: 0 }); (0, a.watch)(function () { return c.activeIdolId }, function () { k.value = u.wk.enableGamepad ? 0 : -1 }); var $ = function () { var t = document.querySelector(".home-idol-grid-".concat(c.activeIdolId)).getBoundingClientRect(), e = t.left, n = t.top, a = t.right, i = p.$frame.env.rotate, r = document.documentElement.clientWidth, o = i ? r - a : n, l = (i ? n : e) / p.$frame.rem - p.$frame.frameStateToBodyRem.left, s = o / p.$frame.rem - p.$frame.frameStateToBodyRem.top; T.value = { id: c.activeIdolId, x: l, y: s } }, x = function () { var t; null === (t = w.value) || void 0 === t || t.kill(), w.value = v.default.timeline(), w.value.fromTo(".friendship-info", { opacity: 0, y: "0.1rem" }, { opacity: 1, y: 0, duration: .1, ease: "power0.inOut" }).fromTo(".friendship-info-icon", { opacity: 0, y: "0.1rem" }, { opacity: 1, y: 0, duration: .5, ease: "back.out(1.7)", delay: function (t) { return .05 * t } }, "-=0.1").fromTo(".idol-btn", { opacity: 0, x: "0.1rem" }, { opacity: 1, x: 0, duration: .5, ease: "back.out(1.7)", delay: function (t) { return .05 * t } }, "-=0.6") }, E = function (t) { var e = { y: "0.1rem", opacity: 0 }, n = { y: 0, opacity: 1 }; return new Promise(function (a) { v.default.fromTo(".idol-popover", t ? n : e, Ct(Ct({}, t ? e : n), {}, { duration: .2, ease: "power1.inOut", onComplete: a })) }) }, O = function () { var t, e = (t = bt().m(function t(e) { var n, a, i, c, l, s, d, f, v, m, g, _; return bt().w(function (t) { for (; ;)switch (t.n) { case 0: if (b.value && "hidden" !== document.visibilityState) { t.n = 1; break } return t.a(2); case 1: if (b.value = !1, -1 === C.value.roleId) { t.n = 2; break } return t.n = 2, E(!0); case 2: if (n = e, e) { t.n = 4; break } if (0 !== (a = Object.entries(u.wk.idolState).filter(function (t) { var e = yt(t, 2)[1]; return !e.walkInterval && 0 === e.poseId && !e.selected }).map(function (t) { var e = yt(t, 1)[0]; return o.cZ[e] }).filter(Boolean)).length) { t.n = 3; break } return b.value = !0, t.a(2); case 3: n = a[Math.floor(Math.random() * a.length)]; case 4: for (i = !!e, c = "", l = { 1: 6, 2: 7, 3: 7 }, 4 === I.value.length && I.value.shift(), s = i ? "interact" : "standby", d = 0, f = [], v = 1; v <= l[n]; v++)m = "".concat(s, "_").concat(n, "_").concat(v), I.value.includes(m) || f.push(m); if (0 !== f.length) { t.n = 5; break } return t.a(2); case 5: c = f[Math.floor(Math.random() * f.length)], d = parseInt(c.split("_")[2], 10), I.value.push(c), g = r.tR[s][n][d - 1], p.$gemit("idolPos", n, g), _ = Math.random() > .5 ? "left" : "right", 2 === n && (_ = "right"), 1 === n && (_ = "left"), C.value = { roleId: n, pos: _, msg: p.$getI18nWord(c) }, E(!1), setTimeout(function () { b.value = !0 }, 2e3); case 6: return t.a(2) } }, t) }), function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { wt(r, a, i, o, c, "next", t) } function c(t) { wt(r, a, i, o, c, "throw", t) } o(void 0) }) }); return function (t) { return e.apply(this, arguments) } }(), P = function (t) { p.$playEffect(r.Ie.Common_Click), t !== c.activeIdolId ? i("selectedIdol", t) : G() }, G = function () { i("selectedIdol", -1) }, M = function () { p.$playEffect(r.Ie.Common_Click), i("eventClick") }, A = function () { p.$playEffect(r.Ie.Common_Click), y("button", "click", "interact", c.activeIdolId), O(c.activeIdolId), i("interactClick", c.activeIdolId), G(), B() }, B = function () { clearInterval(g.value), g.value = setInterval(O, 7e3) }, L = function () { clearInterval(_.value), _.value = setInterval(function () { "hidden" !== document.visibilityState && p.$gemit("idolMove") }, 7e3) }, j = (0, a.ref)(!1), W = (0, a.ref)(!1), N = function () { W.value || (W.value = !0, i("onGameBtnClick"), setTimeout(function () { W.value = !1 }, 500)) }, R = function () { var t = j.value ? "hover" : "0"; W.value && (t = "click"), i("updateHomeBtnState", t) }, F = (0, a.computed)(function () { return u.rS.curGuideStep < 2 || u.rS.isFinalOfWeek || 5 === u.rS.curWeek }); (0, a.watch)(W, R), (0, a.watch)(j, R), (0, a.watch)(function () { return u.wk.homeCharacterVisible }, function (t) { t && l.curGuideStep > 4 ? (B(), L()) : (clearInterval(g.value), clearInterval(_.value)) }, { immediate: !0 }); var D = (0, a.computed)(function () { return u.rS.idolEventList[c.activeIdolId] }), H = (0, a.computed)(function () { if (c.errTargetText) return c.errTargetText; if (!u.rS.isFinalOfWeek && 5 !== u.rS.curWeek || u.wk.isFinalAnimating) return ""; if (6 === u.rS.curDate || !u.rS.isFinalDate && 5 === u.rS.curWeek) return p.$getI18nWord({ key: "home_highest_label", data: { score_best: u.rS.highestScore } }); var t = u.rS.isBossLayout ? "9999999999999999999999999999999999999999" : u.rS.weeklyTarget; return t ? p.$getI18nWord({ key: "home_target_label", data: { score: t } }) : "" }), V = (0, a.computed)(function () { return s.value <= 4 || 6 === u.rS.curDate || 5 === u.rS.curWeek ? "" : u.rS.curDate <= 4 || 5 === u.rS.curDate && !u.rS.isFinalOfWeek ? "main_popover_train" : u.rS.isFinalOfWeek ? "main_popover_game" : "" }), X = (0, a.computed)(function () { return u.wk.pageInfo.user_activity_info.task_info.tasks.some(function (t) { return t.status === nt.e1.COMPLETED }) }), z = (0, a.computed)(function () { if (!u.wk.enableGamepad) return ""; var t = J.indexOf(c.activeIdolId); return { 0: n(46402), 1: n(99528), 2: n(66617) }[t] }); (0, a.onBeforeUnmount)(function () { clearInterval(g.value), clearInterval(_.value), W.value = !1, j.value = !1, G() }), f("confirm", function () { if (!(u.wk.isMenuExpanded || u.wk.isFinalAnimating || u.rS.isBossLayout)) if (-1 !== c.activeIdolId) 0 === k.value && 0 === D.value || 1 === k.value ? A() : 0 === k.value && 0 !== D.value && M(); else { var t = Object.keys(u.rS.idolEventList).find(function (t) { return 0 !== u.rS.idolEventList[t] }); P(+t || 3) } }), f("button4", function () { u.wk.isMenuExpanded || -1 !== c.activeIdolId || u.rS.isBossLayout || u.wk.isFinalAnimating || h() }), f("button3", function () { u.wk.isMenuExpanded || -1 !== c.activeIdolId || u.wk.isFinalAnimating || N() }), f("cancel", function () { -1 !== c.activeIdolId && G() }, "Escape"); var J = [1, 3, 2]; m(function (t) { var e = t.direction; if (-1 !== c.activeIdolId) { if (["left", "right"].includes(e)) { var n = "left" === e ? -1 : 1, a = J.indexOf(c.activeIdolId), i = Math.min(Math.max(0, a + n), 2), r = J[i]; r !== c.activeIdolId && P(r) } if (["up", "down"].includes(e)) { var o = "up" === e ? -1 : 1; k.value = Math.min(Math.max(0, k.value + o, 0), 1) } } }); var Q = (0, a.computed)(function () { return F.value ? p.$getI18nWord(u.rS.isBossLayout || c.errTargetText ? "home_final_btn" : "home_game_btn") : p.$getI18nWord("home_training_btn") }), Y = (0, a.computed)(function () { return 2 === c.activeIdolId && u.rS.curGuideStep >= 5 }); return (0, a.onMounted)(function () { y("session", "visit", "activity", ""), p.$gon("openTask", h), document.addEventListener("click", G) }), (0, a.onBeforeUnmount)(function () { p.$goff("openTask", h), document.removeEventListener("click", G) }), { __sfc: !0, guideStore: l, curGuideStep: s, onBtnPress: f, onDirection: m, vm: p, popoverTimer: g, moveTimer: _, canPopoverChange: b, showTaskModal: h, trackEvent: y, handleTaskModal: function () { p.$playEffect(r.Ie.Common_Click), h() }, activeBtnIdx: k, emits: i, props: c, tl: w, popoverMsgHistory: I, popoverMsg: C, friendshipInfo: S, activeIdolInfo: T, updatePos: $, showEntranceAni: x, popoverAni: E, addPopoverMsg: O, onIdolClick: P, resetSelect: G, onEventClick: M, onInteractClick: A, setStandByInterval: B, setMoveInterval: L, isBtnHover: j, isBtnClick: W, onMouseEnter: function () { r.K6 || (j.value = !0) }, onMouseLeave: function () { r.K6 || (j.value = !1) }, onGameBtnClick: N, updateBtnState: R, showGameBtn: F, curIdolEvent: D, homeBtnTip: H, popoverTipKey: V, showAwardRd: X, switchGamepadIcon: z, idolOrder: J, mainBtnText: Q, isLeftBtnList: Y, state: u.wk, getters: u.rS } } }), $t = Tt, xt = (0, D.A)($t, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { staticClass: "home-page title-font" }, [e("div", { directives: [{ name: "show", rawName: "v-show", value: -1 !== n.props.activeIdolId, expression: "props.activeIdolId !== -1" }], staticClass: "interact-info", style: { left: "".concat(n.activeIdolInfo.x, "rem"), top: "".concat(n.activeIdolInfo.y, "rem") } }, [e("div", { staticClass: "friendship-info", class: "friendship-info__".concat(n.props.activeIdolId) }, t._l(6, function (t) { return e("div", { key: t, staticClass: "friendship-info-icon", class: { "friendship-info-icon__active": t <= n.friendshipInfo.level } }) }), 0), t._v(" "), e("div", { staticClass: "idol-btn-container", class: { "idol-btn-container__left": n.isLeftBtnList }, on: { click: function (t) { t.stopPropagation() } } }, [0 !== n.curIdolEvent ? e("div", { staticClass: "event-btn idol-btn", class: { "idol-btn__active": 0 === n.activeBtnIdx || 4 === n.curGuideStep }, on: { click: n.onEventClick } }, [e("i"), t._v(" "), e("span", { domProps: { innerHTML: t._s(t.$getI18nWord("home_event_btn")) } }), t._v(" "), n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.confirm } }) : t._e()]) : t._e(), t._v(" "), e("div", { staticClass: "interact-btn idol-btn", class: { "idol-btn__active": 1 === n.activeBtnIdx || 0 === n.curIdolEvent && 0 === n.activeBtnIdx }, on: { click: n.onInteractClick } }, [e("i"), t._v(" "), e("span", { domProps: { innerHTML: t._s(t.$getI18nWord("home_interact_btn")) } }), t._v(" "), n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.confirm } }) : t._e()])]), t._v(" "), n.state.enableGamepad ? e("div", { staticClass: "gamepad-tips" }, [e("div", { staticClass: "gamepad-tips-item" }, [e("img", { staticClass: "gamepad-icon", attrs: { src: n.switchGamepadIcon } }), t._v(" "), e("span", { attrs: { "data-text": t.$getI18nWord("gamepad_switch_btn") } }, [t._v(t._s(t.$getI18nWord("gamepad_switch_btn")))])]), t._v(" "), e("div", { staticClass: "gamepad-tips-item" }, [e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.cancel } }), t._v(" "), e("span", { attrs: { "data-text": t.$getI18nWord("gamepad_cancel_btn") } }, [t._v(t._s(t.$getI18nWord("gamepad_cancel_btn")))])])]) : t._e()]), t._v(" "), t._l(3, function (a) { return e("div", { directives: [{ name: "teleport", rawName: "v-teleport", value: "#idol_".concat(a), expression: "`#idol_${idol}`" }], key: a, staticClass: "home-idol-grid", class: "home-idol-grid-".concat(a), on: { click: function (t) { return t.stopPropagation(), n.onIdolClick(a) } } }, [n.state.homeCharacterVisible ? [e("div", { directives: [{ name: "show", rawName: "v-show", value: n.popoverMsg.roleId === a, expression: "popoverMsg.roleId === idol" }], staticClass: "idol-popover title-font", class: "idol-popover__".concat(n.popoverMsg.pos) }, [t._v("\n        " + t._s(n.popoverMsg.msg) + "\n      ")]), t._v(" "), 0 !== n.getters.idolEventList[a] ? e("div", { staticClass: "event-notice" }) : t._e()] : t._e()], 2) }), t._v(" "), e("transition", { attrs: { name: "fade" } }, [e("div", { directives: [{ name: "show", rawName: "v-show", value: -1 === n.props.activeIdolId, expression: "props.activeIdolId === -1" }] }, [n.getters.isBossLayout || n.state.isFinalAnimating ? t._e() : e("div", { staticClass: "achievement-btn", class: { "achievement-btn__rd": n.showAwardRd }, on: { click: n.handleTaskModal } }, [e("i", { staticClass: "award-icon" }), t._v(" "), e("i", { directives: [{ name: "show", rawName: "v-show", value: !n.state.enableGamepad, expression: "!state.enableGamepad" }], staticClass: "btn-deco" }), t._v(" "), n.state.enableGamepad ? e("img", { directives: [{ name: "show", rawName: "v-show", value: !n.state.isMenuExpanded, expression: "!state.isMenuExpanded" }], staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.button4 } }) : t._e(), t._v(" "), e("span", { staticClass: "achievement-btn-text", attrs: { "data-text": t.$getI18nWord("home_award_btn") } }, [t._v(t._s(t.$getI18nWord("home_award_btn")))])]), t._v(" "), e("div", { staticClass: "game-start-btn", class: "game-start-btn__".concat(n.showGameBtn ? "game" : "training"), on: { click: n.onGameBtnClick, mouseenter: n.onMouseEnter, mouseleave: n.onMouseLeave } }, [e("div", { staticClass: "game-start-btn-inner" }, [e("i"), t._v(" "), e("p", { staticClass: "game-start-btn-inner-text", attrs: { "data-text": n.mainBtnText } }, [t._v(t._s(n.mainBtnText))]), t._v(" "), n.state.enableGamepad ? e("img", { directives: [{ name: "show", rawName: "v-show", value: !n.state.isMenuExpanded, expression: "!state.isMenuExpanded" }], staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.button3 } }) : t._e()]), t._v(" "), n.homeBtnTip ? e("div", { staticClass: "game-target", class: { "game-target__final": n.getters.isBossLayout || n.props.errTargetText }, attrs: { "data-text": n.homeBtnTip } }, [t._v(t._s(n.homeBtnTip))]) : t._e(), t._v(" "), n.popoverTipKey ? e("div", { staticClass: "popover-tip" }, [e("img", { attrs: { src: t.$getI18nWord(n.popoverTipKey), alt: "" } }), t._v(" "), e("div", { staticClass: "popover-tip-content", domProps: { innerHTML: t._s(t.$getI18nWord("".concat(n.popoverTipKey, "_text"))) } })]) : t._e()]), t._v(" "), n.state.enableGamepad ? e("div", { directives: [{ name: "show", rawName: "v-show", value: !n.getters.isBossLayout && !n.state.isMenuExpanded && !n.state.isFinalAnimating, expression: "!getters.isBossLayout && !state.isMenuExpanded && !state.isFinalAnimating" }], staticClass: "select-gamepad-tip" }, [e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.confirm } }), t._v(" "), e("span", { attrs: { "data-text": t.$getI18nWord("gamepad_select_btn") } }, [t._v(t._s(t.$getI18nWord("gamepad_select_btn")))])]) : t._e()])])], 2) }, [], !1, null, "39117180", null).exports, Et = n(38221), Ot = n.n(Et); function Pt(t) { return Pt = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, Pt(t) } function Gt() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var l = a && a.prototype instanceof c ? a : c, s = Object.create(l.prototype); return Mt(s, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), s } var o = {}; function c() { } function l() { } function s() { } e = Object.getPrototypeOf; var u = [][a] ? e(e([][a]())) : (Mt(e = {}, a, function () { return this }), e), d = s.prototype = c.prototype = Object.create(u); function f(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, s) : (t.__proto__ = s, Mt(t, i, "GeneratorFunction")), t.prototype = Object.create(d), t } return l.prototype = s, Mt(d, "constructor", s), Mt(s, "constructor", l), l.displayName = "GeneratorFunction", Mt(s, i, "GeneratorFunction"), Mt(d), Mt(d, i, "Generator"), Mt(d, a, function () { return this }), Mt(d, "toString", function () { return "[object Generator]" }), (Gt = function () { return { w: r, m: f } })() } function Mt(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } Mt = function (t, e, n, a) { function r(e, n) { Mt(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, Mt(t, e, n, a) } function At(t, e) { var n = Object.keys(t); if (Object.getOwnPropertySymbols) { var a = Object.getOwnPropertySymbols(t); e && (a = a.filter(function (e) { return Object.getOwnPropertyDescriptor(t, e).enumerable })), n.push.apply(n, a) } return n } function Bt(t) { for (var e = 1; e < arguments.length; e++) { var n = null != arguments[e] ? arguments[e] : {}; e % 2 ? At(Object(n), !0).forEach(function (e) { Lt(t, e, n[e]) }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(t, Object.getOwnPropertyDescriptors(n)) : At(Object(n)).forEach(function (e) { Object.defineProperty(t, e, Object.getOwnPropertyDescriptor(n, e)) }) } return t } function Lt(t, e, n) { return (e = function (t) { var e = function (t) { if ("object" != Pt(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var n = e.call(t, "string"); if ("object" != Pt(n)) return n; throw new TypeError("@@toPrimitive must return a primitive value.") } return String(t) }(t); return "symbol" == Pt(e) ? e : e + "" }(e)) in t ? Object.defineProperty(t, e, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : t[e] = n, t } function jt(t) { return function (t) { if (Array.isArray(t)) return Wt(t) }(t) || function (t) { if ("undefined" != typeof Symbol && null != t[Symbol.iterator] || null != t["@@iterator"]) return Array.from(t) }(t) || function (t, e) { if (t) { if ("string" == typeof t) return Wt(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? Wt(t, e) : void 0 } }(t) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }() } function Wt(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, a = Array(e); n < e; n++)a[n] = t[n]; return a } function Nt(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } var Rt = { __name: "clickEffect", setup: function (t) { var e, i = (0, a.getCurrentInstance)().proxy, o = (0, a.ref)(!1), c = (0, a.ref)(null), l = (0, a.ref)([]), s = (0, a.ref)([{ src: "", w: 17, h: 17 }, { src: "", w: 27, h: 28 }, { src: "", w: 29, h: 30 }, { src: "", w: 40, h: 41 }, { src: "", w: 39, h: 41 }]), u = 2500, d = 1080, f = r.K6 ? 2 : 5; function v(t, e) { return t + Math.random() * (e - t) } function m(t, e) { for (var n = 0; n < f; n++) { var a = v(0, 2 * Math.PI), i = v(3, 9), r = Math.cos(a) * i, o = Math.sin(a) * i; l.value.push({ x: t, y: e, vx: r, vy: o, life: 40 + 15 * Math.random(), r: 4 + 4 * Math.random(), id: Math.floor(5 * Math.random()) }) } } function p() { var t = c.value.getContext("2d"); t.clearRect(0, 0, u, d); for (var n = 0; n < l.value.length; n++) { var a = l.value[n]; t.globalAlpha = Math.max(0, a.life / 60), t.drawImage(s.value[a.id].src, a.x, a.y, s.value[a.id].w, s.value[a.id].h), t.globalAlpha = 1, a.x += a.vx, a.y += a.vy, a.vy += .22, a.vx *= .97, a.vy *= .97, a.life -= 1 } l.value = l.value.filter(function (t) { return t.life > 0 }), e = requestAnimationFrame(p) } var g = Ot()(function (t) { var e = i.$frame.env.rotate, n = c.value.getBoundingClientRect(); if (e) { var a = d - (t.clientX - n.left) * (u / n.height); m((t.clientY - n.top) * (d / n.width), a) } else m((t.clientX - n.left) * (u / n.width), (t.clientY - n.top) * (d / n.height)) }, 200, { leading: !0, trailing: !1 }), _ = function () { var t, e = (t = Gt().m(function t() { var e, a; return Gt().w(function (t) { for (; ;)switch (t.n) { case 0: return e = jt(new Array(5)).map(function (t, e) { return n(53585)("./click_effect_icon_".concat(e + 1, ".png")) }), t.n = 1, (0, x.uc)(e); case 1: a = t.v, s.value = s.value.map(function (t, e) { return Bt(Bt({}, t), {}, { src: a[e] }) }), o.value = !0; case 2: return t.a(2) } }, t) }), function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { Nt(r, a, i, o, c, "next", t) } function c(t) { Nt(r, a, i, o, c, "throw", t) } o(void 0) }) }); return function () { return e.apply(this, arguments) } }(); return (0, a.watch)(o, function (t) { t && (p(), document.querySelector("#layout").addEventListener("click", g)) }), _(), (0, a.onBeforeUnmount)(function () { cancelAnimationFrame(e), document.querySelector("#layout").removeEventListener("click", g) }), { __sfc: !0, vm: i, isImgLoaded: o, canvasRef: c, particles: l, particlesSrc: s, CANVAS_WIDTH: u, CANVAS_HEIGHT: d, PARTICLE_COUNT: f, randomBetween: v, createParticles: m, animationId: e, animate: p, onCanvasClick: g, loadParticlesImg: _ } } }, Ft = Rt, Dt = (0, D.A)(Ft, function () { var t = this._self._c; return this._self._setupProxy, t("div", { staticClass: "click-effect" }, [t("canvas", { ref: "canvasRef", staticStyle: { display: "block", width: "100%", height: "100%", background: "transparent", cursor: "pointer" }, attrs: { width: "2500", height: "1080" } })]) }, [], !1, null, "6043a51b", null).exports, Ht = n(44467), Vt = n(1972); function Ut() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var l = a && a.prototype instanceof c ? a : c, s = Object.create(l.prototype); return Kt(s, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), s } var o = {}; function c() { } function l() { } function s() { } e = Object.getPrototypeOf; var u = [][a] ? e(e([][a]())) : (Kt(e = {}, a, function () { return this }), e), d = s.prototype = c.prototype = Object.create(u); function f(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, s) : (t.__proto__ = s, Kt(t, i, "GeneratorFunction")), t.prototype = Object.create(d), t } return l.prototype = s, Kt(d, "constructor", s), Kt(s, "constructor", l), l.displayName = "GeneratorFunction", Kt(s, i, "GeneratorFunction"), Kt(d), Kt(d, i, "Generator"), Kt(d, a, function () { return this }), Kt(d, "toString", function () { return "[object Generator]" }), (Ut = function () { return { w: r, m: f } })() } function Kt(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } Kt = function (t, e, n, a) { function r(e, n) { Kt(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, Kt(t, e, n, a) } function qt(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } function Xt(t) { return function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { qt(r, a, i, o, c, "next", t) } function c(t) { qt(r, a, i, o, c, "throw", t) } o(void 0) }) } } var zt = function (t) { return t[t.Init = 0] = "Init", t[t.Playing = 1] = "Playing", t[t.Stopping = 2] = "Stopping", t }(zt || {}), Jt = (0, a.defineComponent)({ __name: "bgAudio", setup: function (t) { var e = (0, a.ref)(!1), o = (0, a.ref)(!1), c = (0, a.ref)(null), l = (0, a.getCurrentInstance)().proxy, s = (0, a.ref)(null), d = (0, a.ref)(null), f = (0, q.v)().trackEvent, v = (0, a.computed)(function () { if (u.wk.forceBgm) return u.wk.forceBgm; if ("game" === u.wk.currentPage && !u.rS.isBossGame) return r.UK.GameBgm; if ("game" === u.wk.currentPage && u.rS.isBossGame) { if (1 === u.wk.finalBgmState) return r.UK.GameBgmFinalLoop; if (2 === u.wk.finalBgmState) return r.UK.GameBgmFinalAuto; if (3 === u.wk.finalBgmState) return r.UK.GameBgmFinalPart1 } return "home" === u.wk.currentPage && u.rS.isBossLayout ? r.UK.MainBgmFinal : r.UK.MainBgm }), m = (0, a.ref)({}), p = function () { var t = [n(79295), n(86568), n(31853), n(45996), n(99583), n(62672), n(23301), n(318), n(79323), n(36977), n(96325), n(89426), n(10295), n(67551), n(88580), n(24876), n(21707), n(69255), n(5143), n(29262), n(80233), n(74362), n(48781)]; s.value = new Vt.Vd({ cache: !1, preload: !0, loop: !1, autoplay: !1, fade: [0, 0], volume: 1, html5: !1, src: t, onEnd: function (t) { m.value[t] = zt.Init } }), i().prototype.$playEffect = g }, g = function () { var t = Xt(Ut().m(function t(n) { var a, i, r, c; return Ut().w(function (t) { for (; ;)switch (t.n) { case 0: if (a = s.value || {}, i = a.sounds, (r = void 0 === i ? [] : i)[n] && (e.value || o.value)) { t.n = 1; break } return t.a(2); case 1: if (c = m.value[n], ![zt.Init, void 0].includes(c)) { t.n = 3; break } return t.n = 2, (0, x.A6)(10).promise; case 2: return r[n].play(), m.value[n] = zt.Playing, t.a(2); case 3: if (c !== zt.Playing) { t.n = 5; break } return m.value[n] = zt.Stopping, r[n].stop(), t.n = 4, (0, x.A6)(10).promise; case 4: m.value[n] = zt.Playing, r[n].play(); case 5: return t.a(2) } }, t) })); return function (e) { return t.apply(this, arguments) } }(), _ = [n(82247), n(89129), n(47391), n(52362), n(76543), n(35400), n(49519), n(15613), n(92606)], b = function () { d.value = new Vt.Vd({ cache: !1, preload: !0, loop: !1, autoplay: !1, fade: [0, 0], volume: 1, html5: !1, src: _ }) }, h = function () { var t = Xt(Ut().m(function t(n) { return Ut().w(function (t) { for (; ;)switch (t.n) { case 0: if (d.value && (e.value || o.value)) { t.n = 1; break } return t.a(2); case 1: d.value.switchSrcIndex(n), d.value.play(); case 2: return t.a(2) } }, t) })); return function (e) { return t.apply(this, arguments) } }(), y = function () { var t; null === (t = d.value) || void 0 === t || t.unload() }, k = function () { o.value = e.value, c.value.pause() }, w = function () { o.value && c.value.play() }; (0, a.watch)(function () { return u.wk.currentPage }, function (t) { var e = (s.value || {}).sounds, n = void 0 === e ? [] : e; if (0 !== n.length && (n[r.Ie.Landing]._volume = 1, n[r.Ie.SmallWhoosh]._volume = .4, "game" === t)) { var a = u.rS.isBossGame ? 1 : .5; n[r.Ie.NormalSkill]._volume = a } }); var I = function () { var t = (s.value || {}).sounds, e = void 0 === t ? [] : t; 0 !== e.length && (e[r.Ie.Landing]._volume = .4) }; return (0, a.onMounted)(function () { p(), l.$gon("initGalEffect", b), l.$gon("destroyGalEffect", y), l.$gon("playGalEffect", h), l.$gon("blockClick", I), l.$gon("pauseFinalBgm", k), l.$gon("resumeFinalBgm", w) }), (0, a.onBeforeUnmount)(function () { l.$goff("initGalEffect", b), l.$goff("destroyGalEffect", y), l.$goff("playGalEffect", h), l.$goff("blockClick", I), l.$goff("pauseFinalBgm", k), l.$goff("resumeFinalBgm", w) }), { __sfc: !0, isCurPlaying: e, isPrePlaying: o, musicRef: c, vm: l, effectPlayerRef: s, galEffectPlayerRef: d, trackEvent: f, mainAudioIdx: v, EffectPlayState: zt, effectPlayState: m, initEffectPlayer: p, playEffect: g, GAL_EFFECT_LIST: _, initGalEffect: b, playGalEffect: h, destroyGalEffect: y, onBgmPlayed: function (t) { e.value = t }, pauseFinalBgm: k, resumeFinalBgm: w, lowerLandingVolume: I, state: u.wk, MeAudio: Vt.Ay, IS_GAME: r._e } } }), Qt = Jt, Yt = (0, D.A)(Qt, function () { var t = this._self._c, e = this._self._setupProxy; return t(e.MeAudio, { ref: "musicRef", attrs: { src: [n(20091), n(68978), n(69006), n(47824), n(43635), n(45882)], cache: !e.IS_GAME, volume: e.state.mainAudioVolume, index: e.mainAudioIdx, icon: n(95811), activeIcon: n(23241) }, on: { played: e.onBgmPlayed }, nativeOn: { click: function (t) { return function () { return e.trackEvent("button", "click", "music", "") }.apply(null, arguments) } } }) }, [], !1, null, null, null), Zt = Yt.exports, te = n(99836); function ee() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var l = a && a.prototype instanceof c ? a : c, s = Object.create(l.prototype); return ne(s, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), s } var o = {}; function c() { } function l() { } function s() { } e = Object.getPrototypeOf; var u = [][a] ? e(e([][a]())) : (ne(e = {}, a, function () { return this }), e), d = s.prototype = c.prototype = Object.create(u); function f(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, s) : (t.__proto__ = s, ne(t, i, "GeneratorFunction")), t.prototype = Object.create(d), t } return l.prototype = s, ne(d, "constructor", s), ne(s, "constructor", l), l.displayName = "GeneratorFunction", ne(s, i, "GeneratorFunction"), ne(d), ne(d, i, "Generator"), ne(d, a, function () { return this }), ne(d, "toString", function () { return "[object Generator]" }), (ee = function () { return { w: r, m: f } })() } function ne(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } ne = function (t, e, n, a) { function r(e, n) { ne(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, ne(t, e, n, a) } function ae(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } var ie = (0, a.defineComponent)({ __name: "topNav", props: { activeIdolId: null, topNavVisible: { type: Boolean } }, setup: function (t) { var e = t, n = (0, K.pT)(), i = n.onBtnHold, o = n.onBtnRelease, c = n.onBtnPress, l = (0, q.v)().trackEvent, s = (0, U.g)(), d = s.showRuleModal, f = s.showSkillModal, v = s.showCalendarModal, m = s.showSignInModal, p = s.showReviewModal, g = s.showUnlockTimeModal, _ = (0, Y.k)().showPromptModal, b = (0, a.getCurrentInstance)().proxy, h = (0, a.computed)(function () { var t = u.wk.pageInfo.user_activity_info.activity_progress.day; return b.$getI18nWord(6 === t ? "calendar_text_rest" : "calendar_text_default") }), y = function () { var t = u.wk.pageInfo.user_activity_info.activity_progress, e = t.day, n = t.week; 6 !== e ? v({ date: e, week: n, isTransition: !1 }) : g() }, k = (0, a.computed)(function () { return "landing" === u.wk.currentPage }), w = (0, a.computed)(function () { return "home" === u.wk.currentPage }), I = (0, a.computed)(function () { return r.bS || r._e }), C = (0, a.computed)(function () { return 5 !== u.rS.curWeek }), S = function () { var t, e = (t = ee().m(function t() { return ee().w(function (t) { for (; ;)switch (t.n) { case 0: l("button", "click", "close_game", ""), l("popup", "view", "exit", ""), _(b.$getI18nWord("quit_prompt_title"), b.$getI18nWord("quit_prompt_desc")).then(function () { l("popup", "click", "confirm", ""), (0, te.C9)() }).catch(function () { l("popup", "click", "cancel", "") }); case 1: return t.a(2) } }, t) }), function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { ae(r, a, i, o, c, "next", t) } function c(t) { ae(r, a, i, o, c, "throw", t) } o(void 0) }) }); return function () { return e.apply(this, arguments) } }(), T = (0, a.computed)(function () { var t = u.wk.pageInfo.user_activity_info.sign_info.signs; return (void 0 === t ? [] : t).some(function (t) { return t.status === nt.Ol.IN_PROGRESS }) }), $ = (0, a.computed)(function () { var t = u.wk.pageInfo.user_activity_info.occurrence_info.occurrences; return (void 0 === t ? [] : t).some(function (t) { return t.status === nt.OX.IN_PROGRESS && String(t.occurrence_id).startsWith("30") }) }); return i("leftShoulder2", function () { e.topNavVisible && !u.rS.isBossLayout && (0, u.$j)({ isMenuExpanded: !0 }) }), o("leftShoulder2", function () { e.topNavVisible && !u.rS.isBossLayout && (0, u.$j)({ isMenuExpanded: !1 }) }), c("confirm", function () { u.wk.isMenuExpanded && e.topNavVisible && (p(), setTimeout(function () { u.wk.isMenuExpanded = !1 }, 10)) }), c("cancel", function () { if (e.topNavVisible) return u.wk.isMenuExpanded ? (d(), void setTimeout(function () { u.wk.isMenuExpanded = !1 }, 10)) : void (I.value && S()) }, "Escape"), c("button3", function () { u.wk.isMenuExpanded && e.topNavVisible && (m(), setTimeout(function () { u.wk.isMenuExpanded = !1 }, 10)) }), c("button4", function () { u.wk.isMenuExpanded && e.topNavVisible && (f(), setTimeout(function () { u.wk.isMenuExpanded = !1 }, 10)) }), c("start", function () { !u.wk.isMenuExpanded && e.topNavVisible && C.value && (y(), setTimeout(function () { u.wk.isMenuExpanded = !1 }, 10)) }), (0, a.onMounted)(function () { (0, a.nextTick)(function () { var t; null === (t = document.querySelector(".mihoyo-account-role")) || void 0 === t || t.addEventListener("click", function (t) { var e; null !== (e = t.target.classList) && void 0 !== e && e.contains("mihoyo-account-role__login") && l("button", "click", "login", "") }) }) }), { __sfc: !0, onBtnHold: i, onBtnRelease: o, onBtnPress: c, trackEvent: l, showRuleModal: d, showSkillModal: f, showCalendarModal: v, showSignInModal: m, showReviewModal: p, showUnlockTimeModal: g, showPromptModal: _, props: e, vm: b, calendarBtnText: h, onSignBtnClick: function () { l("button", "click", "attendance", ""), m() }, onCalendarBtnClick: y, accountRoleVisible: k, isHome: w, onLogin: function (t) { var e = t.isLogin; (0, u.$j)({ isLogin: e }), l("State", e ? "playerLogin" : "playerLogout", "", ""), e || ((0, u.$j)({ pageInfo: {} }), b.$mia.userExtrainfo.login_type = r.Gb.notLogin) }, onRole: function (t) { var e = t.roleInfo, n = t.type; (0, u.$j)({ roleInfo: e, loginType: n }), (0, u.$j)({ pageInfo: {} }), e.game_uid && ((0, u.cv)().then(function () { b.$gemit("updatePageInfo") }), b.$mia.userExtrainfo.login_type = r.Gb[n]) }, onInit: function () { u.wk.roleInfo.game_uid || x.QS.authkey || !r._e || b.$mtoast(b.$getI18nWord("ingame_not_login")) }, closeBtnVisible: I, calendarBrnVisible: C, onCloseBtnClick: S, signBtnRd: T, reviewBtnRd: $, state: u.wk, getters: u.rS, LangSelect: Ht.A, BgAudio: Zt } } }), re = ie, oe = (0, D.A)(re, function () { var t = this, e = t._self._c, a = t._self._setupProxy; return e("div", { staticClass: "top-nav title-font" }, [e("div", { staticClass: "top-nav__left" }, [a.closeBtnVisible ? e("div", { staticClass: "close-btn", on: { click: a.onCloseBtnClick } }, [a.state.enableGamepad ? e("img", { directives: [{ name: "show", rawName: "v-show", value: !a.state.isMenuExpanded, expression: "!state.isMenuExpanded" }], staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.cancel, alt: "" } }) : t._e()]) : t._e(), t._v(" "), e("account-role", { directives: [{ name: "show", rawName: "v-show", value: a.accountRoleVisible, expression: "accountRoleVisible" }], key: "account-role", staticClass: "account-info system-font", on: { login: a.onLogin, role: a.onRole, init: a.onInit, initError: a.onInit } }), t._v(" "), a.isHome && !a.getters.isBossLayout && a.calendarBrnVisible ? e("div", { staticClass: "calendar-btn title-font", on: { click: a.onCalendarBtnClick } }, [e("span", { staticClass: "calendar-btn-text" }, [t._v(t._s(a.calendarBtnText))]), t._v(" "), "es-es" !== t.$getLang() ? e("span", { staticClass: "calendar-btn-day num-font" }, [t._v(t._s(t.$getI18nWord({ key: "calendar_btn_val", data: { n: a.getters.curDate } })))]) : t._e(), t._v(" "), a.state.enableGamepad ? e("img", { directives: [{ name: "show", rawName: "v-show", value: !a.state.isMenuExpanded, expression: "!state.isMenuExpanded" }], staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.start, alt: "" } }) : t._e()]) : t._e()], 1), t._v(" "), a.isHome && !a.getters.isBossLayout ? e("div", { staticClass: "top-nav__right top-nav__right-home" }, [a.state.enableGamepad ? e("img", { staticClass: "gamepad-icon expand-menu-icon", attrs: { src: t.$meGamepad.btnIconMap.leftShoulder2 } }) : t._e(), t._v(" "), e("hover-btn", { directives: [{ name: "show", rawName: "v-show", value: a.isHome, expression: "isHome" }], staticClass: "header-btn", class: { "header-btn__rd": a.signBtnRd }, attrs: { img: n(63176), "img-hover": n(95633) }, on: { click: a.onSignBtnClick } }, [e("span", { staticClass: "header-btn-text", attrs: { "data-text": t.$getI18nWord("nav_btn_sign") } }, [t._v(t._s(t.$getI18nWord("nav_btn_sign")) + "\n      "), a.state.enableGamepad && a.state.isMenuExpanded ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.button3 } }) : t._e()])]), t._v(" "), e("hover-btn", { staticClass: "header-btn", attrs: { img: n(27556), "img-hover": n(52525) }, on: { click: a.showSkillModal } }, [e("span", { staticClass: "header-btn-text", attrs: { "data-text": t.$getI18nWord("nav_btn_skill") } }, [t._v(t._s(t.$getI18nWord("nav_btn_skill")) + "\n      "), a.state.enableGamepad && a.state.isMenuExpanded ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.button4 } }) : t._e()])]), t._v(" "), e("hover-btn", { staticClass: "header-btn", class: { "header-btn__rd": a.reviewBtnRd }, attrs: { img: n(73575), "img-hover": n(25868) }, on: { click: a.showReviewModal } }, [e("span", { staticClass: "header-btn-text", attrs: { "data-text": t.$getI18nWord("nav_btn_review") } }, [t._v(t._s(t.$getI18nWord("nav_btn_review")) + "\n      "), a.state.enableGamepad && a.state.isMenuExpanded ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.confirm } }) : t._e()])]), t._v(" "), e("hover-btn", { staticClass: "header-btn", attrs: { img: n(72249), "img-hover": n(98950) }, on: { click: function (t) { return a.showRuleModal() } } }, [e("span", { staticClass: "header-btn-text", attrs: { "data-text": t.$getI18nWord("nav_btn_rule") } }, [t._v(t._s(t.$getI18nWord("nav_btn_rule")) + "\n      "), a.state.enableGamepad && a.state.isMenuExpanded ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.cancel } }) : t._e()])])], 1) : t._e(), t._v(" "), e("div", { directives: [{ name: "show", rawName: "v-show", value: "landing" === a.state.currentPage, expression: "state.currentPage === 'landing'" }], staticClass: "top-nav__right top-nav__right-landing" }, [e(a.LangSelect, { key: "lang-btn", staticClass: "lang-btn header-btn system-font", attrs: { icon: n(83523), lang: t.$getLang(), theme: "dark", biz: "nap_global" } }), t._v(" "), e("div", { staticClass: "header-btn survey-btn", on: { click: function (t) { return a.showRuleModal() } } }), t._v(" "), e("div", { staticClass: "bgm-btn header-btn" }, [e(a.BgAudio)], 1)], 1)]) }, [], !1, null, "198a0a9e", null).exports; function ce(t) { return ce = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, ce(t) } var le = (0, a.defineComponent)({ __name: "idolGrowth", props: ["activeIdolId"], emits: ["selectedIdol", "confirmFriendship", "back"], setup: function (t, e) { var n = e.emit, i = t, o = (0, K.pT)(), c = o.onBtnPress, l = o.onDirection, s = (0, Y.k)().showPromptModal, d = (0, U.g)().showRuleModal, f = (0, q.v)().trackEvent, v = (0, a.getCurrentInstance)().proxy, m = (0, a.ref)(u.rS.curGuideStep >= 5), p = [2, 1, 3], g = (0, a.ref)(p.map(function (t) { return { friendship: u.wk.pageInfo.user_activity_info.friend_ship_level["level_".concat(t)] || 0, id: t } })), _ = (0, a.computed)(function () { return g.value.find(function (t) { return t.id === i.activeIdolId }) }), b = function (t) { v.$playEffect(r.Ie.Common_Click), n("selectedIdol", t) }, h = (0, a.computed)(function () { var t = []; if (!_.value) return t; var e = _.value.friendship + 1; if (e <= 6) { var n = [1, 3, 6].includes(e) ? "growth_label_event_now" : "growth_label_event_next", a = [1, 3, 6].find(function (t) { return t > e }); t.push({ type: "event", msg: v.$getI18nWord({ key: n, data: { level: a } }) }) } var i = v.$getI18nWord("growth_label_help"), r = v.$getI18nWord("growth_state_help"); return t.push({ type: "help", msg: "".concat(i, '&nbsp;<span style="color:#f7e388;">').concat(r, "</span>") }), t }), y = (0, a.computed)(function () { return _.value.friendship >= 6 }), k = (0, a.computed)(function () { return g.value.every(function (t) { return t.friendship >= 6 }) }), w = (0, a.computed)(function () { if (!_.value) return ""; var t = v.$getI18nWord("idol_name_".concat(_.value.id)); return v.$getI18nWord({ key: "idol_growth_label", data: { name: t } }) }), I = function () { m.value && (v.$playEffect(r.Ie.Common_Click), n("back")) }, C = function () { v.$playEffect(r.Ie.Common_Click), d("2_2", !1) }, S = Ot()(function () { v.$playEffect(r.Ie.Common_Click), f("session", "visit", "train_cha", _.value.id), !y.value || k.value ? n("confirmFriendship", _.value.id) : s(v.$getI18nWord("idol_max_title"), v.$getI18nWord("idol_max_desc"), !1) }, 500, { leading: !0, trailing: !1 }); return l(function (t) { var e = t.direction; if (["left", "right"].includes(e)) { var n = "left" === e ? -1 : 1, a = p.indexOf(i.activeIdolId), r = Math.min(Math.max(0, a + n), 2), o = p[r]; o !== i.activeIdolId && b(o) } }), c("start", function () { C() }), c("confirm", function () { S() }), c("cancel", function () { I() }, "Escape"), (0, a.onMounted)(function () { f("session", "visit", "choose_train", "") }), { __sfc: !0, onBtnPress: c, onDirection: l, showPromptModal: s, showRuleModal: d, trackEvent: f, vm: v, emits: n, props: i, enableBack: m, idolOrder: p, idolList: g, curActiveIdol: _, selectedIdol: b, formatLevel: function (t) { return (0, x.G0)(t) }, upgradeEventInfo: h, isFriendshipMax: y, isAllMax: k, idolGrowthLabel: w, handleBack: I, openRule: C, onConfirmBtnClick: S, state: u.wk, getLevelText: te.WG } } }), se = (0, D.A)(le, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { staticClass: "idol-growth title-font" }, [e("div", { staticClass: "idol-growth-top", style: { width: "".concat(t.$frame.layoutStateRem.width, "rem") } }, [t._l(n.idolList, function (a, i) { return [e("div", { key: "idol-grid-".concat(i), staticClass: "idol-grid", class: (r = { "idol-grid__active": n.props.activeIdolId === a.id }, o = "idol-grid-".concat(a.id), c = !0, (o = function (t) { var e = function (t) { if ("object" != ce(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var n = e.call(t, "string"); if ("object" != ce(n)) return n; throw new TypeError("@@toPrimitive must return a primitive value.") } return String(t) }(t); return "symbol" == ce(e) ? e : e + "" }(o)) in r ? Object.defineProperty(r, o, { value: c, enumerable: !0, configurable: !0, writable: !0 }) : r[o] = c, r), on: { click: function (t) { return n.selectedIdol(a.id) } } }, [e("div", { staticClass: "idol-friendship-info" }, [e("div", { staticClass: "idol-friendship-info-level" }, [t._v(t._s(n.getLevelText(a.friendship)))]), t._v(" "), e("div", { staticClass: "idol-friendship-info-value" }, [e("span", { domProps: { innerHTML: t._s(n.idolGrowthLabel) } }), t._v(" "), e("div", { staticClass: "rule-btn", on: { click: function (t) { return t.stopPropagation(), n.openRule.apply(null, arguments) } } }, [n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.start, alt: "" } }) : t._e()])])])]), t._v(" "), i < 2 ? e("div", { key: "split-line-".concat(i), staticClass: "split-line" }) : t._e()]; var r, o, c })], 2), t._v(" "), -1 !== n.props.activeIdolId ? e("div", { staticClass: "idol-growth-btm" }, [e("div", { staticClass: "idol-growth-preview" }, [e("div", { staticClass: "idol-growth-preview-title" }, [t._v(t._s(t.$getI18nWord("idol_growth_title")))]), t._v(" "), e("div", { staticClass: "idol-growth-preview-content" }, [n.isFriendshipMax ? e("div", { staticClass: "level-preview-max" }, [t._v("MAX")]) : e("div", { staticClass: "level-preview num-font" }, [e("span", { staticClass: "level-preview-current" }, [t._v(t._s(n.formatLevel(n.curActiveIdol.friendship)))]), t._v(" "), e("i", { staticClass: "level-preview-arrow" }), t._v(" "), e("span", { staticClass: "level-preview-next" }, [t._v(t._s(n.formatLevel(n.curActiveIdol.friendship + 1)))])]), t._v(" "), !n.isFriendshipMax || n.isAllMax ? e("div", { staticClass: "growth-preview-detail" }, t._l(n.upgradeEventInfo, function (n, a) { return e("div", { key: a, staticClass: "growth-preview-item", class: "growth-preview-item__".concat(n.type) }, [e("i", { staticClass: "growth-preview-item-icon", class: "growth-preview-item-icon__".concat(n.type), attrs: { "data-id": n.id } }), t._v(" "), e("div", { staticClass: "growth-preview-item-desc", domProps: { innerHTML: t._s(n.msg) } })]) }), 0) : t._e()])]), t._v(" "), e("div", { staticClass: "confirm-btn", class: { "confirm-btn__disabled": n.isFriendshipMax && !n.isAllMax }, on: { click: n.onConfirmBtnClick } }, [n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.confirm } }) : e("div", { staticClass: "btn-deco" }), t._v(" "), e("span", { attrs: { "data-text": t.$getI18nWord("idol_growth_confirm_btn") } }, [t._v(t._s(t.$getI18nWord("idol_growth_confirm_btn")))])])]) : t._e(), t._v(" "), n.enableBack ? e("div", { staticClass: "back-btn", on: { click: n.handleBack } }, [n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.cancel, alt: "" } }) : t._e()]) : t._e()]) }, [], !1, null, "23654b22", null), ue = se.exports, de = (0, a.defineComponent)({ __name: "training", emits: ["confirmAbility", "back"], setup: function (t, e) { var n = e.emit, i = (0, Y.k)().showPromptModal, c = (0, U.g)().showRuleModal, l = (0, q.v)().trackEvent, s = (0, a.getCurrentInstance)().proxy, d = (0, a.ref)(u.rS.curGuideStep >= 5), f = function (t) { return u.wk.pageInfo.user_activity_info.skill_info[(0, te.iT)(t)] }, v = (0, a.ref)(0), m = (0, a.computed)(function () { return f(v.value + 1) }), p = (0, a.computed)(function () { return (0, te.n0)(m.value, v.value, !0) }), g = function (t) { var e = 0 === f(t), n = u.wk.roleInfo, a = n.game_uid, i = n.region, r = "ability_view_".concat(a, "_").concat(i, "_").concat(t), o = x.IG.get(r); return !e && !o }, _ = (0, a.ref)({ 3: g(3), 4: g(4) }), b = Ot()(function () { s.$playEffect(r.Ie.Common_Click), l("button", "click", "arrange", v.value + 1), n("confirmAbility", v.value + 1) }, 500, { leading: !0, trailing: !1 }), h = function (t) { s.$playEffect(r.Ie.Common_Click); var e = +t + 1; if (l("button", "click", "task", e), 0 !== f(e)) { if (v.value = t, _.value[e]) { _.value[e] = !1; var n = u.wk.roleInfo, a = n.game_uid, o = n.region, c = "ability_view_".concat(a, "_").concat(o, "_").concat(e); x.IG.set(c, !0) } } else i(s.$getI18nWord("ability_locked_title"), s.$getI18nWord({ key: "ability_locked_desc", data: { n: r.hF[e] } }), !1) }, y = function () { d.value && (s.$playEffect(r.Ie.Common_Click), n("back")) }, k = (0, K.pT)(), w = k.onDirection, I = k.onBtnPress, C = function () { l("button", "click", "question", ""), c("2_1", !1) }; return I("start", function () { C() }), I("cancel", function () { y() }, "Escape"), w(function (t) { var e = t.direction; if (["left", "right"].includes(e)) { var n = v.value + ("left" === e ? -1 : 1); if (n < 0 || n > 3) return; h(n) } }), I("confirm", function () { b() }), (0, a.onMounted)(function () { l("session", "visit", "train", "") }), { __sfc: !0, showPromptModal: i, showRuleModal: c, trackEvent: l, vm: s, emits: n, enableBack: d, getAbilityLevel: f, activeIdx: v, activeAbilityLevel: m, baseAbilityDesc: p, getAbilityState: function (t) { var e = 1 === t ? o.sb : o.zV; return m.value + 1 === e ? "next" : m.value >= e ? "unlock" : "locked" }, getIsNewAbility: g, abilityRd: _, onConfirmBtnClick: b, onAbilityClick: h, handleBack: y, onDirection: w, onBtnPress: I, onRuleBtnClick: C, getLevelText: te.WG, state: u.wk, EXTRA_BONUS_LEVEL_1: o.sb, EXTRA_BONUS_LEVEL_2: o.zV } } }), fe = (0, D.A)(de, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { staticClass: "training title-font" }, [e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("training_training_panel.png"), expression: "$getLocalImg('training_training_panel.png')", modifiers: { bg: !0 } }], staticClass: "training-panel" }, [e("img", { staticClass: "training-panel-title", attrs: { src: t.$getI18nWord("training_title") } }), t._v(" "), e("div", { staticClass: "rule-btn", on: { click: function (t) { return t.stopPropagation(), n.onRuleBtnClick.apply(null, arguments) } } }, [n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.start } }) : t._e()]), t._v(" "), e("div", { staticClass: "ability-list" }, t._l(4, function (a) { return e("div", { key: a, staticClass: "ability-item", class: ["ability-item__".concat(a), { "ability-item__active": n.activeIdx === a - 1, "ability-item__focused": n.state.enableGamepad && n.activeIdx === a - 1, "ability-item__locked": 0 === n.getAbilityLevel(a), "ability-item__new": n.abilityRd[a] }], on: { click: function (t) { return n.onAbilityClick(a - 1) } } }, [n.getAbilityLevel(a) > 0 ? [t._m(0, !0), t._v(" "), e("div", { staticClass: "ability-item-name" }, [t._v(t._s(t.$getI18nWord("ability_name_".concat(a))))]), t._v(" "), e("div", { staticClass: "ability-item-level", class: { "ability-item-level__highlight": n.getAbilityLevel(a) >= 6 } }, [t._v(t._s(n.getLevelText(n.getAbilityLevel(a))))])] : [t._m(1, !0), t._v(" "), e("div", { staticClass: "ability-item-name" }, [t._v(t._s(t.$getI18nWord("ability_locked")))])]], 2) }), 0), t._v(" "), e("div", { staticClass: "ability-detail" }, [e("div", { staticClass: "ability-level-preview", style: { backgroundImage: "url(".concat(t.$getI18nWord("training_level_bg"), ")") } }, [e("span", { staticClass: "ability-level-preview-label" }, [t._v(t._s(t.$getI18nWord("training_level_label")))]), t._v(" "), e("span", { staticClass: "ability-level-cur-value" }, [t._v(t._s(n.getLevelText(n.activeAbilityLevel)))]), t._v(" "), e("i"), t._v(" "), e("span", { staticClass: "ability-level-next-value" }, [t._v(t._s(n.getLevelText(n.activeAbilityLevel + 1)))])]), t._v(" "), e("div", { staticClass: "ability-base-preview" }, [e("img", { staticClass: "ability-desc-title", attrs: { src: t.$getI18nWord("training_base_label"), alt: "" } }), t._v(" "), e("p", { domProps: { innerHTML: t._s(t.$getI18nWord(n.baseAbilityDesc)) } })]), t._v(" "), e("div", { staticClass: "ability-extra-preview" }, [e("img", { staticClass: "ability-desc-title", attrs: { src: t.$getI18nWord("training_extra_label"), alt: "" } }), t._v(" "), t._l(2, function (a) { return e("div", { key: a, staticClass: "skill-extra-info", class: "skill-extra-info__".concat(n.getAbilityState(a)) }, [e("div", { staticClass: "level-label" }, [t._v(t._s(n.getLevelText(1 === a ? n.EXTRA_BONUS_LEVEL_1 : n.EXTRA_BONUS_LEVEL_2)))]), t._v(" "), e("p", { staticClass: "skill-extra-info-desc", domProps: { innerHTML: t._s(t.$getI18nWord("ability_".concat(n.activeIdx + 1, "_extra_buff_").concat(a))) } }), t._v(" "), 1 === a ? e("div", { staticClass: "split-line" }) : t._e()]) })], 2)]), t._v(" "), e("div", { staticClass: "confirm-btn", on: { click: n.onConfirmBtnClick } }, [n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.confirm } }) : e("div", { staticClass: "btn-deco" }), t._v(" "), e("span", { attrs: { "data-text": t.$getI18nWord("confirm_upgrade_btn") } }, [t._v(t._s(t.$getI18nWord("confirm_upgrade_btn")))])])]), t._v(" "), n.enableBack ? e("div", { staticClass: "back-btn", on: { click: n.handleBack } }, [n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.cancel, alt: "" } }) : t._e()]) : t._e()]) }, [function () { var t = this, e = t._self._c; return t._self._setupProxy, e("div", { staticClass: "ability-item-icon-container" }, [e("div", { staticClass: "ability-item-icon ability-item-icon__default" }), t._v(" "), e("div", { staticClass: "ability-item-icon ability-item-icon__active" })]) }, function () { var t = this._self._c; return this._self._setupProxy, t("div", { staticClass: "ability-item-icon-container" }, [t("div", { staticClass: "ability-item-icon ability-item-icon__locked" })]) }], !1, null, "f513e788", null), ve = fe.exports, me = (0, a.defineComponent)({ __name: "gameResModal", props: { score: null, target: null, highest: null, isNew: { type: Boolean } }, emits: ["confirm"], setup: function (t, e) { var n = e.emit, i = t, o = (0, q.v)().trackEvent, c = (0, K.pT)(!0).onBtnPress, l = (0, a.getCurrentInstance)().proxy, s = (0, a.computed)(function () { return i.score.toString().split("") }), d = (0, a.computed)(function () { return i.score >= i.target }), f = function () { l.$playEffect(r.Ie.Common_Click_2), o("session", "visit", "next_game1", ""), n("confirm") }; return c("confirm", function () { f() }), c("cancel", function () { f() }, "Escape"), (0, a.onMounted)(function () { o("session", "visit", "score", "") }), { __sfc: !0, trackEvent: o, onBtnPress: c, vm: l, props: i, emits: n, scoreList: s, hasAchievedTarget: d, handleConfirm: f, state: u.wk } } }), pe = (0, D.A)(me, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_gameRes_modal_bg.png"), expression: "$getLocalImg('modal_gameRes_modal_bg.png')", modifiers: { bg: !0 } }], staticClass: "game-res-modal title-font" }, [e("div", { staticClass: "game-res-modal-title" }, [t._v(t._s(t.$getI18nWord("game_res_title")))]), t._v(" "), e("div", { staticClass: "game-res-modal-score" }, t._l(n.scoreList, function (n, a) { return e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_gameRes_num_".concat(n, ".png")), expression: "$getLocalImg(`modal_gameRes_num_${num}.png`)", modifiers: { bg: !0 } }], key: a, staticClass: "score-num", class: "score-num__".concat(n) }) }), 0), t._v(" "), e("div", { staticClass: "game-res-modal-highest" }, [e("span", { staticClass: "line-label" }, [t._v(t._s(t.$getI18nWord("label_highest_score")))]), t._v(" "), e("span", { staticClass: "line-value" }, [t._v(t._s(n.props.highest))]), t._v(" "), n.props.isNew ? e("div", { staticClass: "new-label num-font" }, [t._v("NEW!!")]) : t._e()]), t._v(" "), n.props.target ? e("div", { staticClass: "game-res-modal-target", class: { "game-res-modal-target__achieved": n.hasAchievedTarget } }, [e("span", { staticClass: "line-label" }, [t._v(t._s(t.$getI18nWord("label_target_score")))]), t._v(" "), e("span", { staticClass: "line-value" }, [t._v(t._s(n.props.target))]), t._v(" "), e("div", { staticClass: "achieved-label" })]) : e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_gameRes_non_target_bg.png"), expression: "$getLocalImg('modal_gameRes_non_target_bg.png')", modifiers: { bg: !0 } }], staticClass: "game-res-modal-non-target" }), t._v(" "), e("div", { staticClass: "game-res-modal-confirm-btn", on: { click: n.handleConfirm } }, [n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.confirm } }) : t._e(), t._v(" "), e("span", { attrs: { "data-text": t.$getI18nWord("game_res_next_btn") } }, [t._v(t._s(t.$getI18nWord("game_res_next_btn")))])])]) }, [], !1, null, "4d6320ee", null).exports; function ge(t) { return function (t) { if (Array.isArray(t)) return _e(t) }(t) || function (t) { if ("undefined" != typeof Symbol && null != t[Symbol.iterator] || null != t["@@iterator"]) return Array.from(t) }(t) || function (t, e) { if (t) { if ("string" == typeof t) return _e(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? _e(t, e) : void 0 } }(t) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }() } function _e(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, a = Array(e); n < e; n++)a[n] = t[n]; return a } var be = (0, a.defineComponent)({ __name: "trainingResModal", props: { idolId: null, prevIdolFriendship: null, abilityId: null, curDay: null }, emits: ["confirm"], setup: function (t, e) { var n, i = e.emit, c = t, l = (0, q.v)().trackEvent, s = (0, K.pT)(!0).onBtnPress, d = (0, a.ref)(c.prevIdolFriendship), f = (0, a.getCurrentInstance)().proxy, v = (0, a.ref)(ge(new Array(4)).map(function (t, e) { var n = e + 1 === c.abilityId, a = u.wk.pageInfo.user_activity_info.skill_info[(0, te.iT)(e + 1)]; return { isUpgrade: n, level: a - (n ? 1 : 0), unlock: a > 0 } })), m = (0, a.ref)(f.$getI18nWord({ key: "training_res_modal_title", data: { n: c.curDay } })), p = function () { l("button", "click", "next_game2", ""), i("confirm") }, g = (0, a.ref)((n = d.value + 1, [1, 3, 6].includes(n))), _ = (0, a.ref)(d.value >= 6), b = (0, a.computed)(function () { return f.$getI18nWord("training_result_confirm_btn".concat(5 === c.curDay ? "_game" : "")) }); return s("confirm", function () { f.$playEffect(r.Ie.Common_Click_2), p() }), s("cancel", function () { f.$playEffect(r.Ie.Common_Click_2), p() }, "Escape"), (0, a.onMounted)(function () { l("session", "visit", "result", "") }), { __sfc: !0, trackEvent: l, onBtnPress: s, props: c, friendshipLevel: d, vm: f, emits: i, abilityList: v, getExtraInfo: function (t, e) { var n = [o.sb, o.zV]; return ge(new Array(2)).map(function (a, i) { return +t + (e ? 1 : 0) >= n[i] }) }, modalTitle: m, onConfirmBtnClick: p, hasEvent: g, isCurMax: _, confirmBtnText: b, state: u.wk, getLevelText: te.WG, paddZero: x.G0 } } }), he = (0, D.A)(be, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_trainingRes_modal_bg.png"), expression: "$getLocalImg('modal_trainingRes_modal_bg.png')", modifiers: { bg: !0 } }], staticClass: "training-res-modal title-font" }, [e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_trainingRes_title_bg.png"), expression: "$getLocalImg('modal_trainingRes_title_bg.png')", modifiers: { bg: !0 } }], staticClass: "training-res-modal-title" }, [t._v(t._s(n.modalTitle))]), t._v(" "), e("div", { staticClass: "training-res-modal-content" }, [e("div", { staticClass: "content-left" }, [e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_trainingRes_train_res_idol_".concat(n.props.idolId, ".png")), expression: "$getLocalImg(`modal_trainingRes_train_res_idol_${props.idolId}.png`)", modifiers: { bg: !0 } }], staticClass: "vision-port", class: "vision-port__".concat(n.props.idolId) }), t._v(" "), e("div", { staticClass: "training-result" }, [e("div", { staticClass: "training-result__level" }, [e("p", { staticClass: "training-result-label" }, [t._v(t._s(t.$getI18nWord("training_friendship_title")))]), t._v(" "), n.isCurMax ? e("div", { staticClass: "training-result-value" }, [t._v("MAX")]) : e("div", { staticClass: "training-result-value num-font" }, [e("span", [t._v(t._s(n.paddZero(n.friendshipLevel)))]), t._v(" "), e("i"), t._v(" "), e("span", { staticClass: "training-result-value-next" }, [t._v(t._s(n.paddZero(n.friendshipLevel + 1)))])])]), t._v(" "), n.hasEvent ? e("div", { staticClass: "training-result__event" }, [e("p", { staticClass: "training-result-label" }, [t._v(t._s(t.$getI18nWord("training_event_title")))]), t._v(" "), e("div", { staticClass: "icon-event" })]) : t._e()])]), t._v(" "), e("div", { staticClass: "content-right" }, t._l(n.abilityList, function (a, i) { return e("div", { key: i, staticClass: "ability-item", class: { "ability-item__unlock": a.unlock } }, [e("div", { staticClass: "ability-item-icon" }), t._v(" "), e("div", { staticClass: "ability-item-desc" }, [a.unlock ? [e("p", { staticClass: "ability-name" }, [t._v(t._s(t.$getI18nWord("ability_name_".concat(i + 1))))]), t._v(" "), e("div", { staticClass: "ability-level" }, [e("span", { staticClass: "ability-level-prev" }, [t._v(t._s(n.getLevelText(a.level)))]), t._v(" "), a.isUpgrade ? [e("i"), t._v(" "), e("span", { staticClass: "ability-level-next" }, [t._v(t._s(n.getLevelText(a.level + 1)))])] : t._e(), t._v(" "), e("div", { staticClass: "extra-info" }, t._l(n.getExtraInfo(a.level, a.isUpgrade), function (t, n) { return e("div", { key: n, staticClass: "extra-skill-item", class: { "extra-skill-item__unlock": t } }) }), 0)], 2)] : e("p", { staticClass: "ability-unlock" }, [t._v(t._s(t.$getI18nWord("ability_locked")))])], 2)]) }), 0)]), t._v(" "), e("div", { staticClass: "confirm-btn", attrs: { "data-text": n.confirmBtnText }, on: { click: n.onConfirmBtnClick } }, [e("span", [t._v(t._s(n.confirmBtnText))]), t._v(" "), n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.confirm } }) : t._e()])]) }, [], !1, null, "9e3eec1e", null).exports, ye = n(4654), ke = n(24581); function we() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var l = a && a.prototype instanceof c ? a : c, s = Object.create(l.prototype); return Ie(s, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), s } var o = {}; function c() { } function l() { } function s() { } e = Object.getPrototypeOf; var u = [][a] ? e(e([][a]())) : (Ie(e = {}, a, function () { return this }), e), d = s.prototype = c.prototype = Object.create(u); function f(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, s) : (t.__proto__ = s, Ie(t, i, "GeneratorFunction")), t.prototype = Object.create(d), t } return l.prototype = s, Ie(d, "constructor", s), Ie(s, "constructor", l), l.displayName = "GeneratorFunction", Ie(s, i, "GeneratorFunction"), Ie(d), Ie(d, i, "Generator"), Ie(d, a, function () { return this }), Ie(d, "toString", function () { return "[object Generator]" }), (we = function () { return { w: r, m: f } })() } function Ie(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } Ie = function (t, e, n, a) { function r(e, n) { Ie(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, Ie(t, e, n, a) } function Ce(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } function Se(t) { return function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { Ce(r, a, i, o, c, "next", t) } function c(t) { Ce(r, a, i, o, c, "throw", t) } o(void 0) }) } } var Te = (0, a.defineComponent)({ __name: "index", setup: function (t) { var e = (0, tt.d)(), n = (0, et.bP)(e), i = n.hasAwardGuide, l = n.triggerGuideModal, s = n.skillGuideStep, d = n.curGuideStep, f = (0, a.ref)(""), v = (0, a.ref)(null), m = (0, a.ref)(!1), p = (0, a.getCurrentInstance)().proxy, g = (0, ke.x)().showAwardResModal, _ = (0, U.g)(), b = _.showCalendarModal, h = _.showGal, y = _.showSignInModal, k = _.showSkillModal, w = _.showRuleModal, I = _.showUnlockTimeModal, C = (0, U.m)().showMidTrans, S = (0, ye.Y)().showGuideModal, T = (0, a.ref)(null), $ = (0, a.ref)(null), E = (0, a.ref)(-1), O = (0, a.ref)({ abilityId: 0, idolId: 0 }), P = (0, a.ref)(""), G = (0, a.ref)(null), M = (0, a.ref)(!1), A = (0, a.ref)(!1), B = (0, a.ref)(!1), L = (0, q.v)(), j = L.trackPageView, W = L.trackEvent, N = (0, a.computed)(function () { return P.value ? p.$getI18nWord({ key: "home_target_label", data: { score: P.value } }) : "" }), R = function (t) { E.value = t }, F = (0, a.computed)(function () { return ["loading", "home", "landing"].includes(u.wk.currentPage) && -1 === E.value && !m.value }); (0, a.watch)(function () { var t; return null === (t = p.$meGamepad) || void 0 === t ? void 0 : t.enableGamepad }, function (t) { (0, u.$j)({ enableGamepad: t || !1 }) }, { immediate: !0 }), (0, a.watch)(function () { return E.value }, function (t, e) { if (-1 !== e) { var n = o.aJ[e]; u.wk.idolState[n].selected = !1 } if (-1 !== t) { var a = o.aJ[t]; u.wk.idolState[a].selected = !0 } }); var D = function () { var t = Se(we().m(function t() { var e, n, a, i = arguments; return we().w(function (t) { for (; ;)switch (t.n) { case 0: if (e = i.length > 0 && void 0 !== i[0] && i[0], !u.wk.isFinalAnimating) { t.n = 1; break } return t.a(2); case 1: return n = e || u.rS.isFinalOfWeek || 5 === u.rS.curWeek, u.rS.isBossGame && (p.$gemit("pauseFinalBgm"), (0, u.$j)({ needResumeBgm: !0 })), W("button", "click", "training", n ? 1 : 2), t.n = 2, C(2, function () { s.value && n && (0, u.$j)({ blockAction: s.value }), $.value[n ? "homeToGame" : "homeToTraining"](s.value), (0, u.$j)({ currentPage: n ? "game" : "training" }) }); case 2: s.value && n && (a = +s.value.replace("skill", ""), [1, 2, 3, 4].includes(a) && $.value.triggerGuideEvent("skill"), [2, 3, 4].includes(a) && (T.value = S({ methods: { end: function () { (0, u.$j)({ blockAction: "" }), 4 !== a && p.$gemit("useSkill", a), p.$gemit("pauseGame"), p.$gemit("resumeGame"), T.value.close(), (0, u.s2)(d.value + 1) } }, closeCb: function () { T.value = null } }))); case 3: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), K = function () { var t = Se(we().m(function t(e) { return we().w(function (t) { for (; ;)switch (t.n) { case 0: return O.value.abilityId = e, t.n = 1, C(1, function () { var t = [2, 1, 3].find(function (t) { return u.wk.pageInfo.user_activity_info.friend_ship_level["level_".concat(t)] < 6 }); E.value = t || 2, (0, u.$j)({ currentPage: "growth" }), $.value.trainingToSelect() }); case 1: 3 === d.value && (p.$gemit("updateSubIdx"), T.value.show()); case 2: return t.a(2) } }, t) })); return function (e) { return t.apply(this, arguments) } }(), X = function () { var t = Se(we().m(function t(e) { var n, a, i; return we().w(function (t) { for (; ;)switch (t.n) { case 0: return O.value.idolId = e, n = u.wk.pageInfo.user_activity_info.friend_ship_level["level_".concat(e)], a = u.rS.curDate, t.n = 1, (0, u.mJ)({ idolId: e, abilityId: O.value.abilityId }); case 1: if (3 !== d.value) { t.n = 2; break } return t.n = 2, (0, u.s2)(4); case 2: return m.value = !0, t.n = 3, $.value.selectToRes(); case 3: i = p.$commonModal(he, { bgOpacity: 0, dialogInfo: { idolId: e, curDay: a, prevIdolFriendship: n, abilityId: O.value.abilityId }, methods: { confirm: function () { var t = Se(we().m(function t() { return we().w(function (t) { for (; ;)switch (t.n) { case 0: if (E.value = -1, m.value = !0, O.value = { abilityId: 0, idolId: 0 }, u.rS.isFinalOfWeek) { t.n = 2; break } return setTimeout(function () { i.close(), $.value.trainingToHome() }, 1e3), t.n = 1, b({ date: u.rS.curDate, week: u.rS.curWeek, isTransition: !0 }); case 1: m.value = !1, (0, u.$j)({ currentPage: "home" }), t.n = 4; break; case 2: return t.n = 3, C(2, function () { i.close(), $.value.trainingToHome(), (0, u.$j)({ currentPage: "home" }) }); case 3: m.value = !1; case 4: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }() } }); case 4: return t.a(2) } }, t) })); return function (e) { return t.apply(this, arguments) } }(), z = { home: xt, game: ut, training: ve, growth: ue, landing: gt }; (0, a.watch)(function () { return u.wk.currentPage }, function (t) { window.document.documentElement.setAttribute("page-area", "home" === t ? "home" : "") }, { immediate: !0 }); var J = function () { var t = Se(we().m(function t() { var e, n, a, i, r, o, c, l, s = arguments; return we().w(function (t) { for (; ;)switch (t.n) { case 0: if (e = s.length > 0 && void 0 !== s[0] ? s[0] : function () { }, a = s.length > 2 && void 0 !== s[2] && s[2], i = (n = s.length > 1 && void 0 !== s[1] ? s[1] : {}).idolId || E.value, 0 !== (r = n.chapterId || u.rS.idolEventList[i])) { t.n = 1; break } return t.a(2); case 1: return a || W("button", "click", "favor", i), o = r % 10, (c = 2 === i && 3 === o) && p.$gemit("pauseFinalBgm"), t.n = 2, h("role_".concat(i, "_train"), o, { methods: { end: function () { var t = Se(we().m(function t() { return we().w(function (t) { for (; ;)switch (t.n) { case 0: return t.n = 1, (0, u.lr)(r); case 1: e(), c && p.$gemit("resumeFinalBgm"), m.value = !1, $.value.setTalkVisible(!1), l.close(); case 2: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }() }, transition: function () { var t = Se(we().m(function t() { return we().w(function (t) { for (; ;)switch (t.n) { case 0: return t.n = 1, C(3, function () { m.value = !0, E.value = -1, $.value.setTalkVisible(!0) }, { textId: "".concat(i, "_").concat(o) }); case 1: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }() }); case 2: l = t.v; case 3: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), Q = function () { var t = Se(we().m(function t(e) { var n, a, i = arguments; return we().w(function (t) { for (; ;)if (0 === t.n) return n = i.length > 1 && void 0 !== i[1] ? i[1] : u.rS.curWeek, a = i.length > 2 && void 0 !== i[2] && i[2], t.a(2, new Promise(function () { var t = Se(we().m(function t(i) { var o, c, l; return we().w(function (t) { for (; ;)switch (t.n) { case 0: return o = !1, c = function (t) { o || 5 !== n || 1 !== e || 10 !== t || a || (o = !0, p.$gemit("pauseFinalBgm")) }, t.n = 1, h("main_day_".concat(n), e, { methods: { script: function (t) { 4 === n && 3 === e && 26 === t.index && p.$gemit("pauseFinalBgm"), 4 === n && 3 === e && 27 === t.index && (p.$playEffect(r.Ie.GlitchWhoosh), $.value.setHomeGlitch(!0), setTimeout(function () { p.$gemit("resumeFinalBgm"), (0, u.$j)({ mainAudioVolume: .4, forceBgm: r.UK.MainBgmFinal }) }, 200)), 4 === n && 3 === e && 30 === t.index && $.value.setHomeGlitch(!1), c(t.index) }, end: function () { m.value = !1, c(10), 4 === n && 3 === e && ($.value.setHomeGlitch(!1), p.$gemit("resumeFinalBgm"), (0, u.$j)({ mainAudioVolume: 1, forceBgm: 0 })), $.value.setTalkVisible(!1), l.close(), i() } }, cancelFunc: function () { a || (0, te.WE)() }, transition: function () { var t = Se(we().m(function t() { return we().w(function (t) { for (; ;)switch (t.n) { case 0: if (a) { t.n = 1; break } m.value = !0, $.value.setTalkVisible(!0), t.n = 2; break; case 1: return t.n = 2, C(2, function () { m.value = !0, $.value.setTalkVisible(!0) }); case 2: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }() }); case 1: l = t.v; case 2: return t.a(2) } }, t) })); return function (e) { return t.apply(this, arguments) } }())) }, t) })); return function (e) { return t.apply(this, arguments) } }(), Y = function () { var t = Se(we().m(function t() { var e, n, a; return we().w(function (t) { for (; ;)switch (t.n) { case 0: if (!([5, 6].includes(u.rS.curDate) || 5 === u.rS.curWeek && (0, u.vI)("mid") === nt.OX.COMPLETED) || (0, u.vI)("ending") !== nt.OX.IN_PROGRESS) { t.n = 5; break } return t.n = 1, Q(r.Vs.ending); case 1: return t.n = 2, (0, u.Om)("ending"); case 2: if (e = t.v, 5 === u.rS.curWeek && $.value.toNormalHome(), !u.wk.isNextWeekUnlocked) { t.n = 4; break } return n = e.week, a = e.day, t.n = 3, b({ week: n, date: a, isTransition: !0 }); case 3: u.wk.isNextWeekUnlocked = !1, u.wk.pageInfo.user_activity_info.activity_progress = e; case 4: return t.a(2, !0); case 5: return t.a(2, !1) } }, t) })); return function () { return t.apply(this, arguments) } }(), Z = function () { var t = Se(we().m(function t(e) { var n, a, i, r, o, c, l; return we().w(function (t) { for (; ;)switch (t.n) { case 0: if (u.rS.isBossGame) { t.n = 2; break } return m.value = !0, n = e > u.rS.highestScore, a = u.wk.pageInfo.act_show_info.unlock_week, i = u.rS.curWeek, r = !u.wk.pageInfo.user_activity_info.activity_progress.week_challenge_finished[i], t.n = 1, (0, u.dA)(e); case 1: return o = t.v, c = o[i], A.value = r && c && a - 1 === i, l = p.$commonModal(pe, { dialogInfo: { score: e, target: u.rS.weeklyTarget, highest: +u.rS.highestScore, isNew: n }, methods: { confirm: function () { var t = Se(we().m(function t() { return we().w(function (t) { for (; ;)switch (t.n) { case 0: return m.value = !1, l.close(), t.n = 1, rt(); case 1: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }() }, bgOpacity: 0 }), t.a(2); case 2: at(); case 3: return t.a(2) } }, t) })); return function (e) { return t.apply(this, arguments) } }(), at = function () { var t = Se(we().m(function t() { return we().w(function (t) { for (; ;)switch (t.n) { case 0: if (!m.value) { t.n = 1; break } return t.a(2); case 1: return p.$gemit("toFinal"), m.value = !0, A.value = (0, u.vI)("mid") === nt.OX.IN_PROGRESS, t.n = 2, (0, x.A6)(500).promise; case 2: return (0, u.$j)({ finalModalVisible: !0 }), t.n = 3, h("main_day_5", 2, { cancelFunc: function () { (0, te.WE)() }, methods: { confirm: it, script: function (t) { var e = t.index; r.PE.includes(e) && p.$gemit("toFinal") }, qteTriggered: function (t) { "qte1" === t && ((0, u.$j)({ mainAudioVolume: .4 }), lt(), p.$gemit("toFinal"), f.value = "qte1"), "qte2" === t && setTimeout(function () { lt(), f.value = "qte2" }, 1500) }, end: function () { var t = Se(we().m(function t() { return we().w(function (t) { for (; ;)switch (t.n) { case 0: return t.n = 1, (0, u.Om)("mid"); case 1: return t.n = 2, (0, x.A6)(200).promise; case 2: return v.value.close(), v.value = null, m.value = !0, $.value.setTalkVisible(!1), t.n = 3, C(u.wk.reviewFinal ? 2 : 4, function () { $.value.gameToHome(), (0, u.$j)({ currentPage: "home" }) }, { text: p.$getI18nWord("final_trans_txt") }); case 3: p.$gemit("resumeFinalBgm"), u.wk.reviewFinal && (m.value = !1, (0, u.$j)({ reviewFinal: !1 })); case 4: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }() }, outerOpts: { closeCb: function () { (0, u.$j)({ finalModalVisible: !1 }) } } }); case 3: v.value = t.v; case 4: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), it = function () { f.value && (p.$gemit("toFinal"), (0, u.$j)({ mainAudioVolume: 1 }), p.$playEffect(r.Ie.NormalSkill), "qte1" === f.value && (setTimeout(function () { $.value.resetGame() }, 1300), setTimeout(function () { p.$gemit("onQteClick", "qte1"), v.value.show(), (0, u.$j)({ finalModalVisible: !0 }), p.$gemit("toFinal") }, 1500)), f.value = "") }, rt = function () { var t = Se(we().m(function t() { return we().w(function (t) { for (; ;)switch (t.n) { case 0: if (!m.value) { t.n = 1; break } return t.a(2); case 1: return m.value = !0, t.n = 2, C(2, function () { $.value.gameToHome() }); case 2: (0, u.$j)({ currentPage: "home" }), m.value = !1; case 3: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), ot = function () { var t = Se(we().m(function t() { var e; return we().w(function (t) { for (; ;)switch (t.n) { case 0: if ("home" != (e = r._e ? "home" : "landing") || 0 !== Object.keys(u.wk.pageInfo).length) { t.n = 1; break } return M.value = !0, t.a(2); case 1: return "home" === e && p.$gemit("closeExitPrompt"), m.value = !0, t.n = 2, $.value.loadingToNextScene(e); case 2: (0, u.$j)({ currentPage: e }), m.value = !1; case 3: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(); p.$gon("updatePageInfo", function () { M.value && (ot(), M.value = !1) }); var ct = function () { var t = Se(we().m(function t() { return we().w(function (t) { for (; ;)switch (t.n) { case 0: if (!m.value) { t.n = 1; break } return t.a(2); case 1: return m.value = !0, t.n = 2, C(2, function () { $.value.landingToHome() }); case 2: (0, u.$j)({ currentPage: "home" }), m.value = !1; case 3: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), lt = function () { v.value.hide(), (0, u.$j)({ finalModalVisible: !1 }) }, st = function () { var t = Se(we().m(function t() { var n, a; return we().w(function (t) { for (; ;)switch (t.n) { case 0: if (0 !== d.value) { t.n = 3; break } return t.n = 1, new Promise(function (t) { return C(2, t) }); case 1: return t.n = 2, Q(r.Vs.prev); case 2: return (0, u.s2)(1), st(), t.a(2, !0); case 3: if (!(l.value || i.value || B.value)) { t.n = 4; break } return null === (n = T.value) || void 0 === n || n.close(), a = {}, i.value && (a = { step: 5, initSubStep: 3 }), B.value && (a = { step: 4, initSubStep: 3 }), B.value = !1, T.value = S({ dialogInfo: a, methods: { selectedIdol: function (t) { R(t) }, selectEvent: function () { var t = Se(we().m(function t() { return we().w(function (t) { for (; ;)switch (t.n) { case 0: T.value.close(), B.value = !0, J(function () { st(), (0, u.s2)(5) }); case 1: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), enterGame: function () { var t = Se(we().m(function t() { var e, n = arguments; return we().w(function (t) { for (; ;)switch (t.n) { case 0: if (e = !(n.length > 0 && void 0 !== n[0]) || n[0], T.value.hide(), !e) { t.n = 2; break } return t.n = 1, D(!0); case 1: T.value.update({ step: 2 }), $.value.triggerGuideEvent("entry"), t.n = 4; break; case 2: return t.n = 3, D(); case 3: p.$gemit("updateSubIdx"); case 4: T.value.show(); case 5: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), trainMid: function () { K(1), T.value.hide() }, enterTrain: function () { var t = Se(we().m(function t() { return we().w(function (t) { for (; ;)switch (t.n) { case 0: return T.value.hide(), t.n = 1, D(); case 1: p.$gemit("updateSubIdx"), T.value.show(); case 2: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), resetSkill: function () { T.value.hide(), k(), setTimeout(function () { p.$gemit("updateSubIdx"), T.value.show() }, 300) }, guideEnd: function () { (0, u.$j)({ blockAction: "" }), (0, u.s2)(2), T.value.close(), p.$gemit("pauseGame"), p.$gemit("startGuideGame") }, finishSkill1: function () { 5 === d.value && ((0, u.$j)({ blockAction: "" }), p.$gemit("pauseGame"), p.$gemit("resumeGame"), p.$gemit("useSkill", 1), (0, u.s2)(6), e.setAwardGuideFlag(!0), T.value.close()) }, end: function () { 1 !== d.value && T.value.close(), 9 === d.value && (0, u.s2)(d.value + 1), i.value && (e.setAwardGuideFlag(!1), ft()) } }, closeCb: function () { T.value = null } }), t.a(2, !0); case 4: if (2 !== d.value) { t.n = 5; break } return t.n = 5, Q(r.Vs.after); case 5: return t.a(2, !1) } }, t) })); return function () { return t.apply(this, arguments) } }(), dt = function () { var t = Se(we().m(function t() { return we().w(function (t) { for (; ;)switch (t.n) { case 0: return m.value = !0, p.$playEffect(r.Ie.GlitchWhoosh), G.value = setInterval(function () { P.value += "9", 40 === P.value.length && clearInterval(G.value) }, 50), t.n = 1, $.value.toBossScene(); case 1: m.value = !1, (0, u.$j)({ isFinalAnimating: !1 }), p.$gemit("resumeFinalBgm"); case 2: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), ft = function () { var t = Se(we().m(function t() { var e, n, a; return we().w(function (t) { for (; ;)switch (t.n) { case 0: if (e = 2 === d.value, d.value >= 4 && $.value.setHomeIdolVisible(!0), n = "InProgress" === (0, u.vI)("opening") && u.rS.isFinalDate, "InProgress" !== (0, u.vI)("opening")) { t.n = 3; break } return setTimeout(function () { n && (0, u.$j)({ isFinalAnimating: !0 }) }, 1e3), t.n = 1, Q(r.Vs.opening); case 1: return t.n = 2, (0, u.Om)("opening"); case 2: a = u.wk.pageInfo.user_activity_info.sign_info.signs, e = a.some(function (t) { return t.status === nt.Ol.IN_PROGRESS }); case 3: return t.n = 4, st(); case 4: if (!t.v) { t.n = 5; break } return A.value && (A.value = !1, I()), t.a(2); case 5: if (!("InProgress" === (0, u.vI)("mid") && u.rS.curWeek <= 4 && u.rS.curDate >= 3)) { t.n = 7; break } return t.n = 6, Q(r.Vs.mid); case 6: return t.n = 7, (0, u.Om)("mid"); case 7: return t.n = 8, Y(); case 8: if (!t.v) { t.n = 9; break } return ft(), t.a(2); case 9: if (!e) { t.n = 13; break } return t.n = 10, y(); case 10: if (!(u.rS.curWeek > 1 && u.rS.curWeek < 5)) { t.n = 12; break } return t.n = 11, g({ week: u.rS.curWeek, modalType: "training" }); case 11: if (3 !== u.rS.curWeek) { t.n = 12; break } return t.n = 12, w("3_2", !1); case 12: 3 === d.value && st(); case 13: if (!n) { t.n = 15; break } return t.n = 14, dt(); case 14: clearInterval(G.value), P.value = ""; case 15: $.value.setHomeIdolVisible(!0), A.value && (A.value = !1, I()); case 16: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(); (0, a.watch)(function () { return u.wk.currentPage }, function (t) { "home" === t && ft() }), (0, a.watch)(function () { return u.rS.isBossLayout && "home" === u.wk.currentPage }, function (t) { t && W("session", "visit", "final", "") }), (0, a.watch)(function () { return m.value || -1 !== E.value }, function (t) { "home" === u.wk.currentPage && $.value.updateHomeBtnVisible(u.wk.isFinalAnimating || !t) }); var vt = function (t) { var e = t.week, n = t.type, a = t.idolId, i = t.chapterId; if ("idol" !== n) return 5 === e && 10502 === i ? ((0, u.$j)({ reviewFinal: !0 }), void D()) : void Q(r.Vs[n], e, !0); J(function () { }, { idolId: a, chapterId: i }, !0) }, mt = function () { var t = Se(we().m(function t() { return we().w(function (t) { for (; ;)switch (t.n) { case 0: if ("growth" !== u.wk.currentPage) { t.n = 2; break } return t.n = 1, D(); case 1: return E.value = -1, t.a(2); case 2: if ("training" !== u.wk.currentPage) { t.n = 4; break } return m.value = !0, t.n = 3, C(2, function () { $.value.trainingToHome() }); case 3: (0, u.$j)({ currentPage: "home" }), m.value = !1; case 4: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(); return (0, a.onMounted)(function () { j(), p.$gon("review", vt) }), (0, a.onBeforeUnmount)(function () { p.$goff("review", vt) }), { __sfc: !0, guideStore: e, hasAwardGuide: i, triggerGuideModal: l, skillGuideStep: s, curGuideStep: d, finalClickSpot: f, finalModal: v, isAnimating: m, vm: p, showAwardResModal: g, showCalendarModal: b, showGal: h, showSignInModal: y, showSkillModal: k, showRuleModal: w, showUnlockTimeModal: I, showMidTrans: C, showGuideModal: S, guideModal: T, effectRef: $, activeIdolId: E, tempTrainInfo: O, errTarget: P, errStrTimer: G, blockedByPageInfo: M, showNextUnlockTip: A, showReviewGuideModal: B, trackPageView: j, trackEvent: W, errTargetText: N, onSelectedIdol: R, topNavVisible: F, onGameBtnClick: D, onConfirmAbility: K, onConfirmFriendship: X, pageCompMap: z, onEventClick: J, mainSceneDialog: Q, finishEndEvent: Y, onGameOver: Z, handleFinalEnd: at, onFinalClick: it, gameToHome: rt, onLoadComplete: ot, onEnter: ct, onGalNext: function () { v.value.realInstance.$refs.dialog.handleGalNext(!0), v.value.show(), (0, u.$j)({ finalModalVisible: !0 }) }, onHideGal: lt, triggerGuide: st, triggerBossScene: dt, onDayEnter: ft, updateHomeBtnState: function (t) { $.value.setTrainBtnState(t) }, handleReview: vt, onBack: mt, IS_SEA: r.p4, showAniErr: c.A, Effect: H, StrokeSVG: V.A, ClickEffect: Dt, TopNav: oe, state: u.wk } } }), $e = Te, xe = (0, D.A)($e, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { staticClass: "index-page" }, [e(n.StrokeSVG, { attrs: { id: "stroke-text-svg-filter-bolder", width: 5 } }), t._v(" "), e(n.StrokeSVG, { attrs: { id: "stroke-text-svg-filter-bold", width: 3.5 } }), t._v(" "), e(n.StrokeSVG, { attrs: { id: "stroke-text-svg-filter-normal", width: 2 } }), t._v(" "), e(n.Effect, { directives: [{ name: "append-to-element", rawName: "v-append-to-element", value: "#canvas-bg", expression: "'#canvas-bg'" }], ref: "effectRef", attrs: { width: t.$frame.canvasStateToLayout.width, height: t.$frame.canvasStateToLayout.height, rotate: t.$frame.env.rotate, isSea: n.IS_SEA, activeIdolId: n.activeIdolId }, on: { galNext: n.onGalNext, hideGal: n.onHideGal, loadComplete: n.onLoadComplete, gameOver: n.onGameOver, webglError: function (t) { return n.showAniErr("webglErr") }, loadError: function (t) { return n.showAniErr("loadErr") }, gpuAccDisable: function (t) { return n.showAniErr("gpuAccDisable") } } }), t._v(" "), e("transition", { attrs: { name: "fade" } }, [e(n.pageCompMap[n.state.currentPage], { directives: [{ name: "show", rawName: "v-show", value: !n.isAnimating || n.state.isFinalAnimating, expression: "!isAnimating || state.isFinalAnimating" }], tag: "component", attrs: { activeIdolId: n.activeIdolId, errTargetText: n.errTargetText }, on: { back: n.onBack, enter: n.onEnter, selectedIdol: n.onSelectedIdol, confirmAbility: n.onConfirmAbility, onGameBtnClick: n.onGameBtnClick, eventClick: function (t) { return n.onEventClick() }, confirmFriendship: n.onConfirmFriendship, updateHomeBtnState: n.updateHomeBtnState } })], 1), t._v(" "), e("transition", { attrs: { name: "fade" } }, [e(n.TopNav, { directives: [{ name: "show", rawName: "v-show", value: n.topNavVisible, expression: "topNavVisible" }], attrs: { topNavVisible: n.topNavVisible, activeIdolId: n.activeIdolId } })], 1), t._v(" "), n.finalClickSpot ? e("div", { staticClass: "final-click-spot", class: "final-click-spot__".concat(n.finalClickSpot), on: { click: n.onFinalClick } }, [n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.confirm, alt: "" } }) : t._e()]) : t._e(), t._v(" "), e(n.ClickEffect)], 1) }, [], !1, null, "3802ba8a", null).exports }, 77325: function (t, e, n) { n.d(e, { A: function () { return c } }); var a = n(74061), i = n(15908), r = n(4115), o = (0, a.defineComponent)({ __name: "promptModal", props: { title: null, message: null, showCancelBtn: { type: Boolean }, confirmBtnText: null, cancelBtnText: null, enableGamepad: { type: Boolean } }, emits: ["cancel", "confirm"], setup: function (t, e) { var n = e.emit, o = t, c = (0, a.getCurrentInstance)().proxy, l = (0, r.pT)(!0), s = l.onBtnPress, u = l.onDirection, d = (0, a.ref)(o.enableGamepad ? 0 : -1), f = (0, a.computed)(function () { var t; return null === (t = o.showCancelBtn) || void 0 === t || t }), v = function () { c.$playEffect(i.Ie.Common_Click), n("cancel") }, m = function () { c.$playEffect(i.Ie.Common_Click), n("confirm") }, p = (0, a.computed)(function () { return o.confirmBtnText || c.$getI18nWord("prompt_confirm_btn") }), g = (0, a.computed)(function () { return o.cancelBtnText || c.$getI18nWord("prompt_cancel_btn") }); return u(function (t) { var e = t.direction; if (["left", "right"].includes(e)) { var n = "left" === e ? -1 : 1, a = Math.min(Math.max(0, d.value + n), o.showCancelBtn ? 1 : 0); d.value = a } }), s("confirm", function () { 0 === d.value && o.showCancelBtn ? v() : m() }), s("cancel", function () { v() }, "Escape"), (0, a.onMounted)(function () { c.$gon("closeExitPrompt", v), c.$playEffect(i.Ie.Popup) }), (0, a.onBeforeUnmount)(function () { c.$goff("closeExitPrompt", v) }), { __sfc: !0, vm: c, onBtnPress: s, onDirection: u, props: o, focusIdx: d, emit: n, showCancelBtn: f, onCancel: v, onConfirm: m, confirmBtnText: p, cancelBtnText: g } } }), c = (0, n(14486).A)(o, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { staticClass: "prompt-modal title-font" }, [e("div", { staticClass: "prompt-content" }, [e("div", { staticClass: "prompt-title" }, [t._v(t._s(n.props.title))]), t._v(" "), e("div", { staticClass: "prompt-body" }, [e("div", { staticClass: "prompt-body-text", domProps: { innerHTML: t._s(n.props.message) } })]), t._v(" "), e("div", { staticClass: "prompt-actions" }, [n.showCancelBtn ? e("div", { staticClass: "prompt-btn btn-cancel", class: { "prompt-btn__focus": 0 === n.focusIdx && n.showCancelBtn }, attrs: { "data-text": n.cancelBtnText }, on: { click: n.onCancel } }, [t._v(t._s(n.cancelBtnText))]) : t._e(), t._v(" "), e("div", { staticClass: "prompt-btn btn-confirm", class: { "prompt-btn__focus": 1 === n.focusIdx || !n.showCancelBtn && 0 === n.focusIdx }, attrs: { "data-text": n.confirmBtnText }, on: { click: n.onConfirm } }, [t._v(t._s(n.confirmBtnText))])])]), t._v(" "), n.props.enableGamepad ? e("div", { staticClass: "gamepad-tip" }, [e("div", { staticClass: "gamepad-tip-item" }, [e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.confirm, alt: "" } }), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("gamepad_confirm_btn")))])])]) : t._e(), t._v(" "), e("div", { staticClass: "close-btn", on: { click: n.onCancel } })]) }, [], !1, null, "6f0503c2", null).exports }, 80671: function (t, e, n) { n.d(e, { A: function () { return l } }); var a = n(74061), i = n(6624), r = n(4115), o = n(85880), c = (0, a.defineComponent)({ __name: "unlockTimeModal", emits: ["close"], setup: function (t, e) { var n = e.emit, c = (0, r.pT)(!0).onBtnPress, l = (0, a.getCurrentInstance)().proxy, s = (0, a.computed)(function () { if (i.rS.curWeek <= 4) { var t = i.wk.pageInfo.act_show_info.left_seconds, e = Math.floor(t / 3600), n = Math.floor(t % 3600 / 60); return 0 === e && n < 1 && (n = 1), l.$getI18nWord({ key: "guide_tip_5_4", data: { HH: e, mm: n } }) } return l.$getI18nWord("guide_tip_finished") }); c("confirm", function () { n("close") }), c("cancel", function () { n("close") }, "Escape"); var u = function () { o.default.fromTo(".unlock-time-modal", { opacity: 0, scale: .9, y: "0.1rem" }, { opacity: 1, scale: 1, y: 0, duration: .2, ease: "power1.inOut" }) }; return (0, a.onMounted)(function () { (0, a.nextTick)(function () { u() }) }), { __sfc: !0, onBtnPress: c, vm: l, emits: n, msg: s, playPopoverAni: u, state: i.wk } } }), l = (0, n(14486).A)(c, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_common_guide_tip_bg.png"), expression: "$getLocalImg('modal_common_guide_tip_bg.png')", modifiers: { bg: !0 } }], staticClass: "unlock-time-modal title-font" }, [e("div", { staticClass: "unlock-time-modal-content", domProps: { innerHTML: t._s(n.msg) } }), t._v(" "), n.state.enableGamepad ? e("div", { staticClass: "gamepad-tip" }, [e("div", { staticClass: "gamepad-tip-item" }, [e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.confirm, alt: "" } }), t._v(" "), e("span", { attrs: { "data-text": t.$getI18nWord("gamepad_back_btn") } }, [t._v(t._s(t.$getI18nWord("gamepad_back_btn")))])])]) : t._e()]) }, [], !1, null, "4956afc7", null).exports }, 84447: function (t, e, n) { function a(t) { return a = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (t) { return typeof t } : function (t) { return t && "function" == typeof Symbol && t.constructor === Symbol && t !== Symbol.prototype ? "symbol" : typeof t }, a(t) } function i(t, e, n) { return (e = function (t) { var e = function (t) { if ("object" != a(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var n = e.call(t, "string"); if ("object" != a(n)) return n; throw new TypeError("@@toPrimitive must return a primitive value.") } return String(t) }(t); return "symbol" == a(e) ? e : e + "" }(e)) in t ? Object.defineProperty(t, e, { value: n, enumerable: !0, configurable: !0, writable: !0 }) : t[e] = n, t } n.d(e, { A: function () { return T } }); var r = n(74061), o = n(15908), c = n(74681), l = n(6624), s = n(57905), u = n(4115), d = n(24581), f = n(19278), v = (0, r.defineComponent)({ __name: "shareSuccess", emits: ["close"], setup: function (t, e) { var n = e.emit; return (0, u.pT)(!0), (0, r.onMounted)(function () { setTimeout(function () { n("close") }, 3e3) }), { __sfc: !0, emits: n } } }), m = n(14486), p = (0, m.A)(v, function () { var t = this, e = t._self._c; return t._self._setupProxy, e("div", { staticClass: "share-success-modal title-font" }, [t._v("\n  " + t._s(t.$getI18nWord("share_success_toast")) + "\n")]) }, [], !1, null, "983d676c", null).exports, g = n(43097), _ = n(19716), b = n(99836), h = n(97921); function y() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var l = a && a.prototype instanceof c ? a : c, s = Object.create(l.prototype); return k(s, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), s } var o = {}; function c() { } function l() { } function s() { } e = Object.getPrototypeOf; var u = [][a] ? e(e([][a]())) : (k(e = {}, a, function () { return this }), e), d = s.prototype = c.prototype = Object.create(u); function f(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, s) : (t.__proto__ = s, k(t, i, "GeneratorFunction")), t.prototype = Object.create(d), t } return l.prototype = s, k(d, "constructor", s), k(s, "constructor", l), l.displayName = "GeneratorFunction", k(s, i, "GeneratorFunction"), k(d), k(d, i, "Generator"), k(d, a, function () { return this }), k(d, "toString", function () { return "[object Generator]" }), (y = function () { return { w: r, m: f } })() } function k(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } k = function (t, e, n, a) { function r(e, n) { k(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, k(t, e, n, a) } function w(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } function I(t) { return function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { w(r, a, i, o, c, "next", t) } function c(t) { w(r, a, i, o, c, "throw", t) } o(void 0) }) } } var C = (0, r.defineComponent)({ __name: "signInModal", emits: ["close"], setup: function (t, e) { var a = e.emit, i = (0, h.v)().trackEvent, v = (0, d.x)().showAwardResModal, m = (0, u.pT)(!0), k = m.onBtnPress, w = m.onDirection, C = (0, g.d)(), S = (0, _.bP)(C).curGuideStep, T = (0, r.ref)(!1), $ = (0, r.ref)(null), x = (0, r.ref)([{ id: 401, cnt: 20 }, { id: 402, cnt: 20 }, { id: 403, cnt: 20 }, { id: 404, cnt: 20 }, { id: 405, cnt: 20 }]), E = (0, r.computed)(function () { return { game_biz: "nap_cn", title: B.value, desc: L.value, copyFullText: A.$getI18nWord("share_copy_text"), url: o._X, type: "image", img_url: A.$getI18nWord("share_img_".concat(M.value)) } }), O = (0, r.computed)(function () { return { key: "m20251014hy2e1kt0jk", lang: A.$getLang(), game_biz: "nap_global", title_key: "date_title_".concat(M.value), desc_key: "date_desc_".concat(M.value), copyFullText: A.$getI18nWord("share_copy_text"), url: o._X, type: "image", img_url: A.$getI18nWord("share_img_".concat(M.value)) } }), P = (0, r.computed)(function () { return { platsCnExcludes: f.Ay.isCG() && l.wk.enableGamepad ? ["link"] : [], position: "top", arrowPos: "right", themeConfig: { borderColor: "#292C4B", backgroundColor: "#E2E2E2", iconBorderColor: "#292C4B", iconActiveBorderColor: "#FDD034", borderRadius: o.K6 ? void 0 : "0.3em", borderWidth: o.K6 ? "0.1em" : "0.05em" }, arrowIcon: { icon: "", top: "auto", bottom: "calc(100% + 0.18em)", width: "0.22em", height: "0.18em" }, focusIcon: o.K6 ? {} : { default: n(86496), active: n(33593), width: "0.25rem", height: "0.25rem", top: "0.45rem", left: "-0.05rem" } } }), G = function () { var t = l.wk.pageInfo.user_activity_info.sign_info.signs, e = (0, b.Kl)(t, function (t) { var e = t.sign_id, n = t.status; return 401 !== e && n === s.Ol.IN_PROGRESS }); return -1 === e ? 1 : +e + 1 }, M = (0, r.ref)(G()), A = (0, r.getCurrentInstance)().proxy, B = (0, r.computed)(function () { return A.$getI18nWord("date_title_".concat(M.value)) }), L = (0, r.computed)(function () { return A.$getI18nWord("date_desc_".concat(M.value)) }), j = function () { A.$playEffect(o.Ie.Common_Click), N(M.value), a("close") }, W = function (t) { var e = l.wk.pageInfo.user_activity_info.sign_info.signs.find(function (e) { return e.sign_id === t }).status; return e === s.Ol.COMPLETED ? "claimed" : e === s.Ol.LOCKED ? "locked" : "inprogress" }, N = function (t) { var e = +"40".concat(t), n = V.value.find(function (t) { return t.id === e }); if ("entry" === n.imgState) { var a = l.wk.roleInfo, i = a.game_uid, r = a.region, o = "sign_img_state_".concat(i, "_").concat(r, "_").concat(e); n.imgState = "show", c.IG.set(o, !0) } }, R = function (t) { A.$playEffect(o.Ie.Common_Click); var e = M.value; M.value += t, i("popup", "click", "nav", -1 === t ? 1 : 2), M.value < 1 ? M.value = V.value.length : M.value > V.value.length && (M.value = 1), N(e) }, F = function (t) { return l.wk.pageInfo.user_activity_info.sign_info.signs.find(function (e) { return e.sign_id === t }).status !== s.Ol.LOCKED }, D = function (t) { var e = l.wk.roleInfo, n = e.game_uid, a = e.region, i = F(t), r = (0, b.Aw)({ id: t, uid: n, region: a }); return 401 === t || r && i ? "show" : i ? "entry" : "hide" }, H = function () { var t = l.wk.pageInfo.user_activity_info.sign_info.signs, e = l.wk.pageInfo.sign_pic_resp, n = e.line_arts, a = e.sign_pics, i = [{ id: 401, line: "", full: A.$getLocalImg("modal_signIn_poster_1.png"), imgState: "show" }]; return t.forEach(function (t) { var e = t.sign_id; t.status !== s.Ol.LOCKED && 401 !== e && i.push({ id: e, line: n[e], full: a[e], imgState: D(e) }) }), i }, V = (0, r.ref)(H()), U = function () { var t = I(y().m(function t() { var e, n; return y().w(function (t) { for (; ;)switch (t.n) { case 0: if (0 !== (e = x.value.filter(function (t) { return "inprogress" === W(t.id) }).map(function (t) { return t.id })).length) { t.n = 1; break } return t.a(2); case 1: return i("popup", "click", "checkin", ""), A.$playEffect(o.Ie.Common_Click), t.n = 2, (0, l.SK)(e); case 2: n = e.reduce(function (t, e) { return t + x.value.find(function (t) { return t.id === e }).cnt }, 0), X.value = -1, v({ modalType: "award", awardList: [{ award_id: 100, cnt: n }] }); case 3: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(), K = (0, r.computed)(function () { return "InProgress" === l.wk.pageInfo.user_activity_info.task_info.tasks.find(function (t) { return t.task_id === o.yQ }).status }), q = function () { var t = I(y().m(function t() { return y().w(function (t) { for (; ;)switch (t.n) { case 0: if (T.value = !1, !K.value) { t.n = 2; break } return t.n = 1, (0, l.Gm)(); case 1: A.$commonModal(p); case 2: return t.a(2) } }, t) })); return function () { return t.apply(this, arguments) } }(); k("leftShoulder1", function () { V.value.length <= 1 || T.value || R(-1) }), k("button4", function () { T.value || $.value.handleShare() }), k("rightShoulder1", function () { V.value.length <= 1 || T.value || R(1) }), k("cancel", function () { T.value && l.wk.enableGamepad ? $.value.close() : j() }, "Escape"), w(function (t) { var e = t.direction; if (["left", "right"].includes(e) && T.value) { var n = "left" === e ? -1 : 1; $.value.changeIndex({ direction: n }) } }), k("confirm", function () { T.value ? $.value.confirm() : -1 !== X.value && U() }), (0, r.onMounted)(function () { i("popup", "view", "attendance", ""), A.$playEffect(o.Ie.Popup_2), l.wk.enableGamepad && $.value.toggleGamepadState(!0), 2 === S.value && (0, l.s2)(3) }); var X = (0, r.ref)((0, b.Kl)(x.value, function (t) { return "inprogress" === W(t.id) })); return { __sfc: !0, trackEvent: i, emits: a, showAwardResModal: v, onBtnPress: k, onDirection: w, guideStore: C, curGuideStep: S, sharePopShow: T, shareIns: $, signAwardList: x, shareOptsCn: E, shareOptsSea: O, popoverOpts: P, getDefaultPosterIndex: G, activePosterIndex: M, vm: A, dateTitle: B, dateDesc: L, closeModal: j, getSignAwardStatus: W, setImgCache: N, handleSwitch: R, isPosterUnlock: F, fullImageState: D, initPosterState: H, poserList: V, handleClaimAward: U, shareTaskVisible: K, getMaskImage: function (t) { return "entry" === t ? "url('".concat(A.$getLocalImg("modal_signIn_sprite.png"), "')") : "none" }, onChannelShare: q, onPopupShow: function () { A.$playEffect(o.Ie.Common_Click), T.value = !0, i("popup", "click", "share2", M.value) }, activeDateIdx: X, IS_SEA: o.p4, IS_BBS: o.bS, state: l.wk } } }), S = C, T = (0, m.A)(S, function () { var t = this, e = t._self._c, a = t._self._setupProxy; return e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_signIn_modal_bg.png"), expression: "$getLocalImg('modal_signIn_modal_bg.png')", modifiers: { bg: !0 } }], staticClass: "sign-modal title-font" }, [e("div", { staticClass: "sign-modal-poster-container" }, t._l(a.poserList, function (n) { return e("div", { directives: [{ name: "show", rawName: "v-show", value: +"40".concat(a.activePosterIndex) === n.id, expression: "+`40${activePosterIndex}` === poster.id" }], key: n.id, staticClass: "sign-modal-poster", class: i(i({}, "sign-modal-poster__".concat(n.id), !0), "sign-modal-poster__".concat(n.imgState), !0) }, [401 !== n.id ? e("div", { staticClass: "sign-modal-poster-line", style: { backgroundImage: "url(".concat(n.line, ")") } }) : t._e(), t._v(" "), "hide" !== n.imgState ? e("div", { staticClass: "sign-modal-poster-full", style: { backgroundImage: "url(".concat(n.full, ")"), maskImage: a.getMaskImage(n.imgState), webkitMaskImage: a.getMaskImage(n.imgState) } }) : t._e()]) }), 0), t._v(" "), a.shareTaskVisible ? e("img", { staticClass: "sha-award-tip", attrs: { src: t.$getI18nWord("sign_share_btn"), alt: "" } }) : t._e(), t._v(" "), e("share", { ref: "shareIns", staticClass: "sha-btn", attrs: { isSea: a.IS_SEA, icon: n(36263), shareOptsCn: a.shareOptsCn, shareOptsSea: a.shareOptsSea, copy: a.IS_SEA && a.IS_BBS, popoverOpts: a.popoverOpts }, on: { share: a.onChannelShare, show: a.onPopupShow, close: function (t) { a.sharePopShow = !1 } } }, [a.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.button4 } }) : t._e()]), t._v(" "), a.poserList.length > 1 ? [e("div", { staticClass: "sign-modal-switch-btn sign-modal-switch-btn__left", on: { click: function (t) { return a.handleSwitch(-1) } } }, [a.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.leftShoulder1 } }) : t._e()]), t._v(" "), e("div", { staticClass: "sign-modal-switch-btn sign-modal-switch-btn__right", on: { click: function (t) { return a.handleSwitch(1) } } }, [a.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.rightShoulder1 } }) : t._e()])] : t._e(), t._v(" "), e("div", { staticClass: "sign-modal-content" }, [e("div", { staticClass: "sign-modal-content-info" }, [e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_signIn_title_bg.png"), expression: "$getLocalImg('modal_signIn_title_bg.png')", modifiers: { bg: !0 } }], staticClass: "sign-modal-content-info-title" }, [e("i", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_signIn_icon_title.png"), expression: "$getLocalImg('modal_signIn_icon_title.png')", modifiers: { bg: !0 } }] }), t._v(" "), e("span", { staticClass: "sign-modal-content-info-title-text" }, [t._v(t._s(a.dateTitle))]), t._v(" "), e("span", { staticClass: "sign-modal-content-info-title-date num-font" }, [t._v(t._s(t.$getI18nWord({ key: "calendar_btn_val", data: { n: a.activePosterIndex } })))])]), t._v(" "), e("div", { staticClass: "sign-modal-content-info-desc", domProps: { innerHTML: t._s(a.dateDesc) } })]), t._v(" "), e("div", { staticClass: "sign-modal-content-date" }, t._l(a.signAwardList, function (n, r) { return e("div", { key: n.id, staticClass: "sign-modal-content-date-item", class: i(i({}, "sign-modal-content-date-item__".concat(a.getSignAwardStatus(n.id)), !0), "sign-modal-content-date-item__focused", a.activeDateIdx === r) }, [e("div", { staticClass: "icon-date", class: "icon-date__".concat(n.id) }), t._v(" "), e("div", { staticClass: "award-container num-font" }, [e("span", { attrs: { "data-text": "×".concat(n.cnt) } }, [t._v(t._s("×".concat(n.cnt)))])]), t._v(" "), 4 === r ? e("div", { staticClass: "btn-deco" }) : t._e(), t._v(" "), "inprogress" === a.getSignAwardStatus(n.id) ? e("div", { staticClass: "claim-btn", on: { click: a.handleClaimAward } }, [e("span", [t._v(t._s(t.$getI18nWord("sign_in_btn")))]), t._v(" "), a.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.confirm } }) : t._e()]) : t._e()]) }), 0)]), t._v(" "), e("div", { staticClass: "sign-modal-deco" }), t._v(" "), e("div", { staticClass: "sign-in-refresh-tip" }, [t._v(t._s(t.$getI18nWord("sign_in_refresh_tip")))]), t._v(" "), e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("common_close_btn.png"), expression: "$getLocalImg('common_close_btn.png')", modifiers: { bg: !0 } }], staticClass: "close-btn", on: { click: a.closeModal } })], 2) }, [], !1, null, "14700681", null).exports }, 87262: function (t, e, n) { n.d(e, { A: function () { return f } }); var a = n(74061), i = n(18414), r = n(15908), o = n(4115), c = n(6624), l = n(99836), s = n(97921); function u(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, a = Array(e); n < e; n++)a[n] = t[n]; return a } var d = (0, a.defineComponent)({ __name: "awardResModal", props: { modalType: null, week: null, awardList: null }, emits: ["close"], setup: function (t, e) { var n = e.emit, d = t, f = (0, s.v)().trackEvent, v = (0, o.pT)(!0), m = v.onBtnPress, p = v.onDirection, g = (0, a.getCurrentInstance)().proxy, _ = (0, a.ref)(c.wk.enableGamepad ? 0 : -1), b = (0, a.ref)({ week_2: [{ icon: g.$getLocalImg("training_icon_ability_3_active.png"), name: g.$getI18nWord("ability_name_3") }, { icon: g.$getLocalImg("modal_skill_skill_icon_2.png"), name: g.$getI18nWord("skill_name_2") }], week_3: [{ icon: g.$getLocalImg("training_icon_ability_4_active.png"), name: g.$getI18nWord("ability_name_4") }, { icon: g.$getLocalImg("modal_skill_skill_icon_3.png"), name: g.$getI18nWord("skill_name_3") }], week_4: [{ icon: g.$getLocalImg("modal_skill_skill_icon_4.png"), name: g.$getI18nWord("skill_name_4") }] }), h = (0, a.computed)(function () { var t = "award" === d.modalType ? "award_title" : "train_unlock_title"; return 4 === d.week && "training" === d.modalType && (t = "combo_unlock_title"), g.$getI18nWord(t) }), y = (0, a.computed)(function () { var t = "award" === d.modalType ? "ingame_award_tips" : "skill_unlock_tips"; return g.$getI18nWord(t) }), k = (0, a.computed)(function () { if ("award" === d.modalType) { var t = [100, 300002, 10, 3301019]; return (e = d.awardList || [], function (t) { if (Array.isArray(t)) return u(t) }(e) || function (t) { if ("undefined" != typeof Symbol && null != t[Symbol.iterator] || null != t["@@iterator"]) return Array.from(t) }(e) || function (t, e) { if (t) { if ("string" == typeof t) return u(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? u(t, e) : void 0 } }(e) || function () { throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }()).sort(function (e, n) { var a = t.indexOf(e.award_id), i = t.indexOf(n.award_id); return (-1 === a ? t.length : a) - (-1 === i ? t.length : i) }).map(function (t) { return { icon: r.je[t.award_id].lg, name: g.$getI18nWord("award_name_".concat(t.award_id)), cnt: (0, l.je)({ num: t.cnt, lang: g.$getLang() }) } }) } var e; return b.value["week_".concat(d.week)] }), w = function () { n("close") }, I = function () { f("popup", "click", "view", ""), g.$commonModal(i.A, { dialogInfo: { defaultTab: 4 === d.week ? 1 : 0, defaultActiveId: d.week } }) }, C = function (t) { return "skill" === t ? 0 === _.value && "training" === d.modalType : "close" === t && ("training" !== d.modalType && 0 === _.value || 1 === _.value) }, S = (0, a.ref)(["confirm"]); return m("confirm", function () { C("close") && w(), C("skill") && I() }), p(function (t) { var e = t.direction; if (["left", "right"].includes(e)) { var n = "left" === e ? -1 : 1, a = "training" === d.modalType ? 2 : 1; _.value = Math.min(Math.max(0, _.value + n), a - 1) } }), m("cancel", function () { w() }, "Escape"), (0, a.onMounted)(function () { f("popup", "view", "award" === d.modalType ? "attendance_reward" : "training_unlock", ""), g.$playEffect(r.Ie.Popup) }), { __sfc: !0, trackEvent: f, onBtnPress: m, onDirection: p, vm: g, props: d, emits: n, focusBtnIdx: _, iconList: b, modalTitle: h, modalDesc: y, awardIconList: k, handleClose: w, handleSkillBtnClick: I, getIsBtnFocus: C, gamepadBtnList: S, state: c.wk } } }), f = (0, n(14486).A)(d, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_awardRes_modal_bg.png"), expression: "$getLocalImg('modal_awardRes_modal_bg.png')", modifiers: { bg: !0 } }], staticClass: "award-res-modal title-font" }, [e("div", { staticClass: "award-res-modal-title", attrs: { "data-text": n.modalTitle } }, [t._v(t._s(n.modalTitle))]), t._v(" "), e("div", { staticClass: "item-container" }, t._l(n.awardIconList, function (n, a) { return e("div", { key: a, staticClass: "award-item" }, [e("div", { staticClass: "award-item-icon", style: { backgroundImage: "url(".concat(n.icon, ")") } }), t._v(" "), n.cnt ? e("div", { staticClass: "award-item-cnt", domProps: { innerHTML: t._s(n.cnt.str) } }) : t._e(), t._v(" "), e("p", { staticClass: "award-item-name", attrs: { "data-text": n.name } }, [t._v(t._s(n.name))])]) }), 0), t._v(" "), e("p", { staticClass: "award-res-modal-desc", domProps: { innerHTML: t._s(n.modalDesc) } }), t._v(" "), e("div", { staticClass: "btn-container" }, ["training" === n.props.modalType ? e("div", { staticClass: "skill-btn", class: { "skill-btn__focus": n.getIsBtnFocus("skill") }, on: { click: n.handleSkillBtnClick } }, [t._v(t._s(t.$getI18nWord("modal_skill_btn")))]) : t._e(), t._v(" "), e("div", { staticClass: "close-btn", class: { "close-btn__focus": n.getIsBtnFocus("close") }, on: { click: n.handleClose } }, [t._v(t._s(t.$getI18nWord("modal_close_btn")))])]), t._v(" "), n.state.enableGamepad ? e("div", { staticClass: "gamepad-tip" }, t._l(n.gamepadBtnList, function (n, a) { return e("div", { key: "".concat(n, "_").concat(a), staticClass: "gamepad-tip-item" }, [e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap[n], alt: "" } }), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("gamepad_".concat(n, "_btn"))))])]) }), 0) : t._e()]) }, [], !1, null, "6bcd978d", null).exports }, 92225: function (t, e, n) { n.d(e, { A: function () { return i } }); var a = (0, n(74061).defineComponent)({ __name: "strokeSVG", props: ["id", "width"], setup: function (t) { return { __sfc: !0, logicPxToReal: function (t, e) { return t / 100 * e } } } }), i = (0, n(14486).A)(a, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("svg", { staticStyle: { display: "none" }, attrs: { version: "1.1", xmlns: "http://www.w3.org/2000/svg", "xmlns:xlink": "http://www.w3.org/1999/xlink" } }, [e("defs", [e("filter", { attrs: { id: t.$props.id } }, [e("feMorphology", { attrs: { operator: "dilate", radius: n.logicPxToReal(t.$props.width, t.$frame.rem) } }), t._v(" "), e("feComposite", { attrs: { operator: "xor", in: "SourceGraphic" } })], 1)])]) }, [], !1, null, null, null).exports }, 96981: function (t, e, n) { n.d(e, { A: function () { return _ } }); var a = n(74061), i = n(15908), r = n(6624), o = n(57905), c = n(4115), l = n(24581), s = n(99836), u = n(97921); function d() { var t, e, n = "function" == typeof Symbol ? Symbol : {}, a = n.iterator || "@@iterator", i = n.toStringTag || "@@toStringTag"; function r(n, a, i, r) { var l = a && a.prototype instanceof c ? a : c, s = Object.create(l.prototype); return f(s, "_invoke", function (n, a, i) { var r, c, l, s = 0, u = i || [], d = !1, f = { p: 0, n: 0, v: t, a: v, f: v.bind(t, 4), d: function (e, n) { return r = e, c = 0, l = t, f.n = n, o } }; function v(n, a) { for (c = n, l = a, e = 0; !d && s && !i && e < u.length; e++) { var i, r = u[e], v = f.p, m = r[2]; n > 3 ? (i = m === a) && (l = r[(c = r[4]) ? 5 : (c = 3, 3)], r[4] = r[5] = t) : r[0] <= v && ((i = n < 2 && v < r[1]) ? (c = 0, f.v = a, f.n = r[1]) : v < m && (i = n < 3 || r[0] > a || a > m) && (r[4] = n, r[5] = a, f.n = m, c = 0)) } if (i || n > 1) return o; throw d = !0, a } return function (i, u, m) { if (s > 1) throw TypeError("Generator is already running"); for (d && 1 === u && v(u, m), c = u, l = m; (e = c < 2 ? t : l) || !d;) { r || (c ? c < 3 ? (c > 1 && (f.n = -1), v(c, l)) : f.n = l : f.v = l); try { if (s = 2, r) { if (c || (i = "next"), e = r[i]) { if (!(e = e.call(r, l))) throw TypeError("iterator result is not an object"); if (!e.done) return e; l = e.value, c < 2 && (c = 0) } else 1 === c && (e = r.return) && e.call(r), c < 2 && (l = TypeError("The iterator does not provide a '" + i + "' method"), c = 1); r = t } else if ((e = (d = f.n < 0) ? l : n.call(a, f)) !== o) break } catch (e) { r = t, c = 1, l = e } finally { s = 1 } } return { value: e, done: d } } }(n, i, r), !0), s } var o = {}; function c() { } function l() { } function s() { } e = Object.getPrototypeOf; var u = [][a] ? e(e([][a]())) : (f(e = {}, a, function () { return this }), e), v = s.prototype = c.prototype = Object.create(u); function m(t) { return Object.setPrototypeOf ? Object.setPrototypeOf(t, s) : (t.__proto__ = s, f(t, i, "GeneratorFunction")), t.prototype = Object.create(v), t } return l.prototype = s, f(v, "constructor", s), f(s, "constructor", l), l.displayName = "GeneratorFunction", f(s, i, "GeneratorFunction"), f(v), f(v, i, "Generator"), f(v, a, function () { return this }), f(v, "toString", function () { return "[object Generator]" }), (d = function () { return { w: r, m: m } })() } function f(t, e, n, a) { var i = Object.defineProperty; try { i({}, "", {}) } catch (t) { i = 0 } f = function (t, e, n, a) { function r(e, n) { f(t, e, function (t) { return this._invoke(e, n, t) }) } e ? i ? i(t, e, { value: n, enumerable: !a, configurable: !a, writable: !a }) : t[e] = n : (r("next", 0), r("throw", 1), r("return", 2)) }, f(t, e, n, a) } function v(t, e) { (null == e || e > t.length) && (e = t.length); for (var n = 0, a = Array(e); n < e; n++)a[n] = t[n]; return a } function m(t, e, n, a, i, r, o) { try { var c = t[r](o), l = c.value } catch (t) { return void n(t) } c.done ? e(l) : Promise.resolve(l).then(a, i) } var p = { __name: "taskModal", emits: ["close"], setup: function (t, e) { var n = e.emit, f = (0, c.pT)(!0), p = f.onBtnPress, g = f.onDirection, _ = (0, a.ref)(!0), b = (0, a.ref)(!1), h = (0, a.ref)(null), y = (0, l.x)().showAwardResModal, k = (0, a.getCurrentInstance)().proxy, w = (0, u.v)().trackEvent, I = function (t) { k.$playEffect(i.Ie.Common_Click), O.value = t, w("popup", "click", "tab", t + 1), h.value.scrollTo({ y: 0 }, 0), h.value.refresh() }, C = (0, a.computed)(function () { return _.value ? ["confirm", "cancel"] : ($.value[M.value].status === o.e1.COMPLETED ? ["confirm"] : []).concat(["cancel"]) }), S = function () { k.$playEffect(i.Ie.Common_Click), n("close") }, T = function (t) { return r.wk.pageInfo.user_activity_info.task_info.tasks.filter(function (e) { return e.task_type === t }) }, $ = (0, a.computed)(function () { return T(O.value + 1) }), x = (0, a.computed)(function () { return $.value.some(function (t) { return "Completed" === t.status }) }), E = function () { for (var t = 0, e = 0, n = 1; n <= 3; n++) { var a = T(n); 0 === t && a.some(function (t) { return t.status === o.e1.COMPLETED }) && (t = n), 0 === e && a.some(function (t) { return t.status === o.e1.IN_PROGRESS }) && (e = n) } return (t || e || 1) - 1 }, O = (0, a.ref)(E()), P = function () { var t, e = (t = d().m(function t(e) { var n, a, o, c; return d().w(function (t) { for (; ;)switch (t.n) { case 0: if (n = [], !e) { t.n = 2; break } if ((a = r.wk.pageInfo.user_activity_info.task_info.tasks.find(function (t) { return t.task_id === e })) && "Completed" === a.status) { t.n = 1; break } return t.a(2); case 1: w("popup", "click", "claim", e), n = [e], t.n = 3; break; case 2: n = $.value.filter(function (t) { return "Completed" === t.status }).map(function (t) { return t.task_id }), 0 !== n.length && w("popup", "click", "claim_all", O.value + 1); case 3: if (501 === e && w("popup", "click", "claim_namecard", ""), 0 !== n.length) { t.n = 4; break } return t.a(2); case 4: return k.$playEffect(i.Ie.Common_Click), t.n = 5, (0, r.QK)(n); case 5: o = {}, n.forEach(function (t) { (i.dz[t] || []).forEach(function (t) { var e = t.award_id, n = t.cnt; o[e] || (o[e] = 0), o[e] += n }) }), c = Object.entries(o).map(function (t) { var e, n, a = (n = 2, function (t) { if (Array.isArray(t)) return t }(e = t) || function (t, e) { var n = null == t ? null : "undefined" != typeof Symbol && t[Symbol.iterator] || t["@@iterator"]; if (null != n) { var a, i, r, o, c = [], l = !0, s = !1; try { if (r = (n = n.call(t)).next, 0 === e) { if (Object(n) !== n) return; l = !1 } else for (; !(l = (a = r.call(n)).done) && (c.push(a.value), c.length !== e); l = !0); } catch (t) { s = !0, i = t } finally { try { if (!l && null != n.return && (o = n.return(), Object(o) !== o)) return } finally { if (s) throw i } } return c } }(e, n) || function (t, e) { if (t) { if ("string" == typeof t) return v(t, e); var n = {}.toString.call(t).slice(8, -1); return "Object" === n && t.constructor && (n = t.constructor.name), "Map" === n || "Set" === n ? Array.from(t) : "Arguments" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n) ? v(t, e) : void 0 } }(e, n) || function () { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.") }()), i = a[0], r = a[1]; return { award_id: Number(i), cnt: r } }), y({ modalType: "award", awardList: c }); case 6: return t.a(2) } }, t) }), function () { var e = this, n = arguments; return new Promise(function (a, i) { var r = t.apply(e, n); function o(t) { m(r, a, i, o, c, "next", t) } function c(t) { m(r, a, i, o, c, "throw", t) } o(void 0) }) }); return function (t) { return e.apply(this, arguments) } }(), G = (0, a.computed)(function () { return r.wk.pageInfo.user_activity_info.task_info.tasks.find(function (t) { return 501 === t.task_id }).status }), M = (0, a.ref)(-1); return g(function (t) { var e = t.direction;["up", "down"].includes(e) && (_.value ? "up" === e ? I(Math.max(0, O.value - 1)) : "down" === e && I(Math.min(2, O.value + 1)) : !_.value && $.value.length > 0 && ("up" === e ? M.value = Math.max(0, M.value - 1) : "down" === e && (M.value = Math.min($.value.length - 1, M.value + 1)))) }), (0, a.watch)(M, function (t) { _.value || h.value.scrollTo({ y: (1.75 * t - .8) * k.$frame.rem }, 100) }), p("confirm", function () { if (_.value) return _.value = !1, void (M.value = 0); P($.value[M.value].task_id) }), p("cancel", function () { if (!_.value) return _.value = !0, void (M.value = -1); _.value && S() }, "Escape"), p("button3", function () { P() }), (0, a.onMounted)(function () { k.$playEffect(i.Ie.Popup), w("popup", "view", "reward", "") }), p("button4", function () { P(501) }), { __sfc: !0, onBtnPress: p, onDirection: g, isTabFocus: _, emits: n, scrollTipShow: b, scrollRef: h, showAwardResModal: y, vm: k, trackEvent: w, setCurTab: I, gamepadBtnList: C, closeModal: S, handleScroll: function (t) { b.value = t.process <= .95 && $.value.length > 3 }, getTaskListByType: T, getTaskRdState: function (t) { return T(t).some(function (t) { return "Completed" === t.status }) }, curTaskList: $, canClaimAll: x, getTaskState: function (t) { return t === o.e1.RECEIVED ? { status: "claimed", text: k.$getI18nWord("task_btn_claimed") } : t === o.e1.COMPLETED ? { status: "claim", text: k.$getI18nWord("task_btn_claim") } : { status: "doing", text: k.$getI18nWord("task_btn_doing") } }, getDefaultTab: E, curTab: O, onClaimClick: P, mainAwardStatus: G, getTabFocusState: function (t) { return _.value && O.value === t - 1 && r.wk.enableGamepad }, getAwardCnt: function (t) { return (0, s.je)({ num: t, lang: k.$getLang() }) }, getTaskProgress: function (t, e) { var n = (0, s.je)({ num: t, lang: k.$getLang() }), a = (0, s.je)({ num: e, lang: k.$getLang() }); return { str: "(".concat(n.str, " / ").concat(a.str, ")"), text: "(".concat(n.text, " / ").concat(a.text, ")") } }, subActiveIdx: M, ME_SCROLL_OPS: i.e7, TASK_AWARD_INFO: i.dz, AWARD_ICON_INFO: i.je, state: r.wk, TaskStatus: o.e1, formatRichText: s.$G } } }, g = p, _ = (0, n(14486).A)(g, function () { var t = this, e = t._self._c, n = t._self._setupProxy; return e("div", { directives: [{ name: "local-img", rawName: "v-local-img.bg", value: t.$getLocalImg("modal_task_task_modal.png"), expression: "$getLocalImg('modal_task_task_modal.png')", modifiers: { bg: !0 } }], staticClass: "task-modal title-font" }, [e("div", { staticClass: "close-btn", on: { click: n.closeModal } }), t._v(" "), e("div", { staticClass: "modal-title" }, [e("i"), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("task_modal_title")))])]), t._v(" "), e("div", { staticClass: "modal-content" }, [e("div", { staticClass: "modal-tab-container", class: { "modal-tab-container__focused": n.isTabFocus } }, [e("div", { staticClass: "modal-tab-title" }, [t._v(t._s(t.$getI18nWord("task_modal_tab_title")))]), t._v(" "), e("div", { staticClass: "modal-tab-list" }, t._l(3, function (a) { return e("hover-btn", { key: a, staticClass: "modal-tab-item", class: { "modal-tab-item__rd": n.getTaskRdState(a), "modal-tab-item__focus": n.getTabFocusState(a) }, attrs: { img: n.vm.$getLocalImg("modal_task_list_item_bg_default.png"), "img-hover": n.vm.$getLocalImg("modal_task_list_item_bg_active.png"), "img-active": n.vm.$getLocalImg("modal_task_list_item_bg_active.png"), "need-active": !0, "is-active": n.curTab === a - 1 }, on: { click: function (t) { return n.setCurTab(a - 1) } } }, [e("span", { attrs: { "data-text": n.formatRichText(t.$getI18nWord("task_type_".concat(a))) }, domProps: { innerHTML: t._s(t.$getI18nWord("task_type_".concat(a))) } })]) }), 1)]), t._v(" "), e("div", { staticClass: "modal-task-container", class: { "modal-task-container__focused": !n.isTabFocus } }, [e("div", { staticClass: "modal-task-header" }, [e("div", { staticClass: "modal-task-header-title" }, [e("i"), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("task_list_title")))])]), t._v(" "), e("div", { staticClass: "claim-all-btn", class: { "claim-all-btn__disabled": !n.canClaimAll }, on: { click: function (t) { return n.onClaimClick() } } }, [n.state.enableGamepad ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.button3 } }) : t._e(), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("claim_all_btn")))])])]), t._v(" "), e("div", { staticClass: "modal-task-content" }, [e("me-scroll", { ref: "scrollRef", attrs: { ops: n.ME_SCROLL_OPS }, on: { "handle-scroll": n.handleScroll } }, [e("div", { staticClass: "task-list", class: "task-list__".concat(n.curTab + 1) }, t._l(n.curTaskList, function (a, i) { return e("div", { key: a.task_id, staticClass: "task-item", class: { "task-item__focused": !n.isTabFocus && n.subActiveIdx === i, "task-item__claimed": a.status === n.TaskStatus.RECEIVED } }, [e("div", { staticClass: "task-item-name", attrs: { "data-text": t.$getI18nWord("task_name_".concat(a.task_id)) } }, [t._v(t._s(t.$getI18nWord("task_name_".concat(a.task_id))))]), t._v(" "), e("div", { staticClass: "task-item-content" }, [e("div", { staticClass: "task-item-award" }, [t._l(n.TASK_AWARD_INFO[a.task_id], function (a) { return e("div", { key: a.award_id, staticClass: "task-award-item" }, [e("img", { attrs: { src: n.AWARD_ICON_INFO[a.award_id].sm, alt: "" } }), t._v(" "), e("div", { staticClass: "task-award-item-cnt", attrs: { "data-text": n.getAwardCnt(a.cnt).text } }, [e("span", { domProps: { innerHTML: t._s(n.getAwardCnt(a.cnt).str) } })])]) }), t._v(" "), t._l(3 - n.TASK_AWARD_INFO[a.task_id].length, function (t) { return e("div", { key: t, staticClass: "task-award-item task-award-item-placeholder" }) })], 2), t._v(" "), e("div", { staticClass: "task-item-progress" }, [e("span", { attrs: { "data-text": n.getTaskProgress(a.progress, a.total).text }, domProps: { innerHTML: t._s(n.getTaskProgress(a.progress, a.total).str) } })]), t._v(" "), e("div", { staticClass: "task-item-btn", class: "task-item-btn__".concat(n.getTaskState(a.status).status), on: { click: function (t) { return n.onClaimClick(a.task_id) } } }, [e("span", { domProps: { innerHTML: t._s(n.getTaskState(a.status).text) } })])])]) }), 0)])], 1), t._v(" "), e("div", { directives: [{ name: "show", rawName: "v-show", value: n.scrollTipShow, expression: "scrollTipShow" }], staticClass: "scroll-tip" })]), t._v(" "), e("div", { staticClass: "modal-main-award" }, [e("img", { attrs: { src: t.$getI18nWord("task_main_award"), alt: "" } }), t._v(" "), e("div", { staticClass: "claim-main-btn", class: "claim-main-btn__".concat(n.getTaskState(n.mainAwardStatus).status), on: { click: function (t) { return n.onClaimClick(501) } } }, [n.state.enableGamepad && "claim" === n.getTaskState(n.mainAwardStatus).status ? e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap.button4 } }) : t._e(), t._v(" "), n.state.enableGamepad ? t._e() : e("img", { staticClass: "gamepad-icon", attrs: { src: n.vm.$getLocalImg("modal_task_icon_btn_deco.png"), alt: "" } }), t._v(" "), e("span", { attrs: { "data-text": n.formatRichText(n.getTaskState(n.mainAwardStatus).text) }, domProps: { innerHTML: t._s(n.getTaskState(n.mainAwardStatus).text) } })])])]), t._v(" "), n.state.enableGamepad ? e("div", { staticClass: "gamepad-tip" }, t._l(n.gamepadBtnList, function (n, a) { return e("div", { key: "".concat(n, "_").concat(a), staticClass: "gamepad-tip-item" }, [e("img", { staticClass: "gamepad-icon", attrs: { src: t.$meGamepad.btnIconMap[n], alt: "" } }), t._v(" "), e("span", [t._v(t._s(t.$getI18nWord("gamepad_".concat(n, "_btn"))))])]) }), 0) : t._e()]) }, [], !1, null, "9498b388", null).exports } }]);